<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Capítulo 7 As Classes Básicas de Objetos | Análise de Dados Financeiros e Econômicos com o R - Versão Online</title>
<meta name="author" content="Marcelo S. Perlin (marcelo.perlin@ufrgs.br)">
<meta name="description" content="window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-120530145-1');  As classes básicas são os elementos mais...">
<meta name="generator" content="bookdown 0.28 with bs4_book()">
<meta property="og:title" content="Capítulo 7 As Classes Básicas de Objetos | Análise de Dados Financeiros e Econômicos com o R - Versão Online">
<meta property="og:type" content="book">
<meta property="og:image" content="/00-text-resources/cover/CAPAdigital-AnaliseDadosR.jpg">
<meta property="og:description" content="window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-120530145-1');  As classes básicas são os elementos mais...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Capítulo 7 As Classes Básicas de Objetos | Análise de Dados Financeiros e Econômicos com o R - Versão Online">
<meta name="twitter:description" content="window.dataLayer = window.dataLayer || [];  function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-120530145-1');  As classes básicas são os elementos mais...">
<meta name="twitter:image" content="/00-text-resources/cover/CAPAdigital-AnaliseDadosR.jpg">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.4.0/transition.js"></script><script src="libs/bs3compat-0.4.0/tabs.js"></script><script src="libs/bs3compat-0.4.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script>

        /* update total correct if #total_correct exists */
        update_total_correct = function() {
          if (t = document.getElementById("total_correct")) {
            t.innerHTML =
              document.getElementsByClassName("correct").length + " of " +
              document.getElementsByClassName("solveme").length + " correct";
          }
        }
        
        /* solution button toggling function */
        b_func = function() {
          var cl = this.parentElement.classList;
          if (cl.contains('open')) {
            cl.remove("open");
          } else {
            cl.add("open");
          }
        }
        
        /* function for checking solveme answers */
        solveme_func = function(e) {
          var real_answers = JSON.parse(this.dataset.answer);
          var my_answer = this.value;
          var cl = this.classList;
          if (cl.contains("ignorecase")) {
            my_answer = my_answer.toLowerCase();
          }
          if (cl.contains("nospaces")) {
            my_answer = my_answer.replace(/ /g, "");
          }
          
          if (my_answer !== "" & real_answers.includes(my_answer)) {
            cl.add("correct");
          } else {
            cl.remove("correct");
          }
        
          // match numeric answers within a specified tolerance
          if(this.dataset.tol > 0){
            var tol = JSON.parse(this.dataset.tol);  
            var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
            if (matches.reduce((a, b) => a + b, 0) > 0) {
              cl.add("correct");
            } else {
              cl.remove("correct");
            }  
          }
        
          // added regex bit
          if (cl.contains("regex")){
            answer_regex = RegExp(real_answers.join("|"))
            if (answer_regex.test(my_answer)) {
              cl.add("correct");
            }  
          }
          
          update_total_correct();
        }
        
        window.onload = function() {
          /* set up solution buttons */
          var buttons = document.getElementsByTagName("button");
        
          for (var i = 0; i < buttons.length; i++) {
            if (buttons[i].parentElement.classList.contains('solution')) {
              buttons[i].onclick = b_func;
            }
          }
          
          /* set up solveme inputs */
          var solveme = document.getElementsByClassName("solveme");
        
          for (var i = 0; i < solveme.length; i++) {
            /* make sure input boxes don't auto-anything */
            solveme[i].setAttribute("autocomplete","off");
            solveme[i].setAttribute("autocorrect", "off");
            solveme[i].setAttribute("autocapitalize", "off"); 
            solveme[i].setAttribute("spellcheck", "false");
            solveme[i].value = "";
            
            /* adjust answer for ignorecase or nospaces */
            var cl = solveme[i].classList;
            var real_answer = solveme[i].dataset.answer;
            if (cl.contains("ignorecase")) {
              real_answer = real_answer.toLowerCase();
            }
            if (cl.contains("nospaces")) {
              real_answer = real_answer.replace(/ /g, "");
            }
            solveme[i].dataset.answer = real_answer;
            
            /* attach checking function */
            solveme[i].onkeyup = solveme_func;
            solveme[i].onchange = solveme_func;
          }
          
          update_total_correct();
        }
        
        </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="00-code-resources/css/style_html.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Análise de Dados Financeiros e Econômicos com o R - Versão Online</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Bem vindo!</a></li>
<li><a class="" href="sobre-nova-edi%C3%A7%C3%A3o.html">Sobre Nova Edição</a></li>
<li><a class="" href="pref%C3%A1cio.html">Prefácio</a></li>
<li><a class="" href="introducao.html"><span class="header-section-number">1</span> Introdução</a></li>
<li><a class="" href="operacoes-basicas.html"><span class="header-section-number">2</span> Operações Básicas no R</a></li>
<li><a class="" href="scripts-pesquisa.html"><span class="header-section-number">3</span> Desenvolvendo Rotinas de Pesquisa</a></li>
<li><a class="" href="importacao-exportacao.html"><span class="header-section-number">4</span> Importação e Exportação de Dados Locais</a></li>
<li><a class="" href="importacao-pacotes.html"><span class="header-section-number">5</span> Importação de Dados via Pacotes</a></li>
<li><a class="" href="classe-estrutura.html"><span class="header-section-number">6</span> Dataframes e outros Objetos</a></li>
<li><a class="active" href="classes-basicas.html"><span class="header-section-number">7</span> As Classes Básicas de Objetos</a></li>
<li><a class="" href="programacao.html"><span class="header-section-number">8</span> Programando com o R</a></li>
<li><a class="" href="limpando-estruturando.html"><span class="header-section-number">9</span> Estruturando e Limpando Dados</a></li>
<li><a class="" href="figuras.html"><span class="header-section-number">10</span> Visualizando Dados</a></li>
<li><a class="" href="modelos.html"><span class="header-section-number">11</span> Econometria Financeira com o R</a></li>
<li><a class="" href="reportando-resultados.html"><span class="header-section-number">12</span> Reportando Resultados e Criando Relatórios</a></li>
<li><a class="" href="otimizacao.html"><span class="header-section-number">13</span> Otimização de Código</a></li>
<li><a class="" href="refer%C3%AAncias.html">Referências</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-120530145-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-120530145-1');
</script><div id="classes-basicas" class="section level1" number="7">
<h1>
<span class="header-section-number">Capítulo 7</span> As Classes Básicas de Objetos<a class="anchor" aria-label="anchor" href="#classes-basicas"><i class="fas fa-link"></i></a>
</h1>
<p><strong>As classes básicas são os elementos mais primários na representação de dados no R</strong>. Nos capítulos anteriores utilizamos as classes básicas como colunas em uma tabela. Dados numéricos viraram uma coluna do tipo <code>numeric</code>, enquanto dados de texto viraram um objeto do tipo <code>character</code>.</p>
<p>Neste capítulo iremos estudar mais a fundo as classes básicas de objetos do R, incluindo a sua criação até a manipulação do seu conteúdo. Este capítulo é de suma importância pois mostrará quais operações são possíveis com cada classe de objeto e como podes manipular as informações de forma eficiente. Os tipos de objetos tratados aqui serão:</p>
<ul>
<li>Numéricos (<code>numeric</code>)</li>
<li>Texto (<code>character</code>)</li>
<li>Fatores (<code>factor</code>)</li>
<li>Valores lógicos (<code>logical</code>)</li>
<li>Datas e tempo (<code>Date</code> e <code>timedate</code>)</li>
<li>Dados Omissos (<code>NA</code>)</li>
</ul>
<div id="objetos-numéricos" class="section level2" number="7.1">
<h2>
<span class="header-section-number">7.1</span> Objetos Numéricos<a class="anchor" aria-label="anchor" href="#objetos-num%C3%A9ricos"><i class="fas fa-link"></i></a>
</h2>
<p>Uma das classes mais utilizadas em pesquisa empírica. Os valores numéricos são representações de uma quantidade. Por exemplo: o preço de uma ação em determinada data, o volume negociado de um contrato financeiro em determinado dia, a inflação anual de um país, entre várias outras possibilidades.</p>
<div id="criando-e-manipulando-vetores-numéricos" class="section level3" number="7.1.1">
<h3>
<span class="header-section-number">7.1.1</span> Criando e Manipulando Vetores Numéricos<a class="anchor" aria-label="anchor" href="#criando-e-manipulando-vetores-num%C3%A9ricos"><i class="fas fa-link"></i></a>
</h3>
<p>A criação e manipulação de valores numéricos é fácil e direta. Os símbolos de operações matemáticas seguem o esperado, tal como soma (<code>+</code>), diminuição (<code>-</code>), divisão (<code>/</code>) e multiplicação (<code>*</code>). Todas as operações matemáticas são efetuadas com a orientação de elemento para elemento e possuem notação vetorial. Isso significa, por exemplo, que podemos manipular vetores inteiros em uma única linha de comando. Veja a seguir, onde se cria dois vetores e realiza-se diversas operações entre eles.</p>
<div class="sourceCode" id="cb546"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create numeric vectors</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">2</span><span class="op">:</span><span class="fl">6</span></span>
<span></span>
<span><span class="co"># print sum</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">x</span><span class="op">+</span><span class="va">y</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1]  3  5  7  9 11</code></pre>
<div class="sourceCode" id="cb548"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># print multiplication</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">x</span><span class="op">*</span><span class="va">y</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1]  2  6 12 20 30</code></pre>
<div class="sourceCode" id="cb550"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># print division</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">x</span><span class="op">/</span><span class="va">y</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1] 0.5000000 0.6666667 0.7500000 0.8000000 0.8333333</code></pre>
<div class="sourceCode" id="cb552"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># print exponentiation</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">x</span><span class="op">^</span><span class="va">y</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1]     1     8    81  1024 15625</code></pre>
<p>Um diferencial do R em relação a outras linguagens é que, nele, são aceitas operações entre vetores diferentes. Por exemplo, podemos somar um vetor numérico de quatro elementos com outro de apenas dois. Nesse caso, aplica-se a chamada <strong>regra de reciclagem</strong> (<em>recycling rule</em>). Ela define que, se dois vetores de tamanho diferente estão interagindo, o vetor menor é repetido tantas vezes quantas forem necessárias para obter-se o mesmo número de elementos do vetor maior. Veja o exemplo a seguir:</p>
<div class="sourceCode" id="cb554"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># set x with 4 elements and y with 2</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">2</span><span class="op">:</span><span class="fl">1</span></span>
<span></span>
<span><span class="co"># print sum</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">x</span> <span class="op">+</span> <span class="va">y</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1] 3 3 5 5</code></pre>
<p>O resultado de <code>x + y</code> é equivalente a <code>1:4 + c(2, 1, 2, 1)</code>. Caso interagirmos vetores em que o tamanho do maior não é múltiplo do menor, o R realiza o mesmo procedimento de reciclagem, porém emite uma mensagem de <code>warning</code>:</p>
<div class="sourceCode" id="cb556"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># set x = 4 elements and y with 3</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># print sum (recycling rule)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">x</span> <span class="op">+</span><span class="va">y</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; Warning in x + y: longer object length is not a multiple of
R&gt; shorter object length</code></pre>
<pre><code>R&gt; [1] 2 4 6 5</code></pre>
<p>Os três primeiros elementos de <code>x</code> foram somados aos três primeiros elementos de <code>y</code>. O quarto elemento de <code>x</code> foi somado ao primeiro elemento de <code>y</code>. Uma vez que não havia um quarto elemento em <code>y</code>, o ciclo reinicia, resgatando o primeiro elemento de <code>y</code> e resultando em uma soma igual a 5.</p>
<p>Os elementos de um vetor numérico também podem ser nomeados quando na criação do vetor:</p>
<div class="sourceCode" id="cb559"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create named vector</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>item1 <span class="op">=</span> <span class="fl">10</span>,</span>
<span>       item2 <span class="op">=</span> <span class="fl">14</span>,</span>
<span>       item3 <span class="op">=</span> <span class="fl">9</span>,</span>
<span>       item4 <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># print it</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; item1 item2 item3 item4 
R&gt;    10    14     9     2</code></pre>
<p>Para nomear os elementos após a criação, podemos utilizar a função <code>names</code>. Veja a seguir:</p>
<div class="sourceCode" id="cb561"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create unnamed vector</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">14</span>, <span class="fl">9</span>, <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># set names of elements</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'item1'</span>, <span class="st">'item2'</span>, <span class="st">'item3'</span>, <span class="st">'item4'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># print it</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; item1 item2 item3 item4 
R&gt;    10    14     9     2</code></pre>
<p>Vetores numéricos vazios também podem ser criados. Em algumas situações de desenvolvimento de código faz sentido pré-alocar o vetor antes de preenchê-lo com valores. Nesse caso, utilize a função <code>numeric</code>:</p>
<div class="sourceCode" id="cb563"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create empty numeric vector of length 10</span></span>
<span><span class="va">my_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">numeric</a></span><span class="op">(</span>length <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># print it</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_x</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt;  [1] 0 0 0 0 0 0 0 0 0 0</code></pre>
<p>Observe que, nesse caso, os valores de <code>my_x</code> são definidos como zero.</p>
<div id="criando-sequências-de-valores" class="section level4" number="7.1.1.1">
<h4>
<span class="header-section-number">7.1.1.1</span> Criando Sequências de Valores<a class="anchor" aria-label="anchor" href="#criando-sequ%C3%AAncias-de-valores"><i class="fas fa-link"></i></a>
</h4>
<p>Existem duas maneiras de criar uma sequência de valores no R. A primeira, que já foi utilizada nos exemplos anteriores, é o uso do operador <code>:</code>. Por exemplo, <code>my_seq &lt;- 1:10</code> ou <code>my_seq &lt;- -5:5</code>. Esse método é bastante prático, pois a notação é clara e direta.</p>
<p>Porém, o uso do operador <code>:</code> limita as possibilidades. A diferença entre os valores adjacentes é sempre <em>1</em> para sequências ascendentes e <em>-1</em> para sequências descendentes. Uma versão mais poderosa para a criação de sequências é o uso da função <code>seq</code>. Com ela, é possível definir os intervalos entre cada valor com o argumento <code>by</code>. Veja a seguir: </p>
<div class="sourceCode" id="cb565"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># set sequence</span></span>
<span><span class="va">my_seq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="op">-</span><span class="fl">10</span>, to <span class="op">=</span> <span class="fl">10</span>, by <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># print it</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_seq</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt;  [1] -10  -8  -6  -4  -2   0   2   4   6   8  10</code></pre>
<p>Outro atributo interessante da função <code>seq</code> é a possibilidade de criar vetores com um valor inicial, um valor final e o número de elementos desejado. Isso é realizado com o uso da opção <code>length.out</code>. Observe o código a seguir, onde cria-se um vetor de <em>0</em> até <em>10</em> com <em>20</em> elementos:</p>
<div class="sourceCode" id="cb567"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># set sequence with fixed size</span></span>
<span><span class="va">my_seq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">0</span>, to <span class="op">=</span> <span class="fl">10</span>, length.out <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># print it</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_seq</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt;  [1]  0.0000000  0.5263158  1.0526316  1.5789474  2.1052632
R&gt;  [6]  2.6315789  3.1578947  3.6842105  4.2105263  4.7368421
R&gt; [11]  5.2631579  5.7894737  6.3157895  6.8421053  7.3684211
R&gt; [16]  7.8947368  8.4210526  8.9473684  9.4736842 10.0000000</code></pre>
<p>No caso anterior, o tamanho final do vetor foi definido e a própria função se encarregou de descobrir qual a variação necessária entre cada valor de <code>my_seq</code>.</p>
</div>
<div id="criando-vetores-com-elementos-repetidos" class="section level4" number="7.1.1.2">
<h4>
<span class="header-section-number">7.1.1.2</span> Criando Vetores com Elementos Repetidos<a class="anchor" aria-label="anchor" href="#criando-vetores-com-elementos-repetidos"><i class="fas fa-link"></i></a>
</h4>
<p>Outra função interessante é a que cria vetores com o uso de repetição. Por exemplo: imagine que estamos interessado em um vetor preenchido com o valor 1 dez vezes. Para isso, basta utilizar a função <code>rep</code>: </p>
<div class="sourceCode" id="cb569"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># repeat vector three times</span></span>
<span><span class="va">my_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span>, times <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># print it</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_x</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt;  [1] 1 1 1 1 1 1 1 1 1 1</code></pre>
<p>A função também funciona com vetores. Considere uma situação onde temos um vetor com os valores <code>c(1,2)</code> e gostaríamos de criar um vetor maior com os elementos <code>c(1, 2, 1, 2, 1, 2)</code> - isto é, repetindo o vetor menor três vezes. Veja o resultado a seguir:</p>
<div class="sourceCode" id="cb571"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># repeat vector three times</span></span>
<span><span class="va">my_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, times <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># print it</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_x</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1] 1 2 1 2 1 2</code></pre>
</div>
<div id="criando-vetores-com-números-aleatórios" class="section level4" number="7.1.1.3">
<h4>
<span class="header-section-number">7.1.1.3</span> Criando Vetores com Números Aleatórios<a class="anchor" aria-label="anchor" href="#criando-vetores-com-n%C3%BAmeros-aleat%C3%B3rios"><i class="fas fa-link"></i></a>
</h4>
<p>Em muitas situações será necessário a criação de números aleatórios. Esse procedimento numérico é bastante utilizado para simular modelos matemáticos em Finanças. Por exemplo, o método de simulação de preços de ativos de Monte Carlo parte da simulação de números aleatórios <span class="citation">(<a href="refer%C3%AAncias.html#ref-mcleish2011monte" role="doc-biblioref">McLeish 2011</a>)</span>. No R, existem diversas funções que criam números aleatórios para diferentes distribuições estatísticas. As mais utilizadas, porém, são as funções <code>rnorm</code> e <code>runif</code>. </p>
<p>A função <code>rnorm</code> gera números aleatórios da distribuição Normal, com opções para a média (tendência) e o desvio padrão (variabilidade). Veja o seu uso a seguir:</p>
<div class="sourceCode" id="cb573"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># generate 10000 random numbers from a Normal distribution</span></span>
<span><span class="va">my_rnd_vec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>                    mean <span class="op">=</span> <span class="fl">0</span>,</span>
<span>                    sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># print first 20 elements</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_rnd_vec</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt;  [1] -0.169318332  0.612218174  0.678340177  0.567951972
R&gt;  [5] -0.572542604 -1.363291256 -0.388722244  0.277914132
R&gt;  [9] -0.823081122 -0.068840934 -1.167662326 -0.008309014
R&gt; [13]  0.128855402 -0.145875628 -0.163910957  1.763552003
R&gt; [17]  0.762586512  1.111431081 -0.923206953  0.164341838</code></pre>
<p>O código anterior gera uma grande quantidade de números aleatórios de uma distribuição Normal com média zero e desvio padrão igual a um. Podemos verificar a distribuição dos números gerados com um histograma:</p>
<div class="inline-figure"><img src="adfeR_pt_ed03-ONLINE_files/figure-html/unnamed-chunk-306-1.png" width="672" style="display: block; margin: auto;"></div>
<p>Como esperado, temos o formato de sino que caracteriza uma distribuição do tipo Normal. Como exercício, podes trocar as entradas <code>mean</code> e <code>sd</code> e confirmar como isso afeta a figura gerada.</p>
<p>Já a função <code>runif</code> gera valores aleatórios da distribuição uniforme entre um valor máximo e um valor mínimo. Ela é geralmente utilizada para simular probabilidades. A função <code>runif</code> tem três parâmetros de entrada: o número de valores aleatórios desejado, o valor mínimo e o valor máximo. Veja exemplo a seguir:</p>
<div class="sourceCode" id="cb575"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create a random vector with minimum and maximum</span></span>
<span><span class="va">my_rnd_vec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span>,</span>
<span>                    min <span class="op">=</span> <span class="op">-</span><span class="fl">5</span>,</span>
<span>                    max <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># print it</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_rnd_vec</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt;  [1] -0.3947496  3.4054654  3.1049157  3.5276227 -1.5256521
R&gt;  [6] -1.0434816 -4.0893803  3.2413137 -4.5963401  4.3946481</code></pre>
<p>Observe que ambas as funções anteriores são limitadas à sua respectiva distribuição. Uma maneira alternativa e flexível de gerar valores aleatórios é utilizar a função <code>sample</code>. Essa tem como entrada um vetor qualquer e retorna uma versão embaralhada de seus elementos. A sua flexibilidade reside no fato de que o vetor de entrada pode ser qualquer coisa. Por exemplo, caso quiséssemos criar um vetor aleatório com os números <code>c(0, 5, 15, 20, 25)</code> apenas, poderíamos fazê-lo da seguinte forma: </p>
<div class="sourceCode" id="cb577"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create sequence</span></span>
<span><span class="va">my_vec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">0</span>, to <span class="op">=</span> <span class="fl">25</span>, by<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># sample sequence</span></span>
<span><span class="va">my_rnd_vec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="va">my_vec</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># print it</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_rnd_vec</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1] 20 25  0  5 15 10</code></pre>
<p>A função <code>sample</code> também permite a seleção aleatória de um certo número de termos. Por exemplo, caso quiséssemos selecionar aleatoriamente apenas um elemento de <code>my_vec</code>, escreveríamos o código da seguinte maneira:</p>
<div class="sourceCode" id="cb579"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># sample one element of my_vec</span></span>
<span><span class="va">my_rnd_vec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="va">my_vec</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># print it</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_rnd_vec</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1] 25</code></pre>
<p>Caso quiséssemos dois elementos, escreveríamos:</p>
<div class="sourceCode" id="cb581"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># sample two elements of my_vec</span></span>
<span><span class="va">my_rnd_vec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="va">my_vec</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># print it</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_rnd_vec</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1] 20  0</code></pre>
<p>Também é possível selecionar valores de uma amostra menor para a criação de um vetor maior. Por exemplo, considere o caso em que se tem um vetor com os números <code>c(10, 15, 20)</code> e deseja-se criar um vetor aleatório com dez elementos retirados desse vetor menor, com repetição. Para isso, podemos utilizar a opção <code>replace = TRUE</code>.</p>
<div class="sourceCode" id="cb583"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create vector</span></span>
<span><span class="va">my_vec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">10</span>, <span class="fl">15</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># sample</span></span>
<span><span class="va">my_rnd_vec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">my_vec</span>, size <span class="op">=</span> <span class="fl">10</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_rnd_vec</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt;  [1] 10  5  5 15 10 10 10 10 10 15</code></pre>
<p>Vale destacar que a função <code>sample</code> funciona para qualquer tipo ou objeto, não sendo, portanto, exclusiva para vetores numéricos. Poderíamos, também, escolher elementos aleatórios de um vetor de texto ou então uma lista:</p>
<div class="sourceCode" id="cb585"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># example of sample with characters</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'elem 1'</span>, <span class="st">'elem 2'</span>, <span class="st">'elem 3'</span><span class="op">)</span>,</span>
<span>             size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1] "elem 1"</code></pre>
<div class="sourceCode" id="cb587"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># example of sample with list</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>,</span>
<span>                  y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'a'</span>, <span class="st">'b'</span><span class="op">)</span><span class="op">)</span>,</span>
<span>             size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; $y
R&gt; [1] "a" "b"</code></pre>
<p>É importante ressaltar que a geração de valores aleatórios no R (ou qualquer outro programa) <strong>não é totalmente aleatória!</strong> De fato, o próprio computador escolhe os valores dentre uma fila de valores possíveis. Cada vez que funções tal como <code>rnorm</code>, <code>runif</code> e <code>sample</code> são utilizadas, o computador escolhe um lugar diferente dessa fila de acordo com vários parâmetros, incluindo a data e horário atual. Portanto, do ponto de vista do usuário, os valores são gerados de forma imprevisível. Para o computador, porém, essa seleção é completamente determinística e guiada por regras claras.</p>
<p>Uma propriedade interessante no R é a possibilidade de selecionar uma posição específica na fila de valores aleatórios utilizando função <code>set.seed</code>. É ela que <strong>fixa a semente</strong> para gerar os valores. Na prática, o resultado é que todos os números e seleções aleatórias realizadas pelo código serão iguais em cada execução. O uso de <code>set.seed</code> é bastante recomendado para manter a reprodutibilidade dos códigos envolvendo aleatoriedade. Veja o exemplo a seguir, onde utiliza-se essa função. </p>
<div class="sourceCode" id="cb589"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># fix seed</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span>seed <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># set vec and print</span></span>
<span><span class="va">my_rnd_vec_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_rnd_vec_1</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1] 0.50747820 0.30676851 0.42690767 0.69310208 0.08513597</code></pre>
<div class="sourceCode" id="cb591"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># set vec and print</span></span>
<span><span class="va">my_rnd_vec_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_rnd_vec_2</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1] 0.2254366 0.2745305 0.2723051 0.6158293 0.4296715</code></pre>
<p>No código anterior, o valor de <code>set.seed</code> é um inteiro escolhido pelo usuário. Após a chamada de <code>set.seed</code>, todas as seleções e números aleatórios irão iniciar do mesmo ponto e, portanto, serão iguais. Motivo o leitor a executar o código anterior no R. Verás que os valores de <code>my_rnd_vec_1</code> e <code>my_rnd_vec_2</code> serão exatamente iguais aos valores colocados aqui.</p>
<p>O uso de <code>set.seed</code> também funciona para o caso de <code>sample</code>. Veja a seguir:</p>
<div class="sourceCode" id="cb593"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># fix seed</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span>seed <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># print vectors</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt;  [1]  5  2  1  6  8 10  3  7  9  4</code></pre>
<div class="sourceCode" id="cb595"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">10</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt;  [1] 13 15 10 17 20 14 19 12 11 18 16</code></pre>
<p>Novamente, execute os comandos anteriores no R e verás que o resultado na tela bate com o apresentado aqui.</p>
</div>
</div>
<div id="acessando-elementos-de-um-vetor-numérico" class="section level3" number="7.1.2">
<h3>
<span class="header-section-number">7.1.2</span> Acessando Elementos de um Vetor Numérico<a class="anchor" aria-label="anchor" href="#acessando-elementos-de-um-vetor-num%C3%A9rico"><i class="fas fa-link"></i></a>
</h3>
<p>Todos os elementos de um vetor numérico podem ser acessados através do uso de colchetes (<code>[ ]</code>). Por exemplo, caso quiséssemos apenas o primeiro elemento de <code>x</code>, teríamos:</p>
<div class="sourceCode" id="cb597"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># set vector</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">4</span>, <span class="op">-</span><span class="fl">9</span>, <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># get first element</span></span>
<span><span class="va">first_elem_x</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># print it</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">first_elem_x</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1] -1</code></pre>
<p>A mesma notação é válida para extrair porções de um vetor. Caso quiséssemos um subvetor de <code>x</code> com o primeiro e o segundo elemento, faríamos essa operação da seguinte forma:</p>
<div class="sourceCode" id="cb599"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># sub-vector of x</span></span>
<span><span class="va">sub_x</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># print it</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">sub_x</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1] -1  4</code></pre>
<p>Para acessar elementos nomeados de um vetor numérico, basta utilizar seu nome junto aos colchetes.</p>
<div class="sourceCode" id="cb601"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># set named vector</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>item1 <span class="op">=</span> <span class="fl">10</span>, item2 <span class="op">=</span> <span class="fl">14</span>, item3 <span class="op">=</span> <span class="op">-</span><span class="fl">9</span>, item4 <span class="op">=</span> <span class="op">-</span><span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># access elements by name</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="st">'item2'</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; item2 
R&gt;    14</code></pre>
<div class="sourceCode" id="cb603"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'item2'</span>,<span class="st">'item4'</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; item2 item4 
R&gt;    14    -2</code></pre>
<p>O acesso aos elementos de um vetor numérico também é possível através de testes lógicos. Por exemplo, caso tivéssemos interesse em saber quais os valores de <code>x</code> que são maiores do que <em>0</em>, o código resultante seria da seguinte forma:</p>
<div class="sourceCode" id="cb605"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># find all values of x higher than zero</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">x</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; item1 item2 
R&gt;    10    14</code></pre>
<p>Os usos de regras de segmentação dos dados de acordo com algum critério é chamado de indexação lógica. Os objetos do tipo <code>logical</code> serão tratados mais profundamente em seção futura deste capítulo.</p>
</div>
<div id="modificando-e-removendo-elementos-de-um-vetor-numérico" class="section level3" number="7.1.3">
<h3>
<span class="header-section-number">7.1.3</span> Modificando e Removendo Elementos de um Vetor Numérico<a class="anchor" aria-label="anchor" href="#modificando-e-removendo-elementos-de-um-vetor-num%C3%A9rico"><i class="fas fa-link"></i></a>
</h3>
<p>A modificação de um vetor numérico é muito simples. Basta indicar a posição dos elementos e os novos valores com o símbolo de <em>assign</em> (<code>&lt;-</code>):</p>
<div class="sourceCode" id="cb607"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># set vector</span></span>
<span><span class="va">my_x</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span></span>
<span></span>
<span><span class="co"># modify first element to 5</span></span>
<span><span class="va">my_x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span></span>
<span><span class="co"># print result</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_x</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1] 5 2 3 4</code></pre>
<p>Essa modificação também pode ser realizada em bloco:</p>
<div class="sourceCode" id="cb609"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># set vector</span></span>
<span><span class="va">my_x</span> <span class="op">&lt;-</span> <span class="fl">0</span><span class="op">:</span><span class="fl">5</span></span>
<span></span>
<span><span class="co"># set the first three elements to 5</span></span>
<span><span class="va">my_x</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span></span>
<span><span class="co"># print result</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_x</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1] 5 5 5 3 4 5</code></pre>
<p>O uso de condições para definir elementos é realizada pela indexação:</p>
<div class="sourceCode" id="cb611"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># set vector</span></span>
<span><span class="va">my_x</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">5</span><span class="op">:</span><span class="fl">5</span></span>
<span></span>
<span><span class="co"># set any value lower than 2 to 0</span></span>
<span><span class="va">my_x</span><span class="op">[</span><span class="va">my_x</span><span class="op">&lt;</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="co"># print result</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_x</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt;  [1] 0 0 0 0 0 0 0 2 3 4 5</code></pre>
<p>A remoção de elementos é realizada com o uso de índices negativos:</p>
<div class="sourceCode" id="cb613"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create vector</span></span>
<span><span class="va">my_x</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">5</span><span class="op">:</span><span class="fl">5</span></span>
<span></span>
<span><span class="co"># remove first and second element of my_x</span></span>
<span><span class="va">my_x</span> <span class="op">&lt;-</span> <span class="va">my_x</span><span class="op">[</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># show result</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_x</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1] -3 -2 -1  0  1  2  3  4  5</code></pre>
<p>Note como o uso do índice negativo em <code>my_x[-(1:2)]</code> retorna o vetor original sem o primeiro e segundo elemento.</p>
</div>
<div id="criando-grupos" class="section level3" number="7.1.4">
<h3>
<span class="header-section-number">7.1.4</span> Criando Grupos<a class="anchor" aria-label="anchor" href="#criando-grupos"><i class="fas fa-link"></i></a>
</h3>
<p>Em algumas situações será necessário entender quantos casos da amostra estão localizados entre um determinado intervalo. Por exemplo, imagine o vetor dos retornos diários de uma ação, isto é, a variação percentual dos preços de fechamento entre um dia e outro. Uma possível análise de risco que pode ser realizada é dividir o intervalo de retornos em cinco partes e verificar o percentual de ocorrência dos valores em cada um dos intervalos. Essa análise numérica é bastante semelhante à construção e visualização de histogramas.</p>
<p>A função <code>cut</code> serve para criar grupos de intervalos a partir de um vetor numérico. Veja o exemplo a seguir, onde cria-se um vetor aleatório oriundo da distribuição Normal e cinco grupos a partir de intervalos definidos pelos dados. </p>
<div class="sourceCode" id="cb615"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># set rnd vec</span></span>
<span><span class="va">my_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># "cut" it into 5 pieces</span></span>
<span><span class="va">my_cut</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html">cut</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">my_x</span>, breaks <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_cut</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt;  [1] (-1.57,-1.12]  (0.252,0.71]   (-1.12,-0.66] 
R&gt;  [4] (-0.204,0.252] (-0.66,-0.204] (-1.57,-1.12] 
R&gt;  [7] (0.252,0.71]   (-0.204,0.252] (0.252,0.71]  
R&gt; [10] (-0.204,0.252]
R&gt; 5 Levels: (-1.57,-1.12] (-1.12,-0.66] ... (0.252,0.71]</code></pre>
<p>Observe que os nomes dos elementos da variável <code>my_cut</code> são definidos pelos intervalos e o resultado é um objeto do tipo fator. Em seções futuras, iremos explicar melhor esse tipo de objeto e as suas propriedades.</p>
<p>No exemplo anterior, os intervalos para cada grupo foram definidos automaticamente. No uso da função <code>cut</code>, também é possível definir quebras customizadas nos dados e nos nomes dos grupos. Veja a seguir:</p>
<div class="sourceCode" id="cb617"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># set random vector</span></span>
<span><span class="va">my_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># create groups with 5 breaks</span></span>
<span><span class="va">my_cut</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html">cut</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">my_x</span>, breaks <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># print it!</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_cut</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt;  [1] (-1.3,-0.3]  (-0.3,0.697] (-0.3,0.697] (-2.3,-1.3] 
R&gt;  [5] (-0.3,0.697] (0.697,1.69] (0.697,1.69] (0.697,1.69]
R&gt;  [9] (-1.3,-0.3]  (1.69,2.7]  
R&gt; 5 Levels: (-2.3,-1.3] (-1.3,-0.3] ... (1.69,2.7]</code></pre>
<p>Note que os nomes dos elementos em <code>my_cut</code> foram definidos como intervalos e o resultado é um objeto do tipo fator. É possível também definir intervalos e nomes customizados para cada grupo com o uso dos argumentos <code>labels</code> e <code>breaks</code>:</p>
<div class="sourceCode" id="cb619"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create random vector</span></span>
<span><span class="va">my_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># define breaks manually</span></span>
<span><span class="va">my_breaks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">my_x</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">my_x</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># define labels manually</span></span>
<span><span class="va">my_labels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'Low'</span>,<span class="st">'Normal'</span>, <span class="st">'High'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># create group from numerical vector</span></span>
<span><span class="va">my_cut</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html">cut</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">my_x</span>, breaks <span class="op">=</span> <span class="va">my_breaks</span>, labels <span class="op">=</span> <span class="va">my_labels</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># print both!</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_x</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt;  [1]  0.5981759  1.6113647 -0.4373813  1.3526206  0.4705685
R&gt;  [6]  0.4702481  0.3963088 -0.7304926  0.6531176  1.2279598</code></pre>
<div class="sourceCode" id="cb621"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_cut</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt;  [1] Normal High   Normal High   Normal Normal Normal Normal
R&gt;  [9] Normal High  
R&gt; Levels: Low Normal High</code></pre>
<p>Como podemos ver, os nomes dos grupos estão mais amigáveis para uma futura análise.</p>
</div>
<div id="outras-funções-úteis-3" class="section level3" number="7.1.5">
<h3>
<span class="header-section-number">7.1.5</span> Outras Funções Úteis<a class="anchor" aria-label="anchor" href="#outras-fun%C3%A7%C3%B5es-%C3%BAteis-3"><i class="fas fa-link"></i></a>
</h3>
<p><strong>as.numeric</strong> - Converte determinado objeto para numérico.</p>
<div class="sourceCode" id="cb623"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_text</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'1'</span>, <span class="st">'2'</span>, <span class="st">'3'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">my_text</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1] "character"</code></pre>
<div class="sourceCode" id="cb625"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">my_text</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_x</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1] 1 2 3</code></pre>
<div class="sourceCode" id="cb627"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">my_x</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1] "numeric"</code></pre>
<p><strong>sum</strong> - Soma os elementos de um vetor.</p>
<div class="sourceCode" id="cb629"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_x</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">50</span></span>
<span><span class="va">my_sum</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">my_x</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_sum</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1] 1275</code></pre>
<p><strong>max</strong> - Retorna o máximo valor numérico do vetor.</p>
<div class="sourceCode" id="cb631"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">14</span>, <span class="fl">9</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">max_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">max_x</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1] 14</code></pre>
<p><strong>min</strong> - Retorna o mínimo valor numérico do vetor.</p>
<div class="sourceCode" id="cb633"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">15</span>, <span class="fl">9</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">min_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">min_x</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1] 2</code></pre>
<p><strong>which.max</strong> - Retorna a posição do máximo valor numérico do vetor.</p>
<div class="sourceCode" id="cb635"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">141</span>, <span class="fl">9</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">which.max_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.min.html">which.max</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">'The position of the maximum value of x is '</span>, <span class="va">which.max_x</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; The position of the maximum value of x is  2</code></pre>
<div class="sourceCode" id="cb637"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">' and its value is '</span>, <span class="va">x</span><span class="op">[</span><span class="va">which.max_x</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt;  and its value is  141</code></pre>
<p><strong>which.min</strong> - Retorna a posição do mínimo valor numérico do vetor.</p>
<div class="sourceCode" id="cb639"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">14</span>, <span class="fl">9</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">which.min_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.min.html">which.min</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">'The position of the minimum value of x is '</span>,</span>
<span>          <span class="va">which.min_x</span>, <span class="st">' and its value is '</span>, <span class="va">x</span><span class="op">[</span><span class="va">which.min_x</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; The position of the minimum value of x is  4  and its value is  2</code></pre>
<p><strong>sort</strong> - Retorna uma versão ordenada de um vetor.</p>
<div class="sourceCode" id="cb641"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="va">x</span>, decreasing <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1] 0.1623069 0.8347800 0.8553657 0.9099027 0.9935257</code></pre>
<div class="sourceCode" id="cb643"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="va">x</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1] 0.9935257 0.9099027 0.8553657 0.8347800 0.1623069</code></pre>
<p><strong>cumsum</strong> - Soma os elementos de um vetor de forma cumulativa.</p>
<div class="sourceCode" id="cb645"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_x</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">25</span></span>
<span><span class="va">my_cumsum</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="va">my_x</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_cumsum</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt;  [1]   1   3   6  10  15  21  28  36  45  55  66  78  91 105
R&gt; [15] 120 136 153 171 190 210 231 253 276 300 325</code></pre>
<p><strong>prod</strong> - Realiza o produto de todos os elementos de um vetor.</p>
<div class="sourceCode" id="cb647"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_x</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span></span>
<span><span class="va">my_prod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/prod.html">prod</a></span><span class="op">(</span><span class="va">my_x</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_prod</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1] 3628800</code></pre>
<p><strong>cumprod</strong> - Calcula o produto cumulativo de todos os elementos de um vetor.</p>
<div class="sourceCode" id="cb649"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_x</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span></span>
<span><span class="va">my_prod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumprod</a></span><span class="op">(</span><span class="va">my_x</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_prod</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt;  [1]       1       2       6      24     120     720    5040
R&gt;  [8]   40320  362880 3628800</code></pre>
</div>
</div>
<div id="classe-de-caracteres-texto" class="section level2" number="7.2">
<h2>
<span class="header-section-number">7.2</span> Classe de Caracteres (texto)<a class="anchor" aria-label="anchor" href="#classe-de-caracteres-texto"><i class="fas fa-link"></i></a>
</h2>
<p>A classe de caracteres, ou texto, serve para armazenar informações textuais. Um exemplo prático em Finanças seria o reconhecimento de uma ação através dos seus símbolos de identificação (<em>tickers</em>) ou então por sua classe de ação: ordinária ou preferencial. Este tipo de dado tem sido utilizado cada vez mais em pesquisa empírica <span class="citation">(<a href="refer%C3%AAncias.html#ref-gentzkow2017text" role="doc-biblioref">Gentzkow, Kelly, and Taddy 2017</a>)</span>, resultando em uma diversidade de pacotes.</p>
<p>O R possui vários recursos que facilitam a criação e manipulação de objetos de tipo texto. As funções básicas fornecidas com a instalação de R são abrangentes e adequadas para a maioria dos casos. No entanto, pacote <code>stringr</code> <span class="citation">(<a href="refer%C3%AAncias.html#ref-R-stringr" role="doc-biblioref">Wickham 2019b</a>)</span> do <code>tidyverse</code> fornece muitas funções que expandem a funcionalidade básica do R na manipulação de texto.</p>
<p>Um aspecto positivo de <code>stringr</code> é que as funções começam com o nome <code>str_</code> e possuem nomes informativos. Combinando isso com o recurso de preenchimento automático (<em>autocomplete</em>) pela tecla <em>tab</em>, fica fácil de localizar os nomes das funções do pacote. Seguindo a prioridade ao universo do <code>tidyverse</code>, esta seção irá dar preferência ao uso das funções do pacote <code>stringr</code>. As rotinas nativas de manipulação de texto serão apresentadas, porém de forma limitada. </p>
<div id="criando-um-objeto-simples-de-caracteres" class="section level3" number="7.2.1">
<h3>
<span class="header-section-number">7.2.1</span> Criando um Objeto Simples de Caracteres<a class="anchor" aria-label="anchor" href="#criando-um-objeto-simples-de-caracteres"><i class="fas fa-link"></i></a>
</h3>
<p>Todo objeto de caracteres é criado através da encapsulação de um texto por aspas duplas (<code>" "</code>) ou simples (<code>' '</code>). Para criar um vetor de caracteres com <em>tickers</em> de ações, podemos fazê-lo com o seguinte código:</p>
<div class="sourceCode" id="cb651"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_assets</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'PETR3'</span>, <span class="st">'VALE4'</span>, <span class="st">'GGBR4'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_assets</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1] "PETR3" "VALE4" "GGBR4"</code></pre>
<p>Confirma-se a classe do objeto com a função <code>class</code>:</p>
<div class="sourceCode" id="cb653"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">my_assets</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1] "character"</code></pre>
</div>
<div id="criando-objetos-estruturados-de-texto" class="section level3" number="7.2.2">
<h3>
<span class="header-section-number">7.2.2</span> Criando Objetos Estruturados de Texto<a class="anchor" aria-label="anchor" href="#criando-objetos-estruturados-de-texto"><i class="fas fa-link"></i></a>
</h3>
<p>Em muitos casos no uso do R, estaremos interessados em criar vetores de texto com algum tipo de estrutura própria. Por exemplo, o vetor <code>c("text 1", "text 2", ..., "text 20")</code> possui um lógica de criação clara. Computacionalmente, podemos definir a sua estrutura como sendo a junção do texto <code>text</code> e um vetor de sequência, de 1 até 20.</p>
<p>Para criar um vetor textual capaz de unir texto com número, utilizamos a função <code><a href="https://stringr.tidyverse.org/reference/str_c.html">stringr::str_c</a></code> ou <code><a href="https://rdrr.io/r/base/paste.html">base::paste</a></code>. Veja o exemplo a seguir, onde replica-se o caso anterior com e sem espaço entre número e texto: </p>
<div class="sourceCode" id="cb655"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://stringr.tidyverse.org">stringr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># create sequence</span></span>
<span><span class="va">my_seq</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">20</span></span>
<span></span>
<span><span class="co"># create character</span></span>
<span><span class="va">my_text</span> <span class="op">&lt;-</span> <span class="st">'text'</span></span>
<span></span>
<span><span class="co"># paste objects together (without space)</span></span>
<span><span class="va">my_char</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_c.html">str_c</a></span><span class="op">(</span><span class="va">my_text</span>, <span class="va">my_seq</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_char</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt;  [1] "text1"  "text2"  "text3"  "text4"  "text5"  "text6" 
R&gt;  [7] "text7"  "text8"  "text9"  "text10" "text11" "text12"
R&gt; [13] "text13" "text14" "text15" "text16" "text17" "text18"
R&gt; [19] "text19" "text20"</code></pre>
<div class="sourceCode" id="cb657"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># paste objects together (with space)</span></span>
<span><span class="va">my_char</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_c.html">str_c</a></span><span class="op">(</span><span class="va">my_text</span>, <span class="va">my_seq</span>, sep <span class="op">=</span> <span class="st">' '</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_char</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt;  [1] "text 1"  "text 2"  "text 3"  "text 4"  "text 5" 
R&gt;  [6] "text 6"  "text 7"  "text 8"  "text 9"  "text 10"
R&gt; [11] "text 11" "text 12" "text 13" "text 14" "text 15"
R&gt; [16] "text 16" "text 17" "text 18" "text 19" "text 20"</code></pre>
<div class="sourceCode" id="cb659"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># paste objects together (with space)</span></span>
<span><span class="va">my_char</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">my_text</span>, <span class="va">my_seq</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_char</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt;  [1] "text 1"  "text 2"  "text 3"  "text 4"  "text 5" 
R&gt;  [6] "text 6"  "text 7"  "text 8"  "text 9"  "text 10"
R&gt; [11] "text 11" "text 12" "text 13" "text 14" "text 15"
R&gt; [16] "text 16" "text 17" "text 18" "text 19" "text 20"</code></pre>
<p>O mesmo procedimento também pode ser realizado com vetores de texto. Veja a seguir:</p>
<div class="sourceCode" id="cb661"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># set character value</span></span>
<span><span class="va">my_x</span> <span class="op">&lt;-</span> <span class="st">'My name is'</span></span>
<span></span>
<span><span class="co"># set character vector</span></span>
<span><span class="va">my_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'Marcelo'</span>, <span class="st">'Ricardo'</span>, <span class="st">'Tarcizio'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># paste and print</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_c.html">str_c</a></span><span class="op">(</span><span class="va">my_x</span>, <span class="va">my_names</span>, sep <span class="op">=</span> <span class="st">' '</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1] "My name is Marcelo"  "My name is Ricardo" 
R&gt; [3] "My name is Tarcizio"</code></pre>
<p>Outra possibilidade de construção de textos estruturados é a repetição do conteúdo de um objeto do tipo caractere. No caso de texto, utiliza-se a função <code><a href="https://stringr.tidyverse.org/reference/str_dup.html">stringr::str_dup</a></code>/<code><a href="https://rdrr.io/r/base/strrep.html">base::strrep</a></code> para esse fim. Observe o exemplo a seguir: </p>
<div class="sourceCode" id="cb663"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_char</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_dup.html">str_dup</a></span><span class="op">(</span>string <span class="op">=</span> <span class="st">'abc'</span>, times <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_char</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1] "abcabcabcabcabc"</code></pre>
</div>
<div id="objetos-constantes-de-texto" class="section level3" number="7.2.3">
<h3>
<span class="header-section-number">7.2.3</span> Objetos Constantes de Texto<a class="anchor" aria-label="anchor" href="#objetos-constantes-de-texto"><i class="fas fa-link"></i></a>
</h3>
<p>O R também possibilita o acesso direto a todas as letras do alfabeto. Esses estão guardadas nos objetos reservados chamados <code>letters</code> e <code>LETTERS</code>: </p>
<div class="sourceCode" id="cb665"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># print all letters in alphabet (no cap)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">letters</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt;  [1] "a" "b" "c" "d" "e" "f" "g" "h" "i" "j" "k" "l" "m" "n"
R&gt; [15] "o" "p" "q" "r" "s" "t" "u" "v" "w" "x" "y" "z"</code></pre>
<div class="sourceCode" id="cb667"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># print all letters in alphabet (WITH CAP)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">LETTERS</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt;  [1] "A" "B" "C" "D" "E" "F" "G" "H" "I" "J" "K" "L" "M" "N"
R&gt; [15] "O" "P" "Q" "R" "S" "T" "U" "V" "W" "X" "Y" "Z"</code></pre>
<p>Observe que em ambos os casos não é necessário criar os objetos. Por serem constantes embutidas automaticamente na área de trabalho do R, elas já estão disponíveis para uso. Podemos sobrescrever o nome do objeto com outro conteúdo, porém isso não é aconselhável. Nunca se sabe onde esse objeto constante está sendo usado. Outros objetos de texto constantes no R incluem <code>month.abb</code> e <code>month.name</code>. Veja a seguir o seu conteúdo: </p>
<div class="sourceCode" id="cb669"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># print abreviation and full names of months</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">month.abb</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt;  [1] "Jan" "Feb" "Mar" "Apr" "May" "Jun" "Jul" "Aug" "Sep"
R&gt; [10] "Oct" "Nov" "Dec"</code></pre>
<div class="sourceCode" id="cb671"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">month.name</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt;  [1] "January"   "February"  "March"     "April"    
R&gt;  [5] "May"       "June"      "July"      "August"   
R&gt;  [9] "September" "October"   "November"  "December"</code></pre>
</div>
<div id="selecionando-pedaços-de-um-texto" class="section level3" number="7.2.4">
<h3>
<span class="header-section-number">7.2.4</span> Selecionando Pedaços de um Texto<a class="anchor" aria-label="anchor" href="#selecionando-peda%C3%A7os-de-um-texto"><i class="fas fa-link"></i></a>
</h3>
<p>Um erro comum praticado por iniciantes é tentar selecionar pedaços de um texto através do uso de colchetes. Observe o código abaixo:</p>
<div class="sourceCode" id="cb673"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># set char object</span></span>
<span><span class="va">my_char</span> <span class="op">&lt;-</span> <span class="st">'ABCDE'</span></span>
<span></span>
<span><span class="co"># print its second character: 'B' (WRONG - RESULT is NA)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_char</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1] NA</code></pre>
<p>O resultado <code>NA</code> indica que o segundo elemento de <code>my_char</code> não existe. Isso acontece porque o uso de colchetes refere-se ao acesso de <strong>elementos</strong> de um vetor atômico, e não de caracteres dentro de um texto maior. Observe o que acontece quando utilizamos <code>my_char[1]</code>:</p>
<div class="sourceCode" id="cb675"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_char</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1] "ABCDE"</code></pre>
<p>O resultado é simplesmente o texto <em>ABCDE</em>, que está localizado no primeiro item de <code>my_char</code>. Para selecionar pedaços de um texto, devemos utilizar a função específica <code><a href="https://stringr.tidyverse.org/reference/str_sub.html">stringr::str_sub</a></code>/<code><a href="https://rdrr.io/r/base/substr.html">base::substr</a></code>: </p>
<div class="sourceCode" id="cb677"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># print third and fourth characters</span></span>
<span><span class="va">my_substr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_sub.html">str_sub</a></span><span class="op">(</span>string <span class="op">=</span> <span class="va">my_char</span>,</span>
<span>                     start <span class="op">=</span> <span class="fl">4</span>,</span>
<span>                     end <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_substr</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1] "D"</code></pre>
<p>Essa função também funciona para vetores atômicos. Vamos assumir que você importou dados de texto e o conjunto de dados bruto contém um identificador de 3 dígitos de uma empresa, sempre na mesma posição do texto. Vamos simular a situação no R:</p>
<div class="sourceCode" id="cb679"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># build char vec</span></span>
<span><span class="va">my_char_vec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'123'</span>,<span class="st">'231'</span>,<span class="st">'321'</span><span class="op">)</span>,</span>
<span>                      <span class="st">' - other ignorable text'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_char_vec</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1] "123 - other ignorable text"
R&gt; [2] "231 - other ignorable text"
R&gt; [3] "321 - other ignorable text"</code></pre>
<p>Só estamos interessados na informação das três primeiras letras de cada elemento em <code>my_char_vec</code>. Para selecioná-los, podemos usar as mesmas funções que antes.</p>
<div class="sourceCode" id="cb681"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get ids with stringr::str_sub</span></span>
<span><span class="va">ids.vec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_sub.html">str_sub</a></span><span class="op">(</span><span class="va">my_char_vec</span>, <span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">ids.vec</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1] "123" "231" "321"</code></pre>
<div class="rmdimportant">
<p>
<strong>Operações vetorizadas são comuns e esperadas no R</strong>.
Quase tudo o que você pode fazer para um único elemento pode ser
expandido para vetores. Isso facilita o desenvolvimento de rotinas pois
pode-se facilmente realizar tarefas complicadas em uma série de
elementos, em uma única linha de código.
</p>
</div>
</div>
<div id="localizando-e-substituindo-pedaços-de-um-texto" class="section level3" number="7.2.5">
<h3>
<span class="header-section-number">7.2.5</span> Localizando e Substituindo Pedaços de um Texto<a class="anchor" aria-label="anchor" href="#localizando-e-substituindo-peda%C3%A7os-de-um-texto"><i class="fas fa-link"></i></a>
</h3>
<p>Uma operação útil na manipulação de textos é a localização de letras e padrões específicos com funções <code><a href="https://stringr.tidyverse.org/reference/str_locate.html">stringr::str_locate</a></code>/<code><a href="https://rdrr.io/r/base/grep.html">base::regexpr</a></code> e <code><a href="https://stringr.tidyverse.org/reference/str_locate.html">stringr::str_locate_all</a></code>/<code><a href="https://rdrr.io/r/base/grep.html">base::gregexpr</a></code>. É importante destacar que, por <em>default</em>, essas funções utilizam de expressões do tipo <em>regex</em> - expressões regulares <span class="citation">(<a href="refer%C3%AAncias.html#ref-thompson1968programming" role="doc-biblioref">Thompson 1968</a>)</span>. Essa é uma linguagem específica para processar textos. Diversos símbolos são utilizados para estruturar, procurar e isolar padrões textuais. Quando utilizada corretamente, o <em>regex</em> é bastante útil e de extrema valia. </p>
<p>Usualmente, o caso mais comum em pesquisa é verificar a posição ou a existência de um texto menor dentro de um texto maior. Isto é, um padrão explícito e fácil de entender. Por isso, a localização e substituição de caracteres no próximo exemplo será do tipo fixo, sem o uso de <em>regex</em>. Tal informação pode ser passada às funções do pacote <code>stringr</code> através de outra função chamada <code><a href="https://stringr.tidyverse.org/reference/modifiers.html">stringr::fixed</a></code>. </p>
<p>O exemplo a seguir mostra como encontrar o caractere <em>D</em> dentre uma série de caracteres.</p>
<div class="sourceCode" id="cb683"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://stringr.tidyverse.org">stringr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">my_char</span> <span class="op">&lt;-</span> <span class="st">'ABCDEF-ABCDEF-ABC'</span></span>
<span><span class="va">pos</span> <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_locate.html">str_locate</a></span><span class="op">(</span>string <span class="op">=</span> <span class="va">my_char</span>, pattern <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/modifiers.html">fixed</a></span><span class="op">(</span><span class="st">'D'</span><span class="op">)</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">pos</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt;      start end
R&gt; [1,]     4   4</code></pre>
<p>Observe que a função <code>str_locate</code> retorna apenas a primeira ocorrência de <em>D</em>. Para resgatar todas as ocorrências, devemos utilizar a função <code>str_locate_all</code>:</p>
<div class="sourceCode" id="cb685"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># set object</span></span>
<span><span class="va">my_char</span> <span class="op">&lt;-</span> <span class="st">'ABCDEF-ABCDEF-ABC'</span></span>
<span></span>
<span><span class="co"># find position of ALL 'D' using str_locate_all</span></span>
<span><span class="va">pos</span> <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_locate.html">str_locate_all</a></span><span class="op">(</span>string <span class="op">=</span> <span class="va">my_char</span>, pattern <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/modifiers.html">fixed</a></span><span class="op">(</span><span class="st">'D'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">pos</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [[1]]
R&gt;      start end
R&gt; [1,]     4   4
R&gt; [2,]    11  11</code></pre>
<p>Observe também que as funções <code>regexp</code> e <code>grepexpr</code> retornam objetos com propriedades específicas, apresentando-as na tela.</p>
<p>Para substituir caracteres em um texto, basta utilizar a função <code><a href="https://stringr.tidyverse.org/reference/str_replace.html">stringr::str_replace</a></code> ou <code><a href="https://rdrr.io/r/base/grep.html">base::sub</a></code> e <code>str_replace_all</code> ou <code><a href="https://rdrr.io/r/base/grep.html">base::gsub</a></code>. Vale salientar que <code>str_replace</code> substitui a primeira ocorrência do caractere, enquanto <code>str_replace_all</code> executa uma substituição global - isto é, aplica-se a todas as ocorrências. Veja a diferença a seguir: </p>
<div class="sourceCode" id="cb687"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># set char object</span></span>
<span><span class="va">my_char</span> <span class="op">&lt;-</span> <span class="st">'ABCDEF-ABCDEF-ABC'</span></span>
<span></span>
<span><span class="co"># substitute the FIRST 'ABC' for 'XXX' with sub</span></span>
<span><span class="va">my_char</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">sub</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">my_char</span>,</span>
<span>               pattern <span class="op">=</span> <span class="st">'ABC'</span>,</span>
<span>               replacement <span class="op">=</span> <span class="st">'XXX'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_char</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1] "XXXDEF-ABCDEF-ABC"</code></pre>
<div class="sourceCode" id="cb689"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># substitute the FIRST 'ABC' for 'XXX' with str_replace</span></span>
<span><span class="va">my_char</span> <span class="op">&lt;-</span> <span class="st">'ABCDEF-ABCDEF-ABC'</span></span>
<span><span class="va">my_char</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html">str_replace</a></span><span class="op">(</span>string <span class="op">=</span> <span class="va">my_char</span>,</span>
<span>                       pattern <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/modifiers.html">fixed</a></span><span class="op">(</span><span class="st">'ABC'</span><span class="op">)</span>,</span>
<span>                       replacement <span class="op">=</span> <span class="st">'XXX'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_char</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1] "XXXDEF-ABCDEF-ABC"</code></pre>
<p>E agora fazemos uma substituição global dos caracteres.</p>
<div class="sourceCode" id="cb691"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># set char object</span></span>
<span><span class="va">my_char</span> <span class="op">&lt;-</span> <span class="st">'ABCDEF-ABCDEF-ABC'</span></span>
<span></span>
<span><span class="co"># substitute the FIRST 'ABC' for 'XXX' with str_replace</span></span>
<span><span class="va">my_char</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html">str_replace_all</a></span><span class="op">(</span>string <span class="op">=</span> <span class="va">my_char</span>,</span>
<span>                           pattern <span class="op">=</span> <span class="st">'ABC'</span>,</span>
<span>                           replacement <span class="op">=</span> <span class="st">'XXX'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_char</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1] "XXXDEF-XXXDEF-XXX"</code></pre>
<p>Mais uma vez, vale ressaltar que as operações de substituição também funcionam em vetores. Dê uma olhada no próximo exemplo.</p>
<div class="sourceCode" id="cb693"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># set char object</span></span>
<span><span class="va">my_char</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'ABCDEF'</span>,<span class="st">'DBCFE'</span>,<span class="st">'ABC'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># create an example of vector</span></span>
<span><span class="va">my_char_vec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_c.html">str_c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="va">my_char</span>, <span class="fl">5</span>, replace <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>                     <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="va">my_char</span>, <span class="fl">5</span>, replace <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>                     sep <span class="op">=</span> <span class="st">' - '</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># show it</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_char_vec</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1] "ABCDEF - ABC"    "ABCDEF - ABCDEF" "ABCDEF - ABC"   
R&gt; [4] "ABCDEF - DBCFE"  "DBCFE - ABCDEF"</code></pre>
<div class="sourceCode" id="cb695"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># substitute all occurrences of 'ABC'</span></span>
<span><span class="va">my_char_vec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html">str_replace_all</a></span><span class="op">(</span>string <span class="op">=</span> <span class="va">my_char_vec</span>,</span>
<span>                               pattern <span class="op">=</span> <span class="st">'ABC'</span>,</span>
<span>                               replacement <span class="op">=</span> <span class="st">'XXX'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># print result</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_char_vec</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1] "XXXDEF - XXX"    "XXXDEF - XXXDEF" "XXXDEF - XXX"   
R&gt; [4] "XXXDEF - DBCFE"  "DBCFE - XXXDEF"</code></pre>
</div>
<div id="separando-textos" class="section level3" number="7.2.6">
<h3>
<span class="header-section-number">7.2.6</span> Separando Textos<a class="anchor" aria-label="anchor" href="#separando-textos"><i class="fas fa-link"></i></a>
</h3>
<p>Em algumas situações, principalmente no processamento de textos, é possível que se esteja interessado em quebrar um texto de acordo com algum separador. Por exemplo, o texto <code>abc ; bcd ; adf</code> apresenta informações demarcadas pelo símbolo <code>;</code>. Para separar um texto em várias partes, utilizamos a função <code><a href="https://stringr.tidyverse.org/reference/str_split.html">stringr::str_split</a></code>/<code><a href="https://rdrr.io/r/base/strsplit.html">base::strsplit</a></code>. Essas quebram o texto em diversas partes de acordo com algum caractere escolhido. Observe os exemplos a seguir: </p>
<div class="sourceCode" id="cb697"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># set char</span></span>
<span><span class="va">my_char</span> <span class="op">&lt;-</span> <span class="st">'ABCXABCXBCD'</span></span>
<span></span>
<span><span class="co"># split it based on 'X' and using stringr::str_split</span></span>
<span><span class="va">split_char</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_split.html">str_split</a></span><span class="op">(</span><span class="va">my_char</span>, <span class="st">'X'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># print result</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">split_char</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [[1]]
R&gt; [1] "ABC" "ABC" "BCD"</code></pre>
<p>A saída dessa função é um objeto do tipo lista. Para acessar os elementos de uma lista, deve-se utilizar o operador <code>[[ ]]</code>. Por exemplo, para acessar o texto <code>bcd</code> da lista <code>split_char</code>, executa-se o seguinte código:</p>
<div class="sourceCode" id="cb699"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">split_char</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1] "ABC"</code></pre>
<p>Para visualizar um exemplo de dividir textos em vetores, veja o próximo código.</p>
<div class="sourceCode" id="cb701"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># set char</span></span>
<span><span class="va">my_char_vec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'ABCDEF'</span>,<span class="st">'DBCFE'</span>,<span class="st">'ABFC'</span>,<span class="st">'ACD'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># split it based on 'B' and using stringr::strsplit</span></span>
<span><span class="va">split_char</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_split.html">str_split</a></span><span class="op">(</span><span class="va">my_char_vec</span>, <span class="st">'B'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># print result</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">split_char</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [[1]]
R&gt; [1] "A"    "CDEF"
R&gt; 
R&gt; [[2]]
R&gt; [1] "D"   "CFE"
R&gt; 
R&gt; [[3]]
R&gt; [1] "A"  "FC"
R&gt; 
R&gt; [[4]]
R&gt; [1] "ACD"</code></pre>
<p>Observe como, novamente, um objeto do tipo <code>list</code> é retornado. Cada elemento é correspondente ao processo de quebra de texto em <code>my_char</code>.</p>
</div>
<div id="descobrindo-o-número-de-caracteres-de-um-texto" class="section level3" number="7.2.7">
<h3>
<span class="header-section-number">7.2.7</span> Descobrindo o Número de Caracteres de um Texto<a class="anchor" aria-label="anchor" href="#descobrindo-o-n%C3%BAmero-de-caracteres-de-um-texto"><i class="fas fa-link"></i></a>
</h3>
<p>Para descobrir o número de caracteres de um texto, utilizamos a função <code><a href="https://stringr.tidyverse.org/reference/str_length.html">stringr::str_length</a></code>/<code><a href="https://rdrr.io/r/base/nchar.html">base::nchar</a></code>. Ela também funciona para vetores atômicos de texto. Veja os exemplos mostrados a seguir: </p>
<div class="sourceCode" id="cb703"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># set char</span></span>
<span><span class="va">my_char</span> <span class="op">&lt;-</span> <span class="st">'abcdef'</span></span>
<span></span>
<span><span class="co"># print number of characters using stringr::str_length</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_length.html">str_length</a></span><span class="op">(</span><span class="va">my_char</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1] 6</code></pre>
<p>E agora um exemplo com vetores.</p>
<div class="sourceCode" id="cb705"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#set char</span></span>
<span><span class="va">my_char</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'a'</span>, <span class="st">'ab'</span>, <span class="st">'abc'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># print number of characters using stringr::str_length</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_length.html">str_length</a></span><span class="op">(</span><span class="va">my_char</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1] 1 2 3</code></pre>
</div>
<div id="gerando-combinações-de-texto" class="section level3" number="7.2.8">
<h3>
<span class="header-section-number">7.2.8</span> Gerando Combinações de Texto<a class="anchor" aria-label="anchor" href="#gerando-combina%C3%A7%C3%B5es-de-texto"><i class="fas fa-link"></i></a>
</h3>
<p>Um truque útil no R é usar as funções <code><a href="https://rdrr.io/r/base/outer.html">base::outer</a></code> e <code><a href="https://rdrr.io/r/base/expand.grid.html">base::expand.grid</a></code> para criar todas as combinações possíveis de elementos em diferentes objetos. Isso é útil quando você quer criar um vetor de texto combinando todos os elementos possíveis de diferentes vetores. Por exemplo, se quisermos criar um vetor com todas as combinações entre <code>c('a' , 'b')</code> e <code>c('A', 'B')</code> como <code>c('a-A', 'a-B', ...)</code>, podemos escrever: </p>
<div class="sourceCode" id="cb707"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># set char vecs</span></span>
<span><span class="va">my_vec_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'a'</span>,<span class="st">'b'</span><span class="op">)</span></span>
<span><span class="va">my_vec_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'A'</span>,<span class="st">'B'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># combine in matrix</span></span>
<span><span class="va">comb.mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/outer.html">outer</a></span><span class="op">(</span><span class="va">my_vec_1</span>,</span>
<span>                  <span class="va">my_vec_2</span>,</span>
<span>                  <span class="va">paste</span>,sep <span class="op">=</span> <span class="st">'-'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># print it!</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">comb.mat</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt;      [,1]  [,2] 
R&gt; [1,] "a-A" "a-B"
R&gt; [2,] "b-A" "b-B"</code></pre>
<p>A saída de <code>outer</code> é um objeto do tipo matriz. Se quisermos mudar <code>comb.mat</code> para um vetor atômico, podemos usar a função <code>as.character</code>: </p>
<div class="sourceCode" id="cb709"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">comb.mat</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1] "a-A" "b-A" "a-B" "b-B"</code></pre>
<p>Outra maneira de atingir o mesmo objetivo é usar a função <code>expand.grid</code>. Veja o próximo exemplo.</p>
<div class="sourceCode" id="cb711"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># set vectors</span></span>
<span><span class="va">my_vec_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'John '</span>, <span class="st">'Claire '</span>, <span class="st">'Adam '</span><span class="op">)</span></span>
<span><span class="va">my_vec_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'is fishing.'</span>, <span class="st">'is working.'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># create df with all combinations</span></span>
<span><span class="va">my_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html">expand.grid</a></span><span class="op">(</span>name <span class="op">=</span> <span class="va">my_vec_1</span>,</span>
<span>                     verb <span class="op">=</span> <span class="va">my_vec_2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># print df</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_df</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt;      name        verb
R&gt; 1   John  is fishing.
R&gt; 2 Claire  is fishing.
R&gt; 3   Adam  is fishing.
R&gt; 4   John  is working.
R&gt; 5 Claire  is working.
R&gt; 6   Adam  is working.</code></pre>
<div class="sourceCode" id="cb713"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># paste columns together in tibble</span></span>
<span><span class="va">my_df</span> <span class="op">&lt;-</span> <span class="va">my_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>phrase <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">name</span>, <span class="va">verb</span><span class="op">)</span> <span class="op">)</span></span>
<span></span>
<span><span class="co"># print result</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_df</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt;      name        verb             phrase
R&gt; 1   John  is fishing.   John is fishing.
R&gt; 2 Claire  is fishing. Claire is fishing.
R&gt; 3   Adam  is fishing.   Adam is fishing.
R&gt; 4   John  is working.   John is working.
R&gt; 5 Claire  is working. Claire is working.
R&gt; 6   Adam  is working.   Adam is working.</code></pre>
<p>Aqui, usamos a função <code>expand.grid</code> para criar um <code>dataframe</code> contendo todas as combinações possíveis de <code>my_vec_1</code> e <code>my_vec_2</code>. Posteriormente, colamos o conteúdo das colunas do <code>dataframe</code> usando <code>str_c</code>.</p>
</div>
<div id="codificação-de-objetos-character" class="section level3" number="7.2.9">
<h3>
<span class="header-section-number">7.2.9</span> Codificação de Objetos <code>character</code><a class="anchor" aria-label="anchor" href="#codifica%C3%A7%C3%A3o-de-objetos-character"><i class="fas fa-link"></i></a>
</h3>
<p>Para o R, um <em>string</em> de texto é apenas uma sequência de <em>bytes</em>. A tradução de <em>bytes</em> para caracteres é realizada de acordo com uma estrutura de codificação. Para a maioria dos casos de uso do R, especialmente em países de língua inglesa, a codificação de caracteres não é um problema pois os textos importados no R já possuem a codificação correta. Ao lidar com dados de texto em diferentes idiomas, tal como Português do Brasil, a codificação de caracteres é algo que você deve entender pois eventualmente precisará lidar com isso.</p>
<p>Vamos explorar um exemplo. Aqui, vamos importar dados de um arquivo de texto com a codificação <code>'ISO-8859-9'</code> e verificar o resultado.</p>
<div class="sourceCode" id="cb715"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># read text file</span></span>
<span><span class="va">my_f</span> <span class="op">&lt;-</span> <span class="fu">adfeR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/adfeR/man/get_data_file.html">get_data_file</a></span><span class="op">(</span><span class="st">'FileWithLatinChar_Latin1.txt'</span><span class="op">)</span></span>
<span></span>
<span><span class="va">my_char</span> <span class="op">&lt;-</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_lines.html">read_lines</a></span><span class="op">(</span><span class="va">my_f</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># print it</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_char</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1] "A casa \xe9 bonita e tem muito espa\xe7o"</code></pre>
<p>O conteúdo original do arquivo é um texto em português. Como você pode ver, a saída de <code><a href="https://readr.tidyverse.org/reference/read_lines.html">readr::read_lines</a></code> mostra todos os caracteres latinos com símbolos estranhos. Isso ocorre pois a codificação foi manualmente trocada para <code>'ISO-8859-9'</code>, enquanto a função <code>read_lines</code> utiliza <code>'UTF-8'</code> como <em>default</em>. A solução mais fácil e direta é modificar a codificação esperada do arquivo nas entradas de <code>read_lines</code>. Veja a seguir, onde importamos um arquivo com a codificação correta (<code>'Latin1'</code>):</p>
<div class="sourceCode" id="cb717"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_char</span> <span class="op">&lt;-</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_lines.html">read_lines</a></span><span class="op">(</span><span class="va">my_f</span>, </span>
<span>                             locale <span class="op">=</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/locale.html">locale</a></span><span class="op">(</span>encoding<span class="op">=</span><span class="st">'Latin1'</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># print it</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_char</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1] "A casa é bonita e tem muito espaço"</code></pre>
<p>Os caracteres latinos agora estão corretos pois a codificação em <code>read_lines</code> é a mesma do arquivo, <code>'Latin1'</code>. Uma boa política neste tópico é sempre verificar a codificação de arquivos de texto importados e combiná-lo em R. A maioria das funções de importação tem uma opção para fazê-lo. Quando possível, sempre dê preferência para <code>'UTF-8'</code>. Caso necessário, programas de edição de texto, tal como o <a href="https://notepad-plus-plus.org/">notepad++</a>, possuem ferramentas para verificar e trocar a codificação de um arquivo.</p>
</div>
<div id="outras-funções-úteis-4" class="section level3" number="7.2.10">
<h3>
<span class="header-section-number">7.2.10</span> Outras Funções Úteis<a class="anchor" aria-label="anchor" href="#outras-fun%C3%A7%C3%B5es-%C3%BAteis-4"><i class="fas fa-link"></i></a>
</h3>
<p><code><a href="https://stringr.tidyverse.org/reference/case.html">stringr::str_to_lower</a></code>/<code><a href="https://rdrr.io/r/base/chartr.html">base::tolower</a></code> - Converte um objeto de texto para letras minúsculas.</p>
<div class="sourceCode" id="cb719"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/case.html">str_to_lower</a></span><span class="op">(</span><span class="st">'ABC'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1] "abc"</code></pre>
<p><code>stringr::str_to_upper/base::toupper</code> - Convertem um texto em letras maiúsculas.</p>
<div class="sourceCode" id="cb721"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/chartr.html">toupper</a></span><span class="op">(</span><span class="st">'abc'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1] "ABC"</code></pre>
<div class="sourceCode" id="cb723"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/case.html">str_to_upper</a></span><span class="op">(</span><span class="st">'abc'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1] "ABC"</code></pre>
</div>
</div>
<div id="fatores" class="section level2" number="7.3">
<h2>
<span class="header-section-number">7.3</span> Fatores<a class="anchor" aria-label="anchor" href="#fatores"><i class="fas fa-link"></i></a>
</h2>
<p>A classe de fatores (<code>factor</code>) é utilizada para representar grupos ou categorias dentro de uma base de dados no formato tabular. Por exemplo, imagine um banco de informações com os gastos de diferentes pessoas ao longo de um ano. Nessa base de dados existe um item que define o gênero do indivíduo: masculino ou feminino (M ou F). Essa respectiva coluna pode ser importada e representada como texto, porém, no R, a melhor maneira de representá-la é através do objeto fator, uma vez que a mesma representa uma categoria.</p>
<p>A classe de fatores oferece um significado especial para denotar grupos dentro dos dados. Essa organização é integrada aos pacotes e facilita muito a vida do usuário. Por exemplo, caso quiséssemos criar um gráfico para cada grupo dentro da nossa base de dados, poderíamos fazer o mesmo simplesmente indicando a existência de uma variável de fator para a função de criação da figura. Outra possibilidade é determinar se as diferentes médias de uma variável numérica são estatisticamente diferentes para os grupos dos nossos dados. Podemos também estimar um determinado modelo estatístico para cada grupo. Quando os dados de categorias são representados apropriadamente, o uso das funções do R torna-se mais fácil e eficiente.</p>
<div id="criando-fatores" class="section level3" number="7.3.1">
<h3>
<span class="header-section-number">7.3.1</span> Criando Fatores<a class="anchor" aria-label="anchor" href="#criando-fatores"><i class="fas fa-link"></i></a>
</h3>
<p>A criação de fatores dá-se através da função <code>factor</code>: </p>
<div class="sourceCode" id="cb725"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_factor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'M'</span>, <span class="st">'F'</span>, <span class="st">'M'</span>, <span class="st">'M'</span>, <span class="st">'F'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_factor</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1] M F M M F
R&gt; Levels: F M</code></pre>
<p>Observe, no exemplo anterior, que a apresentação de fatores com a função <code>print</code> mostra os seus elementos e também o item chamado <code>Levels</code>. Esse último identifica os possíveis grupos que abrangem o vetor - nesse caso apenas <code>M</code> e <code>F</code>. Se tivéssemos um número maior de grupos, o item <code>Levels</code> aumentaria. Veja a seguir:</p>
<div class="sourceCode" id="cb727"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_factor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'M'</span>,<span class="st">'F'</span>,<span class="st">'M'</span>,<span class="st">'M'</span>,<span class="st">'F'</span>,<span class="st">'ND'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_factor</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1] M  F  M  M  F  ND
R&gt; Levels: F M ND</code></pre>
<p>Um ponto importante na criação de fatores é que os <code>Levels</code> são inferidos através dos dados criados, e isso pode não corresponder à realidade. Por exemplo, observe o seguinte exemplo:</p>
<div class="sourceCode" id="cb729"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_status</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'Solteiro'</span>, <span class="st">'Solteiro'</span>, <span class="st">'Solteiro'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_status</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1] Solteiro Solteiro Solteiro
R&gt; Levels: Solteiro</code></pre>
<p>Nota-se que, por ocasião, os dados mostram apenas uma categoria: <code>Solteiro</code>. Entretanto, sabe-se que outra categoria do tipo <code>Casado</code> é esperada. No caso de utilizarmos o objeto <code>my_status</code> da maneira que foi definida anteriormente, omitiremos a informação de outros gêneros, e isso pode ocasionar problemas no futuro tal como a criação de gráficos incompletos. Nessa situação, o correto é definir os <code>Levels</code> manualmente da seguinte maneira:</p>
<div class="sourceCode" id="cb731"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_status</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'Solteiro'</span>, <span class="st">'Solteiro'</span>, <span class="st">'Solteiro'</span><span class="op">)</span>,</span>
<span>                    levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'Solteiro'</span>, <span class="st">'Casado'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_status</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1] Solteiro Solteiro Solteiro
R&gt; Levels: Solteiro Casado</code></pre>
</div>
<div id="modificando-fatores" class="section level3" number="7.3.2">
<h3>
<span class="header-section-number">7.3.2</span> Modificando Fatores<a class="anchor" aria-label="anchor" href="#modificando-fatores"><i class="fas fa-link"></i></a>
</h3>
<p>Um ponto importante sobre os objetos do tipo fator é que seus <code>Levels</code> são <strong>imutáveis e não atualizam-se com a entrada de novos dados</strong>. Em outras palavras, não é possível modificar os valores dos <code>Levels</code> após a criação do objeto. Toda nova informação que não for compatível com os <code>Levels</code> do objeto será transformada em <code>NA</code> (<em>Not available</em>) e uma mensagem de <code>warning</code> irá aparecer na tela. Essa limitação pode parecer estranha a primeira vista porém, na prática, ela evita possíveis erros no código. Veja o exemplo a seguir:</p>
<div class="sourceCode" id="cb733"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># set factor</span></span>
<span><span class="va">my_factor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'a'</span>, <span class="st">'b'</span>, <span class="st">'a'</span>, <span class="st">'b'</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># change first element of a factor to 'c'</span></span>
<span><span class="va">my_factor</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">'c'</span></span></code></pre></div>
<pre><code>R&gt; Warning in `[&lt;-.factor`(`*tmp*`, 1, value = "c"): invalid
R&gt; factor level, NA generated</code></pre>
<div class="sourceCode" id="cb735"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># print result</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_factor</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1] &lt;NA&gt; b    a    b   
R&gt; Levels: a b</code></pre>
<p>Nesse caso, a maneira correta de proceder é primeiro transformar o objeto da classe fator para a classe caractere e depois realizar a conversão:</p>
<div class="sourceCode" id="cb737"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># set factor</span></span>
<span><span class="va">my_factor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'a'</span>, <span class="st">'b'</span>, <span class="st">'a'</span>, <span class="st">'b'</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># change factor to character</span></span>
<span><span class="va">my_char</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">my_factor</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># change first element</span></span>
<span><span class="va">my_char</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">'c'</span></span>
<span></span>
<span><span class="co"># mutate it back to class factor</span></span>
<span><span class="va">my_factor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">my_char</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># show result</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_factor</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1] c b a b
R&gt; Levels: a b c</code></pre>
<p>Utilizando essas etapas temos o resultado desejado no vetor <code>my_factor</code>, com a definição de três <code>Levels</code>: <code>a</code>, <code>b</code> e <code>c</code>.</p>
<p>O universo <code>tidyverse</code> também possui um pacote próprio para manipular fatores, o <code>forcats</code>. Para o problema atual de modificação de fatores, podemos utilizar função <code><a href="https://forcats.tidyverse.org/reference/fct_recode.html">forcats::fct_recode</a></code>. Veja um exemplo a seguir, onde trocamos as siglas dos fatores: </p>
<div class="sourceCode" id="cb739"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://forcats.tidyverse.org">forcats</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># set factor</span></span>
<span><span class="va">my.fct</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'A'</span>, <span class="st">'B'</span>, <span class="st">'C'</span>, <span class="st">'A'</span>, <span class="st">'C'</span>, <span class="st">'M'</span>, <span class="st">'N'</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># modify factors</span></span>
<span><span class="va">my.fct</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_recode.html">fct_recode</a></span><span class="op">(</span><span class="va">my.fct</span>,</span>
<span>                     <span class="st">'D'</span> <span class="op">=</span> <span class="st">'A'</span>,</span>
<span>                     <span class="st">'E'</span> <span class="op">=</span> <span class="st">'B'</span>,</span>
<span>                     <span class="st">'F'</span> <span class="op">=</span> <span class="st">'C'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># print result</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my.fct</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1] D E F D F M N
R&gt; Levels: D E F M N</code></pre>
<p>Observe como o uso da função <code><a href="https://forcats.tidyverse.org/reference/fct_recode.html">forcats::fct_recode</a></code> é intuitivo. Basta indicar o novo nome dos grupos com o operador de igualdade.</p>
</div>
<div id="convertendo-fatores-para-outras-classes" class="section level3" number="7.3.3">
<h3>
<span class="header-section-number">7.3.3</span> Convertendo Fatores para Outras Classes<a class="anchor" aria-label="anchor" href="#convertendo-fatores-para-outras-classes"><i class="fas fa-link"></i></a>
</h3>
<p>Outro ponto importante no uso de fatores é a sua conversão para outras classes, especialmente a numérica. Quando convertemos um objeto de tipo fator para a classe caractere, o resultado é o esperado:</p>
<div class="sourceCode" id="cb741"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create factor</span></span>
<span><span class="va">my_char</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'a'</span>, <span class="st">'b'</span>, <span class="st">'c'</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># convert and print</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">my_char</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1] "a" "b" "c"</code></pre>
<p>Porém, quando fazemos o mesmo procedimento para a classe numérica, o que o R retorna é <strong>longe do esperado</strong>:</p>
<div class="sourceCode" id="cb743"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># set factor</span></span>
<span><span class="va">my_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fl">5</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># convert to numeric (WRONG)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">my_values</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1] 1 2 3 4 5 6</code></pre>
<p>Esse resultado pode ser explicado pelo fato de que, internamente, fatores são armazenados como índices, indo de 1 até o número total de <code>Levels</code>. Essa simplificação minimiza o uso da memória do computador. Quando pedimos ao R para transformar esses fatores em números, ele entende que buscamos o número do índice e não do valor. Para contornar, é fácil: basta transformar o objeto fator em caractere e, depois, em numérico, conforme mostrado a seguir:</p>
<div class="sourceCode" id="cb745"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># converting factors to character and then to numeric</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">my_values</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1]  5  6  7  8  9 10</code></pre>
<div class="rmdcaution">
<p>
Tenha muito cuidado ao transformar fatores em números. Lembre-se
sempre de que o retorno da conversão direta serão os índices dos
<code>levels</code> e não os valores em si. Esse é um <em>bug</em> bem
particular que pode ser difícil de identificar em um código
complexo.
</p>
</div>
</div>
<div id="criando-tabelas-de-contingência" class="section level3" number="7.3.4">
<h3>
<span class="header-section-number">7.3.4</span> Criando Tabelas de Contingência<a class="anchor" aria-label="anchor" href="#criando-tabelas-de-conting%C3%AAncia"><i class="fas fa-link"></i></a>
</h3>
<p>Após a criação de um fator, podemos calcular a ocorrência de cada fator com a função <code>table</code>. Essa também é chamada de tabela de contingência. Em um caso simples, com apenas um fator, a função <code>table</code> conta o número de ocorrências de cada categoria, como a seguir:</p>
<div class="sourceCode" id="cb747"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create factor</span></span>
<span><span class="va">my_factor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'Pref'</span>, <span class="st">'Ord'</span><span class="op">)</span>,</span>
<span>                           size <span class="op">=</span> <span class="fl">20</span>,</span>
<span>                           replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># print contingency table</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">my_factor</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; my_factor
R&gt;  Ord Pref 
R&gt;    9   11</code></pre>
<p>Um caso mais avançado do uso de <code>table</code> é utilizar mais de um fator para a criação da tabela. Veja o exemplo a seguir:</p>
<div class="sourceCode" id="cb749"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># set factors</span></span>
<span><span class="va">my_factor_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'Pref'</span>, <span class="st">'Ord'</span><span class="op">)</span>,</span>
<span>                             size <span class="op">=</span> <span class="fl">20</span>,</span>
<span>                             replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">my_factor_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">'Grupo'</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span>,</span>
<span>                             size <span class="op">=</span> <span class="fl">20</span>,</span>
<span>                             replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># print contingency table with two factors</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">my_factor_1</span>, <span class="va">my_factor_2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt;            my_factor_2
R&gt; my_factor_1 Grupo 1 Grupo 2 Grupo 3
R&gt;        Ord        2       4       3
R&gt;        Pref       3       4       4</code></pre>
<p>A tabela criada anteriormente mostra o número de ocorrências para cada combinação de fator. Essa é uma ferramenta descritiva simples, mas bastante informativa para a análise de grupos de dados.</p>
</div>
<div id="outras-funções" class="section level3" number="7.3.5">
<h3>
<span class="header-section-number">7.3.5</span> Outras Funções<a class="anchor" aria-label="anchor" href="#outras-fun%C3%A7%C3%B5es"><i class="fas fa-link"></i></a>
</h3>
<p><strong>levels</strong> - Retorna os <code>Levels</code> de um objeto da classe fator.</p>
<div class="sourceCode" id="cb751"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_factor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'A'</span>, <span class="st">'A'</span>, <span class="st">'B'</span>, <span class="st">'C'</span>, <span class="st">'B'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">my_factor</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1] "A" "B" "C"</code></pre>
<p><strong>as.factor</strong> - Transforma um objeto para a classe fator.</p>
<div class="sourceCode" id="cb753"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'a'</span>,<span class="st">'b'</span>, <span class="st">'c'</span>, <span class="st">'c'</span>, <span class="st">'a'</span><span class="op">)</span></span>
<span><span class="va">my_factor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">my_y</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_factor</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1] a b c c a
R&gt; Levels: a b c</code></pre>
<p><strong>split</strong> - Com base em um objeto de fator, cria uma lista com valores de outro objeto. Esse comando é útil para separar dados de grupos diferentes e aplicar alguma função com <code>sapply</code> ou <code>lapply</code>.</p>
<div class="sourceCode" id="cb755"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_factor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'A'</span>,<span class="st">'B'</span>,<span class="st">'C'</span>,<span class="st">'C'</span>,<span class="st">'C'</span>,<span class="st">'B'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">my_x</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">my_factor</span><span class="op">)</span></span>
<span></span>
<span><span class="va">my_l</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html">split</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">my_x</span>, f <span class="op">=</span> <span class="va">my_factor</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_l</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; $A
R&gt; [1] 1
R&gt; 
R&gt; $B
R&gt; [1] 2 6
R&gt; 
R&gt; $C
R&gt; [1] 3 4 5</code></pre>
</div>
</div>
<div id="valores-lógicos" class="section level2" number="7.4">
<h2>
<span class="header-section-number">7.4</span> Valores Lógicos<a class="anchor" aria-label="anchor" href="#valores-l%C3%B3gicos"><i class="fas fa-link"></i></a>
</h2>
<p>Testes lógicos em dados são centrais no uso do R. Em uma única linha de código podemos testar condições para uma grande quantidade de casos. Esse cálculo é muito utilizado para encontrar casos extremos nos dados (<em>outliers</em>) e também para separar diferentes amostras de acordo com algum critério.</p>
<div id="criando-valores-lógicos" class="section level3" number="7.4.1">
<h3>
<span class="header-section-number">7.4.1</span> Criando Valores Lógicos<a class="anchor" aria-label="anchor" href="#criando-valores-l%C3%B3gicos"><i class="fas fa-link"></i></a>
</h3>
<p>Em uma sequência de 1 até 10, podemos verificar quais são os elementos maiores que 5 com o seguinte código: </p>
<div class="sourceCode" id="cb757"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># set numerical</span></span>
<span><span class="va">my_x</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span></span>
<span></span>
<span><span class="co"># print a logical test</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_x</span> <span class="op">&gt;</span> <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt;  [1] FALSE FALSE FALSE FALSE FALSE  TRUE  TRUE  TRUE  TRUE
R&gt; [10]  TRUE</code></pre>
<div class="sourceCode" id="cb759"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># print position of elements from logical test</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">my_x</span> <span class="op">&gt;</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1]  6  7  8  9 10</code></pre>
<p>A função <code>which</code> do exemplo anterior retorna os índices onde a condição é verdadeira (<code>TRUE</code>). O uso do <code>which</code> é recomendado quando se quer saber a posição de elementos que satisfazem alguma condição.</p>
<p>Para realizar testes de igualdade, basta utilizar o símbolo de igualdade duas vezes (<code>==</code>).</p>
<div class="sourceCode" id="cb761"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create char</span></span>
<span><span class="va">my_char</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'abc'</span>,<span class="st">'bcd'</span><span class="op">)</span>, <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># print its contents</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_char</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt;  [1] "abc" "bcd" "abc" "bcd" "abc" "bcd" "abc" "bcd" "abc"
R&gt; [10] "bcd"</code></pre>
<div class="sourceCode" id="cb763"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># print logical test</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_char</span> <span class="op">==</span> <span class="st">'abc'</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt;  [1]  TRUE FALSE  TRUE FALSE  TRUE FALSE  TRUE FALSE  TRUE
R&gt; [10] FALSE</code></pre>
<p>Para o teste de inigualdades, utilizamos o símbolo <code>!=</code>:</p>
<div class="sourceCode" id="cb765"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># print inequality test</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_char</span> <span class="op">!=</span> <span class="st">'abc'</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt;  [1] FALSE  TRUE FALSE  TRUE FALSE  TRUE FALSE  TRUE FALSE
R&gt; [10]  TRUE</code></pre>
<p>Destaca-se que também é possível testar condições múltiplas, isto é, a ocorrência simultânea de eventos. Utilizamos o operador <code>&amp;</code> para esse propósito. Por exemplo: se quiséssemos verificar quais são os valores de uma sequência de 1 a 10 que são maiores que 4 <strong>e</strong> menores que 7, escreveríamos:</p>
<div class="sourceCode" id="cb767"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_x</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span></span>
<span></span>
<span><span class="co"># print logical for values higher than 4 and lower than 7</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="op">(</span><span class="va">my_x</span> <span class="op">&gt;</span> <span class="fl">4</span><span class="op">)</span><span class="op">&amp;</span><span class="op">(</span><span class="va">my_x</span> <span class="op">&lt;</span> <span class="fl">7</span><span class="op">)</span> <span class="op">)</span></span></code></pre></div>
<pre><code>R&gt;  [1] FALSE FALSE FALSE FALSE  TRUE  TRUE FALSE FALSE FALSE
R&gt; [10] FALSE</code></pre>
<div class="sourceCode" id="cb769"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># print the actual values</span></span>
<span><span class="va">idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span> <span class="op">(</span><span class="va">my_x</span> <span class="op">&gt;</span> <span class="fl">4</span><span class="op">)</span><span class="op">&amp;</span><span class="op">(</span><span class="va">my_x</span> <span class="op">&lt;</span> <span class="fl">7</span><span class="op">)</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_x</span><span class="op">[</span><span class="va">idx</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1] 5 6</code></pre>
<p>Para testar condições não simultâneas, isto é, ocorrências de um ou outro evento, utilizamos o operador <code>|</code>. Por exemplo: considerando a sequência anterior, acharíamos os valores maiores que 7 <strong>ou</strong> menores que 4 escrevendo:</p>
<div class="sourceCode" id="cb771"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># location of elements higher than 7 or lower than 4</span></span>
<span><span class="va">idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span> <span class="op">(</span><span class="va">my_x</span> <span class="op">&gt;</span> <span class="fl">7</span><span class="op">)</span><span class="op">|</span><span class="op">(</span><span class="va">my_x</span> <span class="op">&lt;</span> <span class="fl">4</span><span class="op">)</span> <span class="op">)</span></span>
<span></span>
<span><span class="co"># print elements from previous condition</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_x</span><span class="op">[</span><span class="va">idx</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1]  1  2  3  8  9 10</code></pre>
<p>Observe que, em ambos os casos de uso de testes lógicos, utilizamos parênteses para encapsular as condições lógicas. Poderíamos ter escrito <code>idx &lt;- which( my_x &gt; 7|my_x &lt; 4 )</code>, porém o uso do parênteses deixa o código mais claro ao isolar os testes de condições e sinalizar que o resultado da operação será um vetor lógico. Em alguns casos, porém, o uso do parênteses indica hierarquia na ordem das operações e portanto não pode ser ignorado.</p>
<p>Outro uso interessante de objetos lógicos é o teste para saber se um item ou mais pertence a um vetor ou não. Para isso utilizamos o operador <code>%in%</code>. Por exemplo, imagine que tens os <em>tickers</em> de duas ações, <code>c('ABC', 'DEF')</code> e queres saber se é possível encontrar esses tickers na coluna de outra base de dados. Essa é uma operação semelhante ao uso do teste de igualdade, porém em notação vetorial. Veja um exemplo a seguir:</p>
<div class="sourceCode" id="cb773"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span>
<span><span class="co"># location of elements higher than 7 or lower than 4</span></span>
<span><span class="va">my_tickers</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'ABC'</span>, <span class="st">'DEF'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># set df</span></span>
<span><span class="va">n_obs</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">df_temp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>tickers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'ABC'</span>, <span class="st">'DEF'</span>, <span class="st">'GHI'</span>, <span class="st">'JKL'</span><span class="op">)</span>,</span>
<span>                                   size <span class="op">=</span> <span class="va">n_obs</span>,</span>
<span>                                   replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                  ret <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n_obs</span>, sd <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span> <span class="op">)</span></span>
<span></span>
<span><span class="co"># find rows with selected tickers</span></span>
<span><span class="va">idx</span> <span class="op">&lt;-</span> <span class="va">df_temp</span><span class="op">$</span><span class="va">tickers</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">my_tickers</span></span>
<span></span>
<span><span class="co"># print elements from previous condition</span></span>
<span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html">glimpse</a></span><span class="op">(</span><span class="va">df_temp</span><span class="op">[</span><span class="va">idx</span>, <span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; Rows: 43
R&gt; Columns: 2
R&gt; $ tickers &lt;chr&gt; "ABC", "ABC", "ABC", "DEF", "DEF", "ABC", …
R&gt; $ ret     &lt;dbl&gt; 0.042864781, 0.017056405, 0.011198439, 0.0…</code></pre>
<p>O <code>dataframe</code> mostrado na tela possui dados apenas para ações em <code>my_tickers</code>.</p>
</div>
</div>
<div id="datas-e-tempo" class="section level2" number="7.5">
<h2>
<span class="header-section-number">7.5</span> Datas e Tempo<a class="anchor" aria-label="anchor" href="#datas-e-tempo"><i class="fas fa-link"></i></a>
</h2>
<p>A representação e manipulação de datas é um importante aspecto das pesquisas em Finanças e Economia. Manipular datas e horários de forma correta, levando em conta mudanças decorridas de horário de verão, feriados locais, em diferentes zonas de tempo, não é uma tarefa fácil! Felizmente, o R fornece um grande suporte para qualquer tipo de operação com datas e tempo.</p>
<p>Nesta seção estudaremos as funções e classes nativas que representam e manipulam o tempo em R. Aqui, daremos prioridade as funções do pacote <code>lubridate</code> <span class="citation">(<a href="refer%C3%AAncias.html#ref-R-lubridate" role="doc-biblioref">Spinu, Grolemund, and Wickham 2021</a>)</span>. Existem, no entanto, muitos pacotes que podem ajudar o usuário a processar objetos do tipo data e tempo de forma mais avançada. Caso alguma operação com data e tempo não for encontrada aqui, sugiro o estudo dos pacotes <code>chron</code> <span class="citation">(<a href="refer%C3%AAncias.html#ref-R-chron" role="doc-biblioref">James and Hornik 2022</a>)</span>, <code>timeDate</code> <span class="citation">(<a href="refer%C3%AAncias.html#ref-R-timeDate" role="doc-biblioref">Wuertz, Setz, and Chalabi 2022</a>)</span> e <code>bizdays</code> <span class="citation">(<a href="refer%C3%AAncias.html#ref-R-bizdays" role="doc-biblioref">Freitas 2022</a>)</span>. </p>
<p>Antes de começarmos, vale relembrar que toda data no R segue o formato <a href="https://www.iso.org/iso-8601-date-and-time-format.html">ISO 8601</a> (<code>YYYY-MM-DD</code>), onde <code>YYYY</code> é o ano em quatro números, <code>MM</code> é o mês e <code>DD</code> é o dia. Por exemplo, uma data em ISO 8601 é 2022-08-10. Deves familiarizar-se com esse formato pois toda importação de dados com formato de datas diferente desta notação exigirá conversão. Felizmente, essa operação é bastante simples de executar com o <code>lubridate</code>.</p>
<div id="criando-datas-simples" class="section level3" number="7.5.1">
<h3>
<span class="header-section-number">7.5.1</span> Criando Datas Simples<a class="anchor" aria-label="anchor" href="#criando-datas-simples"><i class="fas fa-link"></i></a>
</h3>
<p>No R, existem diversas classes que podem representar datas. A escolha entre uma classe de datas e outra baseia-se na necessidade da pesquisa. Em muitas situações não é necessário saber o horário, enquanto que em outras isso é extremamente pertinente pois os dados são coletados ao longo de um dia.</p>
<p>A classe mais básica de datas é <code>Date</code>. Essa indica dia, mês e ano, apenas. No <code>lubridate</code>, criamos datas verificando o formato da data de entrada e as funções <code>ymd</code> (year-month-date), <code>dmy</code> (day-month-year) e <code>mdy</code> (month-day-year). Veja a seguir: </p>
<div class="sourceCode" id="cb775"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org">lubridate</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># set Date object</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html">ymd</a></span><span class="op">(</span><span class="st">'2021-06-24'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1] "2021-06-24"</code></pre>
<div class="sourceCode" id="cb777"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># set Date object</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html">dmy</a></span><span class="op">(</span><span class="st">'24-06-2021'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1] "2021-06-24"</code></pre>
<div class="sourceCode" id="cb779"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># set Date object</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html">mdy</a></span><span class="op">(</span><span class="st">'06-24-2021'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1] "2021-06-24"</code></pre>
<p>Note que as funções retornam exatamente o mesmo objeto. A diferença no uso é somente pela forma que a data de entrada está estruturada com a posição do dia, mês e ano.</p>
<p>Um benefício no uso das funções do pacote <code>lubridate</code> é que as mesmas são inteligentes ao lidar com formatos diferentes. Observe no caso anterior que definimos os elementos das datas com o uso do traço (<code>-</code>) como separador e valores numéricos. Outros formatos também são automaticamente reconhecidos:</p>
<div class="sourceCode" id="cb781"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># set Date object</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html">ymd</a></span><span class="op">(</span><span class="st">'2021/06/24'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1] "2021-06-24"</code></pre>
<div class="sourceCode" id="cb783"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># set Date object</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html">ymd</a></span><span class="op">(</span><span class="st">'2021&amp;06&amp;24'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1] "2021-06-24"</code></pre>
<div class="sourceCode" id="cb785"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># set Date object</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html">ymd</a></span><span class="op">(</span><span class="st">'2021 june 24'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1] "2021-06-24"</code></pre>
<div class="sourceCode" id="cb787"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># set Date object</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html">dmy</a></span><span class="op">(</span><span class="st">'24 of june 2021'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1] "2021-06-24"</code></pre>
<p>Isso é bastante útil pois o formato de datas no Brasil é <code>dia/mês/ano</code> (DD/MM/YYYY). Ao usar <code>dmy</code> para uma data brasileira, a conversão é correta:</p>
<div class="sourceCode" id="cb789"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># set Date from dd/mm/yyyy</span></span>
<span><span class="va">my_date</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html">dmy</a></span><span class="op">(</span><span class="st">'24/06/2021'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># print result</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_date</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1] "2021-06-24"</code></pre>
<p>Já no pacote <code>base</code>, a função correspondente é <code>as.Date</code>. O formato da data, porém, deve ser explicitamente definido com argumento <code>format</code>, conforme mostrado a seguir:</p>
<div class="sourceCode" id="cb791"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># set Date from dd/mm/yyyy with the definition of format</span></span>
<span><span class="va">my_date</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/zoo/man/yearmon.html">as.Date</a></span><span class="op">(</span><span class="st">'24/06/2021'</span>, format <span class="op">=</span> <span class="st">'%d/%m/%Y'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># print result</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_date</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1] "2021-06-24"</code></pre>
<p>Os símbolos utilizados na entrada <code>format</code>, tal como <code>%d</code> e <code>%Y</code>, são indicadores de formato, os quais definem a forma em que a data a ser convertida está estruturada. Nesse caso, os símbolos <code>%Y</code>, <code>%m</code> e <code>%d</code> definem ano, mês e dia, respectivamente. Existem diversos outros símbolos que podem ser utilizados para processar datas em formatos específicos. Um panorama das principais codificações é apresentado a seguir:</p>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="center">Código</th>
<th align="center">Valor</th>
<th align="center">Exemplo</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">%d</td>
<td align="center">dia do mês (decimal)</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center">%m</td>
<td align="center">mês (decimal)</td>
<td align="center">12</td>
</tr>
<tr class="odd">
<td align="center">%b</td>
<td align="center">mês (abreviado)</td>
<td align="center">Abr</td>
</tr>
<tr class="even">
<td align="center">%B</td>
<td align="center">mês (nome completo)</td>
<td align="center">Abril</td>
</tr>
<tr class="odd">
<td align="center">%y</td>
<td align="center">ano (2 dígitos)</td>
<td align="center">16</td>
</tr>
<tr class="even">
<td align="center">%Y</td>
<td align="center">ano (4 dígitos)</td>
<td align="center">2021</td>
</tr>
</tbody>
</table></div>
<p>Os símbolos anteriores permitem a criação de datas a partir de variados formatos. Observe como a utilização das funções do <code>lubridate</code>, em relação a <code>base</code>, são mais simples e fáceis de utilizar, justificando a nossa escolha.</p>
</div>
<div id="criando-sequências-de-datas" class="section level3" number="7.5.2">
<h3>
<span class="header-section-number">7.5.2</span> Criando Sequências de Datas<a class="anchor" aria-label="anchor" href="#criando-sequ%C3%AAncias-de-datas"><i class="fas fa-link"></i></a>
</h3>
<p>Um aspecto interessante no uso de objetos do tipo <code>Date</code> é que eles interagem com operações de adição de valores numéricos e com testes lógicos de comparação de datas. Por exemplo: caso quiséssemos adicionar um dia à data <code>my_date</code> criada anteriormente, bastaria somar o valor 1 ao objeto:</p>
<div class="sourceCode" id="cb793"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create date</span></span>
<span><span class="va">my_date</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html">ymd</a></span><span class="op">(</span><span class="st">'2021-06-24'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># find next day</span></span>
<span><span class="va">my_date_2</span> <span class="op">&lt;-</span> <span class="va">my_date</span> <span class="op">+</span> <span class="fl">1</span></span>
<span></span>
<span><span class="co"># print result</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_date_2</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1] "2021-06-25"</code></pre>
<p>A propriedade também funciona com vetores, o que deixa a criação de sequências de datas muito fácil. Nesse caso, o próprio R encarrega-se de verificar o número de dias em cada mês.</p>
<div class="sourceCode" id="cb795"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create a sequence of Dates</span></span>
<span><span class="va">my_date_vec</span> <span class="op">&lt;-</span> <span class="va">my_date</span> <span class="op">+</span> <span class="fl">0</span><span class="op">:</span><span class="fl">15</span></span>
<span></span>
<span><span class="co"># print it</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_date_vec</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt;  [1] "2021-06-24" "2021-06-25" "2021-06-26" "2021-06-27"
R&gt;  [5] "2021-06-28" "2021-06-29" "2021-06-30" "2021-07-01"
R&gt;  [9] "2021-07-02" "2021-07-03" "2021-07-04" "2021-07-05"
R&gt; [13] "2021-07-06" "2021-07-07" "2021-07-08" "2021-07-09"</code></pre>
<p>Uma maneira mais customizável de criar sequências de datas é utilizar a função <code>seq</code>. Com ela, é possível definir intervalos diferentes de tempo e até mesmo o tamanho do vetor de saída. Caso quiséssemos uma sequência de datas de dois em dois dias, poderíamos utilizar o seguinte código: </p>
<div class="sourceCode" id="cb797"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># set first and last Date</span></span>
<span><span class="va">my_date_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html">ymd</a></span><span class="op">(</span><span class="st">'2021-03-07'</span><span class="op">)</span></span>
<span><span class="va">my_date_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html">ymd</a></span><span class="op">(</span><span class="st">'2021-03-20'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># set sequence</span></span>
<span><span class="va">my_date_date</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="va">my_date_1</span>,</span>
<span>                    to <span class="op">=</span> <span class="va">my_date_2</span>,</span>
<span>                    by <span class="op">=</span> <span class="st">'2 days'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># print result</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_date_date</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1] "2021-03-07" "2021-03-09" "2021-03-11" "2021-03-13"
R&gt; [5] "2021-03-15" "2021-03-17" "2021-03-19"</code></pre>
<p>Caso quiséssemos de duas em duas semanas, escreveríamos:</p>
<div class="sourceCode" id="cb799"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># set first and last Date</span></span>
<span><span class="va">my_date_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html">ymd</a></span><span class="op">(</span><span class="st">'2021-03-07'</span><span class="op">)</span></span>
<span><span class="va">my_date_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html">ymd</a></span><span class="op">(</span><span class="st">'2021-04-20'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># set sequence</span></span>
<span><span class="va">my_date_date</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="va">my_date_1</span>,</span>
<span>                    to <span class="op">=</span> <span class="va">my_date_2</span>,</span>
<span>                    by <span class="op">=</span> <span class="st">'2 weeks'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># print result</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_date_date</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1] "2021-03-07" "2021-03-21" "2021-04-04" "2021-04-18"</code></pre>
<p>Outra forma de utilizar <code>seq</code> é definir o tamanho desejado do objeto de saída. Por exemplo, caso quiséssemos um vetor de datas com 10 elementos, usaríamos:</p>
<div class="sourceCode" id="cb801"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># set first and last Date</span></span>
<span><span class="va">my_date_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html">ymd</a></span><span class="op">(</span><span class="st">'2021-03-07'</span><span class="op">)</span></span>
<span><span class="va">my_date_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html">ymd</a></span><span class="op">(</span><span class="st">'2021-10-20'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># set sequence</span></span>
<span><span class="va">my_date_vec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="va">my_date_1</span>,</span>
<span>                    to <span class="op">=</span> <span class="va">my_date_2</span>,</span>
<span>                    length.out <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># print result</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_date_vec</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt;  [1] "2021-03-07" "2021-04-01" "2021-04-26" "2021-05-21"
R&gt;  [5] "2021-06-15" "2021-07-11" "2021-08-05" "2021-08-30"
R&gt;  [9] "2021-09-24" "2021-10-20"</code></pre>
<p>O intervalo entre as datas em <code>my_date_vec</code> é definido automaticamente pelo R.</p>
</div>
<div id="operações-com-datas" class="section level3" number="7.5.3">
<h3>
<span class="header-section-number">7.5.3</span> Operações com Datas<a class="anchor" aria-label="anchor" href="#opera%C3%A7%C3%B5es-com-datas"><i class="fas fa-link"></i></a>
</h3>
<p>É possível descobrir a diferença de dias entre datas simplesmente diminuindo uma data da outra:</p>
<div class="sourceCode" id="cb803"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># set dates</span></span>
<span><span class="va">my_date_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html">ymd</a></span><span class="op">(</span><span class="st">'2015-06-24'</span><span class="op">)</span></span>
<span><span class="va">my_date_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html">ymd</a></span><span class="op">(</span><span class="st">'2016-06-24'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># calculate difference</span></span>
<span><span class="va">diff_date</span> <span class="op">&lt;-</span> <span class="va">my_date_2</span> <span class="op">-</span> <span class="va">my_date_1</span></span>
<span></span>
<span><span class="co"># print result</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">diff_date</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; Time difference of 366 days</code></pre>
<p>A saída da operação de subtração é um objeto da classe <code>diffdate</code>, o qual possui a classe de lista como sua estrutura básica. Destaca-se que a notação de acesso aos elementos da classe <code>diffdate</code> é a mesma utilizada para listas. O valor numérico do número de dias está contido no primeiro elemento de <code>diff_date</code>:</p>
<div class="sourceCode" id="cb805"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># print difference of days as numerical value</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">diff_date</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1] 366</code></pre>
<p>Podemos testar se uma data é maior do que outra com o uso das operações de comparação:</p>
<div class="sourceCode" id="cb807"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># set date and vector</span></span>
<span><span class="va">my_date_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html">ymd</a></span><span class="op">(</span><span class="st">'2016-06-20'</span><span class="op">)</span></span>
<span><span class="va">my_date_vec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html">ymd</a></span><span class="op">(</span><span class="st">'2016-06-20'</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>,<span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># test which elements of my_date_vec are older than my_date_1</span></span>
<span><span class="va">my_test</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">my_date_vec</span> <span class="op">&gt;</span> <span class="va">my_date_1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># print result</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_test</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt;  [1] FALSE FALSE FALSE FALSE FALSE FALSE  TRUE  TRUE  TRUE
R&gt; [10]  TRUE  TRUE</code></pre>
<p>A operação anterior é bastante útil quando se está buscando filtrar um determinado período de tempo nos dados. Nesse caso, basta buscar nas datas o período específico em que estamos interessados e utilizar o objeto lógico da comparação para selecionar os elementos. Veja o exemplo a seguir:</p>
<div class="sourceCode" id="cb809"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org">lubridate</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># set first and last dates</span></span>
<span><span class="va">first_date</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html">ymd</a></span><span class="op">(</span><span class="st">'2016-06-01'</span><span class="op">)</span></span>
<span><span class="va">last_date</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html">ymd</a></span><span class="op">(</span><span class="st">'2016-06-15'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># create `dataframe` and glimpse it</span></span>
<span><span class="va">my_temp_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>date_vec <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html">ymd</a></span><span class="op">(</span><span class="st">'2016-05-25'</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">30</span><span class="op">)</span>,</span>
<span>                     prices<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">10</span>,</span>
<span>                                length.out <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">date_vec</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html">glimpse</a></span><span class="op">(</span><span class="va">my_temp_df</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; Rows: 31
R&gt; Columns: 2
R&gt; $ date_vec &lt;date&gt; 2016-05-25, 2016-05-26, 2016-05-27, 2016…
R&gt; $ prices   &lt;dbl&gt; 1.0, 1.3, 1.6, 1.9, 2.2, 2.5, 2.8, 3.1, 3…</code></pre>
<div class="sourceCode" id="cb811"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># find dates that are between the first and last date</span></span>
<span><span class="va">my_idx</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">my_temp_df</span><span class="op">$</span><span class="va">date_vec</span> <span class="op">&gt;=</span> <span class="va">first_date</span><span class="op">)</span> <span class="op">&amp;</span></span>
<span>  <span class="op">(</span><span class="va">my_temp_df</span><span class="op">$</span><span class="va">date_vec</span> <span class="op">&lt;=</span> <span class="va">last_date</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># use index to filter `dataframe`</span></span>
<span><span class="va">my_temp_df_filtered</span> <span class="op">&lt;-</span> <span class="va">my_temp_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">my_idx</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html">glimpse</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; Rows: 15
R&gt; Columns: 2
R&gt; $ date_vec &lt;date&gt; 2016-06-01, 2016-06-02, 2016-06-03, 2016…
R&gt; $ prices   &lt;dbl&gt; 3.1, 3.4, 3.7, 4.0, 4.3, 4.6, 4.9, 5.2, 5…</code></pre>
<p>Nesse caso, o vetor final de preços da coluna <code>prices</code> contém apenas informações para o período entre <code>first_date</code> e <code>last_date</code>.</p>
</div>
<div id="lidando-com-data-e-tempo" class="section level3" number="7.5.4">
<h3>
<span class="header-section-number">7.5.4</span> Lidando com Data e Tempo<a class="anchor" aria-label="anchor" href="#lidando-com-data-e-tempo"><i class="fas fa-link"></i></a>
</h3>
<p>O uso da classe <code>Date</code> é suficiente quando se está lidando apenas com datas. Em casos em que é necessário levar em consideração o horário, temos que utilizar um objeto do tipo <code>datetime</code>.</p>
<p>No pacote <code>base</code>, uma das classes utilizadas para esse fim é a <code>POSIXlt</code>, a qual armazena o conteúdo de uma data na forma de uma lista. Outra classe que também é possível utilizar é a <code>POSIXct</code>, que armazena as datas como segundos contados a partir de <code>1970-01-01</code>. Devido ao seu formato de armazenamento, a classe <code>POSIXct</code> ocupa menos memória do computador. Junto ao <code>lubridate</code>, a classe utilizada para representar data-tempo é <code>POSIXct</code> e portanto daremos prioridade a essa. Vale destacar que todos os exemplos apresentados aqui também podem ser replicados para objetos do tipo <code>POSIXlt</code>.</p>
<p>O formato tempo/data também segue a norma <a href="https://www.iso.org/iso-8601-date-and-time-format.html">ISO 8601</a>, sendo representado como <code>ano-mês-dia horas:minutos:segundos zonadetempo</code> (YYYY-MM-DD HH:mm:SS TMZ). Veja o exemplo a seguir:</p>
<div class="sourceCode" id="cb813"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># creating a POSIXct object</span></span>
<span><span class="va">my_timedate</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html">as.POSIXct</a></span><span class="op">(</span><span class="st">'2021-01-01 16:00:00'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># print result</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_timedate</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1] "2021-01-01 16:00:00 -03"</code></pre>
<p>O pacote <code>lubridate</code> também oferece funções inteligentes para a criação de objetos do tipo data-tempo. Essas seguem a mesma linha de raciocínio que as funções de criar datas. Veja a seguir:</p>
<div class="sourceCode" id="cb815"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org">lubridate</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># creating a POSIXlt object</span></span>
<span><span class="va">my_timedate</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd_hms.html">ymd_hms</a></span><span class="op">(</span><span class="st">'2021-01-01 16:00:00'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># print it</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_timedate</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1] "2021-01-01 16:00:00 UTC"</code></pre>
<p>Destaca-se que essa classe adiciona automaticamente o fuso horário. Caso seja necessário representar um fuso diferente, é possível fazê-lo com o argumento <code>tz</code>:</p>
<div class="sourceCode" id="cb817"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># creating a POSIXlt object with custom timezone</span></span>
<span><span class="va">my_timedate_tz</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd_hms.html">ymd_hms</a></span><span class="op">(</span><span class="st">'2021-01-01 16:00:00'</span>,</span>
<span>                          tz <span class="op">=</span> <span class="st">'GMT'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># print it</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_timedate_tz</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1] "2021-01-01 16:00:00 GMT"</code></pre>
<p>É importante ressaltar que, para o caso de objetos do tipo <code>POSIXlt</code> e <code>POSIXct</code>, <strong>as operações de soma e diminuição referem-se a segundos</strong> e não dias, como no caso do objeto da classe <code>Date</code>.</p>
<div class="sourceCode" id="cb819"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Adding values (seconds) to a POSIXlt object and printing it</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_timedate_tz</span> <span class="op">+</span> <span class="fl">30</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1] "2021-01-01 16:00:30 GMT"</code></pre>
<p>Assim como para a classe <code>Date</code>, existem símbolos específicos para lidar com componentes de um objeto do tipo data/tempo. Isso permite a formatação customizada de datas. A seguir, apresentamos um quadro com os principais símbolos e os seus respectivos significados.</p>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="center">Código</th>
<th align="center">Valor</th>
<th align="center">Exemplo</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">%H</td>
<td align="center">Hora (decimal, 24 horas)</td>
<td align="center">23</td>
</tr>
<tr class="even">
<td align="center">%I</td>
<td align="center">Hora (decimal, 12 horas)</td>
<td align="center">11</td>
</tr>
<tr class="odd">
<td align="center">%M</td>
<td align="center">Minuto (decimal, 0-59)</td>
<td align="center">12</td>
</tr>
<tr class="even">
<td align="center">%p</td>
<td align="center">Indicador AM/PM</td>
<td align="center">AM</td>
</tr>
<tr class="odd">
<td align="center">%S</td>
<td align="center">Segundos (decimal, 0-59)</td>
<td align="center">50</td>
</tr>
</tbody>
</table></div>
<p>A seguir veremos como utilizar essa tabela para customizar datas.</p>
</div>
<div id="personalizando-o-formato-de-datas" class="section level3" number="7.5.5">
<h3>
<span class="header-section-number">7.5.5</span> Personalizando o Formato de Datas<a class="anchor" aria-label="anchor" href="#personalizando-o-formato-de-datas"><i class="fas fa-link"></i></a>
</h3>
<p>A notação básica para representar datas e data/tempo no R pode não ser a ideal em algumas situações. No Brasil, por exemplo, indicar datas no formato <code>YYYY-MM-DD</code> pode gerar bastante confusão em um relatório formal. É recomendado, portanto, modificar a representação das datas para o formato esperado, isto é, <code>DD/MM/YYYY</code>.</p>
<p>Para formatar uma data, utilizamos a função <code>format</code>. Seu uso baseia-se nos símbolos de data e de horário apresentados anteriormente. A partir desses, pode-se criar qualquer customização. Veja o exemplo a seguir, onde apresenta-se a modificação de um vetor de datas para o formato brasileiro:</p>
<div class="sourceCode" id="cb821"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create vector of dates</span></span>
<span><span class="va">my_dates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html">ymd</a></span><span class="op">(</span><span class="st">'2021-01-01'</span><span class="op">)</span>,</span>
<span>                to <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html">ymd</a></span><span class="op">(</span><span class="st">'2021-01-15'</span><span class="op">)</span>,</span>
<span>                by <span class="op">=</span> <span class="st">'1 day'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># change format</span></span>
<span><span class="va">my_dates_br</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="va">my_dates</span>, <span class="st">'%d/%m/%Y'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># print result</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_dates_br</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt;  [1] "01/01/2021" "02/01/2021" "03/01/2021" "04/01/2021"
R&gt;  [5] "05/01/2021" "06/01/2021" "07/01/2021" "08/01/2021"
R&gt;  [9] "09/01/2021" "10/01/2021" "11/01/2021" "12/01/2021"
R&gt; [13] "13/01/2021" "14/01/2021" "15/01/2021"</code></pre>
<p>O mesmo procedimento pode ser realizado para objetos do tipo data/tempo (<code>POSIXct</code>):</p>
<div class="sourceCode" id="cb823"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create vector of date-time</span></span>
<span><span class="va">my_datetime</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd_hms.html">ymd_hms</a></span><span class="op">(</span><span class="st">'2021-01-01 12:00:00'</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">560</span>,<span class="fl">60</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># change to Brazilian format</span></span>
<span><span class="va">my_dates_br</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="va">my_datetime</span>, <span class="st">'%d/%m/%Y %H:%M:%S'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># print result</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_dates_br</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt;  [1] "01/01/2021 12:00:00" "01/01/2021 12:01:00"
R&gt;  [3] "01/01/2021 12:02:00" "01/01/2021 12:03:00"
R&gt;  [5] "01/01/2021 12:04:00" "01/01/2021 12:05:00"
R&gt;  [7] "01/01/2021 12:06:00" "01/01/2021 12:07:00"
R&gt;  [9] "01/01/2021 12:08:00" "01/01/2021 12:09:00"</code></pre>
<p>Pode-se também customizar para formatos bem específicos. Veja a seguir:</p>
<div class="sourceCode" id="cb825"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># set custom format</span></span>
<span><span class="va">my_dates_custom</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="va">my_dates</span>,</span>
<span>                          <span class="st">'Year=%Y | Month=%m | Day=%d'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># print result</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_dates_custom</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt;  [1] "Year=2021 | Month=01 | Day=01"
R&gt;  [2] "Year=2021 | Month=01 | Day=02"
R&gt;  [3] "Year=2021 | Month=01 | Day=03"
R&gt;  [4] "Year=2021 | Month=01 | Day=04"
R&gt;  [5] "Year=2021 | Month=01 | Day=05"
R&gt;  [6] "Year=2021 | Month=01 | Day=06"
R&gt;  [7] "Year=2021 | Month=01 | Day=07"
R&gt;  [8] "Year=2021 | Month=01 | Day=08"
R&gt;  [9] "Year=2021 | Month=01 | Day=09"
R&gt; [10] "Year=2021 | Month=01 | Day=10"
R&gt; [11] "Year=2021 | Month=01 | Day=11"
R&gt; [12] "Year=2021 | Month=01 | Day=12"
R&gt; [13] "Year=2021 | Month=01 | Day=13"
R&gt; [14] "Year=2021 | Month=01 | Day=14"
R&gt; [15] "Year=2021 | Month=01 | Day=15"</code></pre>
</div>
<div id="extraindo-elementos-de-uma-data" class="section level3" number="7.5.6">
<h3>
<span class="header-section-number">7.5.6</span> Extraindo Elementos de uma Data<a class="anchor" aria-label="anchor" href="#extraindo-elementos-de-uma-data"><i class="fas fa-link"></i></a>
</h3>
<p>Para extrair elementos de datas tal como o ano, mês, dia, hora, minuto e segundo, uma alternativa é utilizar função <code>format</code>. Observe o próximo exemplo, onde recuperamos apenas as horas de um objeto <code>POSIXct</code>: </p>
<div class="sourceCode" id="cb827"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org">lubridate</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># create vector of date-time</span></span>
<span><span class="va">my_datetime</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd_hms.html">ymd_hms</a></span><span class="op">(</span><span class="st">'2021-01-01 12:00:00'</span><span class="op">)</span>,</span>
<span>                   to <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd_hms.html">ymd_hms</a></span><span class="op">(</span><span class="st">'2021-01-01 18:00:00'</span><span class="op">)</span>,</span>
<span>                   by <span class="op">=</span> <span class="st">'1 hour'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># get hours from POSIXlt</span></span>
<span><span class="va">my_hours</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="va">my_datetime</span>, <span class="st">'%H'</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># print result</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_hours</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1] 12 13 14 15 16 17 18</code></pre>
<p>Da mesma forma, poderíamos utilizar os símbolos <code>%M</code> e <code>%S</code> para recuperar facilmente minutos e segundos de um vetor de objetos <code>POSIXct</code>.</p>
<div class="sourceCode" id="cb829"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create vector of date-time</span></span>
<span><span class="va">my_datetime</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd_hms.html">ymd_hms</a></span><span class="op">(</span><span class="st">'2021-01-01 12:00:00'</span><span class="op">)</span>,</span>
<span>                   to <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd_hms.html">ymd_hms</a></span><span class="op">(</span><span class="st">'2021-01-01 18:00:00'</span><span class="op">)</span>,</span>
<span>                   by <span class="op">=</span> <span class="st">'15 min'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># get minutes from POSIXlt</span></span>
<span><span class="va">my_minutes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="va">my_datetime</span>, <span class="st">'%M'</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># print result</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_minutes</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt;  [1]  0 15 30 45  0 15 30 45  0 15 30 45  0 15 30 45  0 15
R&gt; [19] 30 45  0 15 30 45  0</code></pre>
<p>Outra forma é utilizar as funções do <code>lubridate</code>, tal como <code>hour</code> e <code>minute</code>: </p>
<div class="sourceCode" id="cb831"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get hours with lubridate</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/hour.html">hour</a></span><span class="op">(</span><span class="va">my_datetime</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt;  [1] 12 12 12 12 13 13 13 13 14 14 14 14 15 15 15 15 16 16
R&gt; [19] 16 16 17 17 17 17 18</code></pre>
<div class="sourceCode" id="cb833"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get minutes with lubridate</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/minute.html">minute</a></span><span class="op">(</span><span class="va">my_datetime</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt;  [1]  0 15 30 45  0 15 30 45  0 15 30 45  0 15 30 45  0 15
R&gt; [19] 30 45  0 15 30 45  0</code></pre>
<p>Outras funções também estão disponíveis para os demais elementos de um objeto data-hora.</p>
</div>
<div id="conhecendo-o-horário-e-a-data-atual" class="section level3" number="7.5.7">
<h3>
<span class="header-section-number">7.5.7</span> Conhecendo o Horário e a Data Atual<a class="anchor" aria-label="anchor" href="#conhecendo-o-hor%C3%A1rio-e-a-data-atual"><i class="fas fa-link"></i></a>
</h3>
<p>O R inclui várias funções que permitem o usuário utilizar no seu código o horário e data atual do sistema. Isso é bastante útil quando se está criando registros e é importante que a data e horário de execução do código seja conhecida futuramente.</p>
<p>Para conhecer o dia atual, basta utilizarmos a função <code><a href="https://rdrr.io/r/base/Sys.time.html">base::Sys.Date</a></code> ou <code><a href="https://lubridate.tidyverse.org/reference/now.html">lubridate::today</a></code>: </p>
<div class="sourceCode" id="cb835"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org">lubridate</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># get today</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.Date</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1] "2022-08-10"</code></pre>
<div class="sourceCode" id="cb837"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># print it</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/now.html">today</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1] "2022-08-10"</code></pre>
<p>Para descobrir a data e horário, utilizamos a função <code><a href="https://rdrr.io/r/base/Sys.time.html">base::Sys.time</a></code> ou <code><a href="https://lubridate.tidyverse.org/reference/now.html">lubridate::now</a></code>: </p>
<div class="sourceCode" id="cb839"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get time!</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.time</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1] "2022-08-10 08:17:10 -03"</code></pre>
<div class="sourceCode" id="cb841"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get time!</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/now.html">now</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1] "2022-08-10 08:17:10 -03"</code></pre>
<p>Com base nessas, podemos escrever:</p>
<div class="sourceCode" id="cb843"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://stringr.tidyverse.org">stringr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># example of log message</span></span>
<span><span class="va">my_str</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_c.html">str_c</a></span><span class="op">(</span><span class="st">'This code was executed in '</span>, <span class="fu"><a href="https://lubridate.tidyverse.org/reference/now.html">now</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># print it</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_str</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1] "This code was executed in 2022-08-10 08:17:10"</code></pre>
</div>
<div id="outras-funções-úteis-5" class="section level3" number="7.5.8">
<h3>
<span class="header-section-number">7.5.8</span> Outras Funções Úteis<a class="anchor" aria-label="anchor" href="#outras-fun%C3%A7%C3%B5es-%C3%BAteis-5"><i class="fas fa-link"></i></a>
</h3>
<p><strong>weekdays</strong> - Retorna o dia da semana de uma ou várias datas.</p>
<div class="sourceCode" id="cb845"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># set date vector</span></span>
<span><span class="va">my_dates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html">ymd</a></span><span class="op">(</span><span class="st">'2021-01-01'</span><span class="op">)</span>,</span>
<span>                to <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html">ymd</a></span><span class="op">(</span><span class="st">'2021-01-5'</span><span class="op">)</span>,</span>
<span>                by <span class="op">=</span> <span class="st">'1 day'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># find corresponding weekdays</span></span>
<span><span class="va">my_weekdays</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/weekday.POSIXt.html">weekdays</a></span><span class="op">(</span><span class="va">my_dates</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># print it</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_weekdays</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1] "Friday"   "Saturday" "Sunday"   "Monday"   "Tuesday"</code></pre>
<p><strong>months</strong> - Retorna o mês de uma ou várias datas.</p>
<div class="sourceCode" id="cb847"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create date vector</span></span>
<span><span class="va">my_dates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html">ymd</a></span><span class="op">(</span><span class="st">'2021-01-01'</span><span class="op">)</span>,</span>
<span>                to <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html">ymd</a></span><span class="op">(</span><span class="st">'2021-12-31'</span><span class="op">)</span>,</span>
<span>                by <span class="op">=</span> <span class="st">'1 month'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># find months</span></span>
<span><span class="va">my_months</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/weekday.POSIXt.html">months</a></span><span class="op">(</span><span class="va">my_dates</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># print result</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_months</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt;  [1] "January"   "February"  "March"     "April"    
R&gt;  [5] "May"       "June"      "July"      "August"   
R&gt;  [9] "September" "October"   "November"  "December"</code></pre>
<p><strong>quarters</strong> - Retorna a localização de uma ou mais datas dentro dos quartis do ano.</p>
<div class="sourceCode" id="cb849"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get quartiles of the year</span></span>
<span><span class="va">my_quarters</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/weekday.POSIXt.html">quarters</a></span><span class="op">(</span><span class="va">my_dates</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_quarters</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt;  [1] "Q1" "Q1" "Q1" "Q2" "Q2" "Q2" "Q3" "Q3" "Q3" "Q4" "Q4"
R&gt; [12] "Q4"</code></pre>
<p><strong>OlsonNames</strong> - Retorna um vetor com as zonas de tempo disponíveis no R. No total, são mais de 500 itens. Aqui, apresentamos apenas os primeiros cinco elementos.</p>
<div class="sourceCode" id="cb851"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get possible timezones</span></span>
<span><span class="va">possible_tz</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/timezones.html">OlsonNames</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># print it</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">possible_tz</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1] "Africa/Abidjan"     "Africa/Accra"      
R&gt; [3] "Africa/Addis_Ababa" "Africa/Algiers"    
R&gt; [5] "Africa/Asmara"</code></pre>
<p><strong>Sys.timezone</strong> - Retorna a zona de tempo do sistema.</p>
<div class="sourceCode" id="cb853"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get current timezone</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/timezones.html">Sys.timezone</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1] "America/Sao_Paulo"</code></pre>
<p><strong>cut</strong> - Retorna um fator a partir da categorização de uma classe de data e tempo.</p>
<div class="sourceCode" id="cb855"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># set example date vector</span></span>
<span><span class="va">my_dates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html">ymd</a></span><span class="op">(</span><span class="st">'2021-01-01'</span><span class="op">)</span>,</span>
<span>                to <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html">ymd</a></span><span class="op">(</span><span class="st">'2021-03-01'</span><span class="op">)</span>,</span>
<span>                by <span class="op">=</span> <span class="st">'5 days'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># group vector based on monthly breaks</span></span>
<span><span class="va">my_month_cut</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html">cut</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">my_dates</span>,</span>
<span>                    breaks <span class="op">=</span> <span class="st">'month'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># print result</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_month_cut</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt;  [1] 2021-01-01 2021-01-01 2021-01-01 2021-01-01 2021-01-01
R&gt;  [6] 2021-01-01 2021-01-01 2021-02-01 2021-02-01 2021-02-01
R&gt; [11] 2021-02-01 2021-02-01
R&gt; Levels: 2021-01-01 2021-02-01</code></pre>
<div class="sourceCode" id="cb857"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># set example datetime vector</span></span>
<span><span class="va">my_datetime</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html">as.POSIXlt</a></span><span class="op">(</span><span class="st">'2021-01-01 12:00:00'</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">250</span>,<span class="fl">15</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># set groups for each 30 seconds</span></span>
<span><span class="va">my_cut</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html">cut</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">my_datetime</span>, breaks <span class="op">=</span> <span class="st">'30 secs'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># print result</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_cut</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt;  [1] 2021-01-01 12:00:00 2021-01-01 12:00:00
R&gt;  [3] 2021-01-01 12:00:30 2021-01-01 12:00:30
R&gt;  [5] 2021-01-01 12:01:00 2021-01-01 12:01:00
R&gt;  [7] 2021-01-01 12:01:30 2021-01-01 12:01:30
R&gt;  [9] 2021-01-01 12:02:00 2021-01-01 12:02:00
R&gt; [11] 2021-01-01 12:02:30 2021-01-01 12:02:30
R&gt; [13] 2021-01-01 12:03:00 2021-01-01 12:03:00
R&gt; [15] 2021-01-01 12:03:30 2021-01-01 12:03:30
R&gt; [17] 2021-01-01 12:04:00
R&gt; 9 Levels: 2021-01-01 12:00:00 ... 2021-01-01 12:04:00</code></pre>
</div>
</div>
<div id="dados-omissos---na-not-available" class="section level2" number="7.6">
<h2>
<span class="header-section-number">7.6</span> Dados Omissos - <code>NA</code> (<em>Not available</em>)<a class="anchor" aria-label="anchor" href="#dados-omissos---na-not-available"><i class="fas fa-link"></i></a>
</h2>
<p>Uma das principais inovações do R em relação a outras linguagens de programação é a representação de dados omissos através de objetos da classe <code>NA</code> (<em>Not Available</em>). A falta de dados pode ter inúmeros motivos, tal como a falha na coleta de informações ou simplesmente a não existência dos mesmos. Esses casos são tratados por meio da remoção ou da substituição dos dados omissos antes realizar uma análise mais profunda. A identificação desses casos, portanto, é de extrema importância.</p>
<div id="definindo-valores-na" class="section level3" number="7.6.1">
<h3>
<span class="header-section-number">7.6.1</span> Definindo Valores <code>NA</code><a class="anchor" aria-label="anchor" href="#definindo-valores-na"><i class="fas fa-link"></i></a>
</h3>
<p>Para definirmos os casos omissos nos dados, basta utilizar o símbolo <code>NA</code>:</p>
<div class="sourceCode" id="cb859"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># a vector with NA</span></span>
<span><span class="va">my_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="cn">NA</span>, <span class="fl">4</span>, <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># print it</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_x</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1]  1  2 NA  4  5</code></pre>
<p>Vale destacar que a operação de qualquer valor <code>NA</code> com outro sempre resultará em <code>NA</code>.</p>
<div class="sourceCode" id="cb861"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># example of NA interacting with other objects</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_x</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1]  2  3 NA  5  6</code></pre>
<p>Isso exige cuidado quando se está utilizando alguma função com cálculo recursivo, tal como <code>cumsum</code> e <code>cumprod</code>. Nesses casos, todo valor consecutivo ao <code>NA</code> será transformado em <code>NA</code>. Veja os exemplos a seguir com as duas funções:</p>
<div class="sourceCode" id="cb863"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># set vector with NA</span></span>
<span><span class="va">my_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="cn">NA</span>, <span class="fl">5</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># print cumsum (NA after sixth element)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="va">my_x</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt;  [1]  1  3  6 10 15 NA NA NA NA NA NA NA</code></pre>
<div class="sourceCode" id="cb865"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># print cumprod (NA after sixth element)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumprod</a></span><span class="op">(</span><span class="va">my_x</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt;  [1]   1   2   6  24 120  NA  NA  NA  NA  NA  NA  NA</code></pre>
<div class="rmdcaution">
<p>
Toda vez que utilizar as funções <code>cumsum</code> e
<code>cumprod</code>, certifique-se de que não existe algum valor
<code>NA</code> no vetor de entrada. Lembre-se de que todo
<code>NA</code> é contagiante e o cálculo recursivo irá resultar em um
vetor repleto de dados faltantes.
</p>
</div>
</div>
<div id="encontrando-e-substituindo-valores-na" class="section level3" number="7.6.2">
<h3>
<span class="header-section-number">7.6.2</span> Encontrando e Substituindo Valores <code>NA</code><a class="anchor" aria-label="anchor" href="#encontrando-e-substituindo-valores-na"><i class="fas fa-link"></i></a>
</h3>
<p>Para encontrar os valores <code>NA</code> em um vetor, basta utilizar a função <code>is.na</code>: </p>
<div class="sourceCode" id="cb867"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># set vector with NA</span></span>
<span><span class="va">my_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="cn">NA</span>, <span class="fl">4</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># find location of NA</span></span>
<span><span class="va">idx_na</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">my_x</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">idx_na</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt;  [1] FALSE FALSE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE
R&gt; [10] FALSE</code></pre>
<p>Para substituí-los, use indexação com a saída de <code>is.na</code>:</p>
<div class="sourceCode" id="cb869"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># set vector</span></span>
<span><span class="va">my_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="cn">NA</span>, <span class="fl">3</span><span class="op">:</span><span class="fl">4</span>, <span class="cn">NA</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># replace NA for 2</span></span>
<span><span class="va">my_x</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">my_x</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span></span>
<span><span class="co"># print result</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_x</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1] 1 2 3 4 2</code></pre>
<p>Outra maneira de limpar o objeto é utilizar a função <code>na.omit</code>, que retorna o mesmo objeto mas sem os valores <code>NA</code>. Note, porém, que o tamanho do vetor irá mudar e o objeto será da classe <code>omit</code>, o que indica que o vetor resultante não inclui os <code>NA</code> e apresenta, também, a posição dos elementos <code>NA</code> encontrados. </p>
<div class="sourceCode" id="cb871"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># set vector</span></span>
<span><span class="va">my_char</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, <span class="cn">NA</span>, <span class="va">letters</span><span class="op">[</span><span class="fl">5</span><span class="op">:</span><span class="fl">8</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># print it</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_char</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1] "a" "b" "c" NA  "e" "f" "g" "h"</code></pre>
<div class="sourceCode" id="cb873"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># use na.omit to remove NA</span></span>
<span><span class="va">my_char</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="va">my_char</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># print result</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">my_char</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1] "a" "b" "c" "e" "f" "g" "h"
R&gt; attr(,"na.action")
R&gt; [1] 4
R&gt; attr(,"class")
R&gt; [1] "omit"</code></pre>
<p>Apesar de o tipo de objeto ter sido trocado, devido ao uso de <code>na.omit</code>, as propriedades básicas do vetor inicial se mantêm. Por exemplo: o uso de <code>nchar</code> no objeto resultante é possível.</p>
<div class="sourceCode" id="cb875"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># trying nchar on a na.omit object</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nchar.html">nchar</a></span><span class="op">(</span><span class="va">my_char</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1] 1 1 1 1 1 1 1</code></pre>
<p>Para outros objetos, porém, recomenda-se cautela quando no uso da função <code>na.omit</code>.</p>
</div>
<div id="outras-funções-úteis-6" class="section level3" number="7.6.3">
<h3>
<span class="header-section-number">7.6.3</span> Outras Funções Úteis<a class="anchor" aria-label="anchor" href="#outras-fun%C3%A7%C3%B5es-%C3%BAteis-6"><i class="fas fa-link"></i></a>
</h3>
<p><strong>complete.cases</strong> - Retorna um vetor lógico que indica se as linhas do objeto possuem apenas valores não omissos. Essa função é usada exclusivamente para <code>dataframes</code> e matrizes.</p>
<div class="sourceCode" id="cb877"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create matrix</span></span>
<span><span class="va">my_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">15</span>, nrow <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># set an NA value</span></span>
<span><span class="va">my_mat</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span></span>
<span><span class="co"># print index with rows without NA</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/complete.cases.html">complete.cases</a></span><span class="op">(</span><span class="va">my_mat</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>R&gt; [1]  TRUE FALSE  TRUE  TRUE  TRUE</code></pre>
</div>
</div>
<div id="exerc-classes-basicas" class="section level2" number="7.7">
<h2>
<span class="header-section-number">7.7</span> Exercícios<a class="anchor" aria-label="anchor" href="#exerc-classes-basicas"><i class="fas fa-link"></i></a>
</h2>
<hr>
<p><span id="webex-total_correct"></span></p>
<div id="q.1-6" class="section level3 unnumbered">
<h3>Q.1<a class="anchor" aria-label="anchor" href="#q.1-6"><i class="fas fa-link"></i></a>
</h3>
<p>Considere os seguintes os vetores x e y:</p>
<pre class="text"><code>set.seed(7)
x &lt;- sample (1:3, size = 5, replace = T)
y &lt;- sample (1:3, size = 5, replace = T)</code></pre>
<p>Qual é a soma dos elementos de um novo vetor resultante da multiplicação entre os elementos de <code>x</code> e <code>y</code>?</p>
<br><br> Resposta: <input class="webex-solveme nospaces" size="2" data-answer='["31"]'><div style="text-align: left; margin-top: 2px; padding: 13px 0 10px 0;">
<p>
<button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#collapse_8e983893309b" aria-expanded="false" aria-controls="collapseExample">
Solução
</button>
</p>
</div>
<div id="collapse_8e983893309b" class="collapse">
A solução é 31. Para chegar no resultado anterior, deves executar o código abaixo. Para isso, abra um novo script no RStudio (Control+shift+N), copie e cole o código, e rode o script inteiro apertando Control+Shift+Enter ou por linha com Control+Enter.
<div class="card card-body">
<pre class="text"><code>set.seed(7)

x &lt;- sample (1:3, size = 5, replace = T)
y &lt;- sample (1:3, size = 5, replace = T)

# solution
my_sol &lt;- sum(x*y)</code></pre>
</div>
</div>
<hr>
<p><span id="webex-total_correct"></span></p>
</div>
<div id="q.2-6" class="section level3 unnumbered">
<h3>Q.2<a class="anchor" aria-label="anchor" href="#q.2-6"><i class="fas fa-link"></i></a>
</h3>
<p>Caso realizássemos uma soma cumulativa de uma sequência entre 1 e 100, em qual elemento esta soma iria passar de 50?</p>
<br><br> Resposta: <input class="webex-solveme nospaces" size="2" data-answer='["10"]'><div style="text-align: left; margin-top: 2px; padding: 13px 0 10px 0;">
<p>
<button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#collapse_8e983f9e54d2" aria-expanded="false" aria-controls="collapseExample">
Solução
</button>
</p>
</div>
<div id="collapse_8e983f9e54d2" class="collapse">
A solução é 10. Para chegar no resultado anterior, deves executar o código abaixo. Para isso, abra um novo script no RStudio (Control+shift+N), copie e cole o código, e rode o script inteiro apertando Control+Shift+Enter ou por linha com Control+Enter.
<div class="card card-body">
<pre class="text"><code>my_sum &lt;- cumsum(1:100)

# solution
my_sol &lt;- (which(my_sum &gt; 50)[1])</code></pre>
</div>
</div>
<hr>
<p><span id="webex-total_correct"></span></p>
</div>
<div id="q.3-5" class="section level3 unnumbered">
<h3>Q.3<a class="anchor" aria-label="anchor" href="#q.3-5"><i class="fas fa-link"></i></a>
</h3>
<p>Utilizando o R, crie uma sequência em objeto chamado <code>seq_1</code> entre -15 e 10, onde o intervalo entre valores é sempre igual a 2. Qual o valor da soma dos elementos de <code>seq_1</code>?</p>
<br><br> Resposta: <input class="webex-solveme nospaces" size="3" data-answer='["-39"]'><div style="text-align: left; margin-top: 2px; padding: 13px 0 10px 0;">
<p>
<button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#collapse_8e9876317e8e" aria-expanded="false" aria-controls="collapseExample">
Solução
</button>
</p>
</div>
<div id="collapse_8e9876317e8e" class="collapse">
A solução é -39. Para chegar no resultado anterior, deves executar o código abaixo. Para isso, abra um novo script no RStudio (Control+shift+N), copie e cole o código, e rode o script inteiro apertando Control+Shift+Enter ou por linha com Control+Enter.
<div class="card card-body">
<pre class="text"><code># solution
seq_1 &lt;- seq(from = -15, to = 10, by = 2)

# solution
my_sol &lt;- sum(seq_1)</code></pre>
</div>
</div>
<hr>
<p><span id="webex-total_correct"></span></p>
</div>
<div id="q.4-5" class="section level3 unnumbered">
<h3>Q.4<a class="anchor" aria-label="anchor" href="#q.4-5"><i class="fas fa-link"></i></a>
</h3>
<p>Defina outro objeto chamado <code>seq_2</code> contendo uma sequência de tamanho 1000, com valores entre 0 e 100. Qual é o desvio padrão (função <code>sd</code>) dessa sequência?</p>
<br> Resposta: <select class="webex-select"><option value="blank"></option>
<option value="">45.26</option>
<option value="">12.94</option>
<option value="answer">28.91</option>
<option value="">74.17</option>
<option value="">22.19</option></select><div style="text-align: left; margin-top: 2px; padding: 13px 0 10px 0;">
<p>
<button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#collapse_8e981b5445db" aria-expanded="false" aria-controls="collapseExample">
Solução
</button>
</p>
</div>
<div id="collapse_8e981b5445db" class="collapse">
A solução é 28.91. Para chegar no resultado anterior, deves executar o código abaixo. Para isso, abra um novo script no RStudio (Control+shift+N), copie e cole o código, e rode o script inteiro apertando Control+Shift+Enter ou por linha com Control+Enter.
<div class="card card-body">
<pre class="text"><code>seq_2 &lt;- seq(from = 0, 
             to = 100, 
             length.out = 1000)

# solution
my_sol &lt;- sd(seq_2)</code></pre>
</div>
</div>
<hr>
<p><span id="webex-total_correct"></span></p>
</div>
<div id="q.5-5" class="section level3 unnumbered">
<h3>Q.5<a class="anchor" aria-label="anchor" href="#q.5-5"><i class="fas fa-link"></i></a>
</h3>
<p>Calcule a soma entre vetores <code>seq_1</code> e <code>seq_2</code> (veja exercícios anteriores). Esta operação funcionou apesar do tamanho diferente dos vetores? Explique sua resposta. Caso funcionar, qual o maior valor do vetor resultante?</p>
<br> Resposta: <select class="webex-select"><option value="blank"></option>
<option value="">164.92</option>
<option value="answer">109.00</option>
<option value=""> 69.48</option>
<option value="">273.91</option>
<option value=""> 31.69</option></select><div style="text-align: left; margin-top: 2px; padding: 13px 0 10px 0;">
<p>
<button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#collapse_8e98e46fa99" aria-expanded="false" aria-controls="collapseExample">
Solução
</button>
</p>
</div>
<div id="collapse_8e98e46fa99" class="collapse">
A solução é 109.00. Para chegar no resultado anterior, deves executar o código abaixo. Para isso, abra um novo script no RStudio (Control+shift+N), copie e cole o código, e rode o script inteiro apertando Control+Shift+Enter ou por linha com Control+Enter.
<div class="card card-body">
<p>Sim, funcionou, mas com um aviso de <em>warning</em>: _ “o comprimento do objeto mais longo não é um múltiplo do comprimento do objeto mais curto” _. A explicação é que sempre que R encontra operações com vetor de tamanhos diferentes, ele usa a regra de reciclagem, onde o vetor mais curto é repetido quantas vezes forem necessárias para coincidir com o tamanho do vetor mais longo. No livro, veja seção sobre vetores numéricos para maiores detalhes.</p>
<pre class="text"><code>seq_1 &lt;- seq(from = -10, to = 10, by = 2)
seq_2 &lt;- seq(from = 0, 
             to = 100, 
             length.out = 1000)

# solution
my_sol &lt;- max(seq_1+seq_2)</code></pre>
</div>
</div>
<hr>
<p><span id="webex-total_correct"></span></p>
</div>
<div id="q.6-4" class="section level3 unnumbered">
<h3>Q.6<a class="anchor" aria-label="anchor" href="#q.6-4"><i class="fas fa-link"></i></a>
</h3>
<p>Vamos supor que, em certa data, você comprou 100 ações de uma empresa, a <code>price_purchase</code> reais por ação. Depois de algum tempo, você vendeu 30 ações por 18 reais cada e as 70 ações restantes foram vendidas por 22 reais em um dia posterior. Usando um <em>script</em> em R, estruture este problema financeiro criando objetos numéricos. Qual é o lucro bruto desta transação no mercado de ações?</p>
<br> Resposta: <select class="webex-select"><option value="blank"></option>
<option value="">R$200,00</option>
<option value="answer">R$580,00</option>
<option value="">R$94,00</option>
<option value="">R$413,00</option>
<option value="">R$307,00</option></select><div style="text-align: left; margin-top: 2px; padding: 13px 0 10px 0;">
<p>
<button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#collapse_8e985aeab055" aria-expanded="false" aria-controls="collapseExample">
Solução
</button>
</p>
</div>
<div id="collapse_8e985aeab055" class="collapse">
A solução é R$580,00. Para chegar no resultado anterior, deves executar o código abaixo. Para isso, abra um novo script no RStudio (Control+shift+N), copie e cole o código, e rode o script inteiro apertando Control+Shift+Enter ou por linha com Control+Enter.
<div class="card card-body">
<pre class="text"><code>total_shares &lt;- 100
price_purchase &lt;- 15

total_purchase_value &lt;- total_shares*price_purchase

qtd_sell_1 &lt;- 30
price_sell_1 &lt;- 18
total_sell_1 &lt;- qtd_sell_1*18

qtd_sell_2 &lt;- total_shares-qtd_sell_1
price_sell_2 &lt;- 22
total_sell_2 &lt;- qtd_sell_2*price_sell_2

total_sell_value &lt;- total_sell_1 + total_sell_2

# solution
my_sol &lt;- total_sell_value - total_purchase_value</code></pre>
</div>
</div>
<hr>
<p><span id="webex-total_correct"></span></p>
</div>
<div id="q.7-4" class="section level3 unnumbered">
<h3>Q.7<a class="anchor" aria-label="anchor" href="#q.7-4"><i class="fas fa-link"></i></a>
</h3>
<p>Crie um vetor x de acordo com a fórmula a seguir, onde <span class="math inline">\(i=1...100\)</span>. Qual é o valor da soma dos elementos de x?</p>
<p><span class="math display">\[
x_i=\frac{-1^{i+1}}{2i-1}
\]</span></p>
<br><br> Resposta: <input class="webex-solveme nospaces" size="9" data-answer='["0.7828982",".7828982"]'><div style="text-align: left; margin-top: 2px; padding: 13px 0 10px 0;">
<p>
<button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#collapse_8e9867177a6b" aria-expanded="false" aria-controls="collapseExample">
Solução
</button>
</p>
</div>
<div id="collapse_8e9867177a6b" class="collapse">
A solução é 0.7828982. Para chegar no resultado anterior, deves executar o código abaixo. Para isso, abra um novo script no RStudio (Control+shift+N), copie e cole o código, e rode o script inteiro apertando Control+Shift+Enter ou por linha com Control+Enter.
<div class="card card-body">
<pre class="text"><code>i &lt;- 1:100

x &lt;- ( (-1)^(i+1) )/(2*i - 1)

# solution
my_sol &lt;- sum(x)</code></pre>
</div>
</div>
<hr>
<p><span id="webex-total_correct"></span></p>
</div>
<div id="q.8-3" class="section level3 unnumbered">
<h3>Q.8<a class="anchor" aria-label="anchor" href="#q.8-3"><i class="fas fa-link"></i></a>
</h3>
<p>Crie um vetor <span class="math inline">\(z_i\)</span> de acordo com a fórmula a seguir onde <span class="math inline">\(x_i=1...50\)</span> e <span class="math inline">\(y_i=50...1\)</span>. Qual é o valor da soma dos elementos de <span class="math inline">\(z_i\)</span>? Dica: veja o funcionamento da função <code>dplyr::lag</code>.</p>
<p><span class="math display">\[
z_i=\frac{y_i - x_{i-1}}{y_{i-2}}
\]</span></p>
<br> Resposta: <select class="webex-select"><option value="blank"></option>
<option value="">-49.38</option>
<option value="">-22.60</option>
<option value="">-35.99</option>
<option value=""> -9.21</option>
<option value="answer">-65.96</option></select><div style="text-align: left; margin-top: 2px; padding: 13px 0 10px 0;">
<p>
<button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#collapse_8e98133593b2" aria-expanded="false" aria-controls="collapseExample">
Solução
</button>
</p>
</div>
<div id="collapse_8e98133593b2" class="collapse">
A solução é -65.96. Para chegar no resultado anterior, deves executar o código abaixo. Para isso, abra um novo script no RStudio (Control+shift+N), copie e cole o código, e rode o script inteiro apertando Control+Shift+Enter ou por linha com Control+Enter.
<div class="card card-body">
<pre class="text"><code>x &lt;- 1:50
y &lt;- 50:1

# solution using `base`
z &lt;- (y - c(NA, x[1:(length(x)-1)]))/c(NA, NA, y[1:(length(y)-2)])

# solution with tidyverse (much prettier huh!)
z &lt;- (y - lag(x, n = 1))/lag(y, n = 2)

# solution (be aware of the NA values)
my_sol &lt;- sum(z, na.rm = TRUE)</code></pre>
</div>
</div>
<hr>
<p><span id="webex-total_correct"></span></p>
</div>
<div id="q.9-2" class="section level3 unnumbered">
<h3>Q.9<a class="anchor" aria-label="anchor" href="#q.9-2"><i class="fas fa-link"></i></a>
</h3>
<p>Usando <code>set.seed(10)</code>, crie um objeto chamado <code>x</code> com valores aleatórios da distribuição Normal com média igual a 10 e desvio padrão igual a 10. Usando função <code>cut</code>, crie outro objeto que defina dois grupos com base em valores de <code>x</code> maiores que 15 e menores que 15. Qual a quantidade de observações no primeiro grupo?</p>
<br><br> Resposta: <input class="webex-solveme nospaces" size="3" data-answer='["668"]'><div style="text-align: left; margin-top: 2px; padding: 13px 0 10px 0;">
<p>
<button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#collapse_8e9832f13b56" aria-expanded="false" aria-controls="collapseExample">
Solução
</button>
</p>
</div>
<div id="collapse_8e9832f13b56" class="collapse">
A solução é 668. Para chegar no resultado anterior, deves executar o código abaixo. Para isso, abra um novo script no RStudio (Control+shift+N), copie e cole o código, e rode o script inteiro apertando Control+Shift+Enter ou por linha com Control+Enter.
<div class="card card-body">
<pre class="text"><code>set.seed(10)
x &lt;- rnorm(n = 1000, mean = 10, sd = 10)

my_group &lt;- cut(x, 
                breaks = c(-Inf, 15, Inf))

# solution
my_sol &lt;- table(my_group)[1]</code></pre>
</div>
</div>
<hr>
<p><span id="webex-total_correct"></span></p>
</div>
<div id="q.10-2" class="section level3 unnumbered">
<h3>Q.10<a class="anchor" aria-label="anchor" href="#q.10-2"><i class="fas fa-link"></i></a>
</h3>
<p>Crie o seguinte objeto com o código a seguir:</p>
<pre class="text"><code>set.seed(15)
my_char &lt;- paste(sample(letters, 5000, replace = T), 
                 collapse = '')</code></pre>
<p>Qual a quantidade de vezes que a letra <code>'x'</code> é encontrada no objeto de texto resultante?</p>
<br><br> Resposta: <input class="webex-solveme nospaces" size="3" data-answer='["174"]'><div style="text-align: left; margin-top: 2px; padding: 13px 0 10px 0;">
<p>
<button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#collapse_8e98352feb4b" aria-expanded="false" aria-controls="collapseExample">
Solução
</button>
</p>
</div>
<div id="collapse_8e98352feb4b" class="collapse">
A solução é 174. Para chegar no resultado anterior, deves executar o código abaixo. Para isso, abra um novo script no RStudio (Control+shift+N), copie e cole o código, e rode o script inteiro apertando Control+Shift+Enter ou por linha com Control+Enter.
<div class="card card-body">
<pre class="text"><code>set.seed(15)
my_char &lt;- paste(sample(letters, 5000, replace = T), 
                 collapse = '')

# solution
my_sol &lt;- str_count(my_char, 'x')</code></pre>
</div>
</div>
<hr>
<p><span id="webex-total_correct"></span></p>
</div>
<div id="q.11-1" class="section level3 unnumbered">
<h3>Q.11<a class="anchor" aria-label="anchor" href="#q.11-1"><i class="fas fa-link"></i></a>
</h3>
<p>Baseado no objeto <code>my_char</code> criado anteriormente, caso dividíssemos o mesmo em diversos pedaços menores utilizando a letra <code>"b"</code>, qual é o número de caracteres no <strong>maior</strong> pedaço encontrado?</p>
<br><br> Resposta: <input class="webex-solveme nospaces" size="3" data-answer='["110"]'><div style="text-align: left; margin-top: 2px; padding: 13px 0 10px 0;">
<p>
<button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#collapse_8e9814355f20" aria-expanded="false" aria-controls="collapseExample">
Solução
</button>
</p>
</div>
<div id="collapse_8e9814355f20" class="collapse">
A solução é 110. Para chegar no resultado anterior, deves executar o código abaixo. Para isso, abra um novo script no RStudio (Control+shift+N), copie e cole o código, e rode o script inteiro apertando Control+Shift+Enter ou por linha com Control+Enter.
<div class="card card-body">
<pre class="text"><code>set.seed(15)
my_char &lt;- paste(sample(letters, 5000, replace = T), 
                 collapse = '')

my_split &lt;- str_split(my_char, pattern = 'b')[[1]]

# find number of characters in each
n_chars &lt;- sapply(my_split, nchar)

# solution
my_sol &lt;- n_chars[which.max(n_chars)]</code></pre>
</div>
</div>
<hr>
<p><span id="webex-total_correct"></span></p>
</div>
<div id="q.12" class="section level3 unnumbered">
<h3>Q.12<a class="anchor" aria-label="anchor" href="#q.12"><i class="fas fa-link"></i></a>
</h3>
<p>No endereço <a href="https://www.gutenberg.org/files/1342/1342-0.txt">https://www.gutenberg.org/files/1342/1342-0.txt</a> é possível acessar um arquivo .txt contendo o texto integral do livro <em>Pride and Prejudice</em> de Jane Austen. Utilize funções <code>download.file</code> e <code><a href="https://readr.tidyverse.org/reference/read_lines.html">readr::read_lines</a></code> para importar o livro inteiro como um vetor de caracteres chamado <code>my_book</code> no R. Quantas linhas o objeto resultante possui?</p>
<br><br> Resposta: <input class="webex-solveme nospaces" size="4" data-answer='["3675"]'><div style="text-align: left; margin-top: 2px; padding: 13px 0 10px 0;">
<p>
<button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#collapse_8e9869d3af40" aria-expanded="false" aria-controls="collapseExample">
Solução
</button>
</p>
</div>
<div id="collapse_8e9869d3af40" class="collapse">
A solução é 3675. Para chegar no resultado anterior, deves executar o código abaixo. Para isso, abra um novo script no RStudio (Control+shift+N), copie e cole o código, e rode o script inteiro apertando Control+Shift+Enter ou por linha com Control+Enter.
<div class="card card-body">
<pre class="text"><code>my_link &lt;- 'https://www.gutenberg.org/ebooks/2264.txt.utf-8'

my_book &lt;- readr::read_lines(my_link)

# solution
my_sol &lt;- length(my_book)</code></pre>
</div>
</div>
<hr>
<p><span id="webex-total_correct"></span></p>
</div>
<div id="q.13" class="section level3 unnumbered">
<h3>Q.13<a class="anchor" aria-label="anchor" href="#q.13"><i class="fas fa-link"></i></a>
</h3>
<p>Junte o vetor de caracteres em <code>my_book</code> para um único valor (texto) em outro objeto chamado <code>full_text</code> usando função <code>paste0(my_book, collapse = '\n')</code>. Utilizando este último e pacote <code>stringr</code>, quantas vezes a palavra <code>'King'</code> é repetida na totalidade do texto?</p>
<br><br> Resposta: <input class="webex-solveme nospaces" size="2" data-answer='["70"]'><div style="text-align: left; margin-top: 2px; padding: 13px 0 10px 0;">
<p>
<button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#collapse_8e984083fde0" aria-expanded="false" aria-controls="collapseExample">
Solução
</button>
</p>
</div>
<div id="collapse_8e984083fde0" class="collapse">
A solução é 70. Para chegar no resultado anterior, deves executar o código abaixo. Para isso, abra um novo script no RStudio (Control+shift+N), copie e cole o código, e rode o script inteiro apertando Control+Shift+Enter ou por linha com Control+Enter.
<div class="card card-body">
<pre class="text"><code>my_link &lt;- 'https://www.gutenberg.org/ebooks/2264.txt.utf-8'

my_book &lt;- readr::read_lines(my_link)

# solution
full_text &lt;- paste0(my_book, collapse = '\n')
my_sol &lt;- stringr::str_count(full_text, stringr::fixed('King'))</code></pre>
</div>
</div>
<hr>
<p><span id="webex-total_correct"></span></p>
</div>
<div id="q.14" class="section level3 unnumbered">
<h3>Q.14<a class="anchor" aria-label="anchor" href="#q.14"><i class="fas fa-link"></i></a>
</h3>
<p>Para o objeto <code>full_text</code> criado anteriormente, utilize função <code><a href="https://stringr.tidyverse.org/reference/str_split.html">stringr::str_split</a></code> para <em>quebrar</em> o texto inteiro em função de espaços em branco. Com base nesse, crie uma tabela de frequência. Qual a palavra mais utilizada no texto? Dica: Remova todos os casos de caracteres vazios (<code>''</code>).</p>
<br> Resposta: <select class="webex-select"><option value="blank"></option>
<option value="">I</option>
<option value="answer">the</option>
<option value="">and</option>
<option value="">you</option>
<option value="">a</option></select><div style="text-align: left; margin-top: 2px; padding: 13px 0 10px 0;">
<p>
<button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#collapse_8e98448b1e42" aria-expanded="false" aria-controls="collapseExample">
Solução
</button>
</p>
</div>
<div id="collapse_8e98448b1e42" class="collapse">
A solução é the. Para chegar no resultado anterior, deves executar o código abaixo. Para isso, abra um novo script no RStudio (Control+shift+N), copie e cole o código, e rode o script inteiro apertando Control+Shift+Enter ou por linha com Control+Enter.
<div class="card card-body">
<pre class="text"><code>my_link &lt;- 'https://www.gutenberg.org/ebooks/2264.txt.utf-8'

my_book &lt;- readr::read_lines(my_link)

# solution
full_text &lt;- paste0(my_book, collapse = '\n')
my_split &lt;- stringr::str_split(full_text, 
                               pattern = stringr::fixed(' '))[[1]]

# remove empty
my_split &lt;- my_split[my_split != '']

my_tab &lt;- sort(table(my_split), decreasing = TRUE)

# solution
my_sol &lt;- names(my_tab[1])</code></pre>
</div>
</div>
<hr>
<p><span id="webex-total_correct"></span></p>
</div>
<div id="q.15" class="section level3 unnumbered">
<h3>Q.15<a class="anchor" aria-label="anchor" href="#q.15"><i class="fas fa-link"></i></a>
</h3>
<p>Assumindo que uma pessoa nascida em 2000-05-12 irás viver for 100 anos, qual é o número de dias de aniversário que cairão em um final de semana (sábado ou domingo)? Dica: use operador <code>%in%</code> para checar uma condição múltipla nos dados.</p>
<br><br> Resposta: <input class="webex-solveme nospaces" size="2" data-answer='["29"]'><div style="text-align: left; margin-top: 2px; padding: 13px 0 10px 0;">
<p>
<button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#collapse_8e98cd29baa" aria-expanded="false" aria-controls="collapseExample">
Solução
</button>
</p>
</div>
<div id="collapse_8e98cd29baa" class="collapse">
A solução é 29. Para chegar no resultado anterior, deves executar o código abaixo. Para isso, abra um novo script no RStudio (Control+shift+N), copie e cole o código, e rode o script inteiro apertando Control+Shift+Enter ou por linha com Control+Enter.
<div class="card card-body">
<pre class="text"><code>b_day &lt;- as.Date('2000-05-12')
n_years &lt;- 100

b_day_vec &lt;- seq(b_day, b_day + n_years*365, by = '1 year')

w_days &lt;- weekdays(b_day_vec)

n_weekend &lt;- sum(w_days %in% c('Saturday', 'Sunday'))

# solution
my_sol &lt;- n_weekend</code></pre>
</div>
</div>
<hr>
<p><span id="webex-total_correct"></span></p>
</div>
<div id="q.16" class="section level3 unnumbered">
<h3>Q.16<a class="anchor" aria-label="anchor" href="#q.16"><i class="fas fa-link"></i></a>
</h3>
<p>Qual data e horário é localizado 10^{4} <strong>segundos</strong> após 2021-02-02 11:50:02?</p>
<br> Resposta: <select class="webex-select"><option value="blank"></option>
<option value="">2021-02-02 12:21:46</option>
<option value="">2021-02-02 11:05:56</option>
<option value="">2021-02-02 14:02:14</option>
<option value="">2021-02-02 09:44:54</option>
<option value="answer">2021-02-02 14:36:42</option></select><div style="text-align: left; margin-top: 2px; padding: 13px 0 10px 0;">
<p>
<button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#collapse_8e9825e9a035" aria-expanded="false" aria-controls="collapseExample">
Solução
</button>
</p>
</div>
<div id="collapse_8e9825e9a035" class="collapse">
A solução é 2021-02-02 14:36:42. Para chegar no resultado anterior, deves executar o código abaixo. Para isso, abra um novo script no RStudio (Control+shift+N), copie e cole o código, e rode o script inteiro apertando Control+Shift+Enter ou por linha com Control+Enter.
<div class="card card-body">
<pre class="text"><code>time_1 &lt;- as.POSIXct('2021-02-02 11:50:02')
my_sec &lt;- 10000

my_sol &lt;- time_1 + my_sec</code></pre>
</div>
</div>

</div>
</div>
</div>
<div id="disqus_thread"></div>
<script>

/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
/*
var disqus_config = function () {
this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/
(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://padfer.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a>
</noscript>
  <div class="chapter-nav">
<div class="prev"><a href="classe-estrutura.html"><span class="header-section-number">6</span> Dataframes e outros Objetos</a></div>
<div class="next"><a href="programacao.html"><span class="header-section-number">8</span> Programando com o R</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#classes-basicas"><span class="header-section-number">7</span> As Classes Básicas de Objetos</a></li>
<li>
<a class="nav-link" href="#objetos-num%C3%A9ricos"><span class="header-section-number">7.1</span> Objetos Numéricos</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#criando-e-manipulando-vetores-num%C3%A9ricos"><span class="header-section-number">7.1.1</span> Criando e Manipulando Vetores Numéricos</a></li>
<li><a class="nav-link" href="#acessando-elementos-de-um-vetor-num%C3%A9rico"><span class="header-section-number">7.1.2</span> Acessando Elementos de um Vetor Numérico</a></li>
<li><a class="nav-link" href="#modificando-e-removendo-elementos-de-um-vetor-num%C3%A9rico"><span class="header-section-number">7.1.3</span> Modificando e Removendo Elementos de um Vetor Numérico</a></li>
<li><a class="nav-link" href="#criando-grupos"><span class="header-section-number">7.1.4</span> Criando Grupos</a></li>
<li><a class="nav-link" href="#outras-fun%C3%A7%C3%B5es-%C3%BAteis-3"><span class="header-section-number">7.1.5</span> Outras Funções Úteis</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#classe-de-caracteres-texto"><span class="header-section-number">7.2</span> Classe de Caracteres (texto)</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#criando-um-objeto-simples-de-caracteres"><span class="header-section-number">7.2.1</span> Criando um Objeto Simples de Caracteres</a></li>
<li><a class="nav-link" href="#criando-objetos-estruturados-de-texto"><span class="header-section-number">7.2.2</span> Criando Objetos Estruturados de Texto</a></li>
<li><a class="nav-link" href="#objetos-constantes-de-texto"><span class="header-section-number">7.2.3</span> Objetos Constantes de Texto</a></li>
<li><a class="nav-link" href="#selecionando-peda%C3%A7os-de-um-texto"><span class="header-section-number">7.2.4</span> Selecionando Pedaços de um Texto</a></li>
<li><a class="nav-link" href="#localizando-e-substituindo-peda%C3%A7os-de-um-texto"><span class="header-section-number">7.2.5</span> Localizando e Substituindo Pedaços de um Texto</a></li>
<li><a class="nav-link" href="#separando-textos"><span class="header-section-number">7.2.6</span> Separando Textos</a></li>
<li><a class="nav-link" href="#descobrindo-o-n%C3%BAmero-de-caracteres-de-um-texto"><span class="header-section-number">7.2.7</span> Descobrindo o Número de Caracteres de um Texto</a></li>
<li><a class="nav-link" href="#gerando-combina%C3%A7%C3%B5es-de-texto"><span class="header-section-number">7.2.8</span> Gerando Combinações de Texto</a></li>
<li><a class="nav-link" href="#codifica%C3%A7%C3%A3o-de-objetos-character"><span class="header-section-number">7.2.9</span> Codificação de Objetos character</a></li>
<li><a class="nav-link" href="#outras-fun%C3%A7%C3%B5es-%C3%BAteis-4"><span class="header-section-number">7.2.10</span> Outras Funções Úteis</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#fatores"><span class="header-section-number">7.3</span> Fatores</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#criando-fatores"><span class="header-section-number">7.3.1</span> Criando Fatores</a></li>
<li><a class="nav-link" href="#modificando-fatores"><span class="header-section-number">7.3.2</span> Modificando Fatores</a></li>
<li><a class="nav-link" href="#convertendo-fatores-para-outras-classes"><span class="header-section-number">7.3.3</span> Convertendo Fatores para Outras Classes</a></li>
<li><a class="nav-link" href="#criando-tabelas-de-conting%C3%AAncia"><span class="header-section-number">7.3.4</span> Criando Tabelas de Contingência</a></li>
<li><a class="nav-link" href="#outras-fun%C3%A7%C3%B5es"><span class="header-section-number">7.3.5</span> Outras Funções</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#valores-l%C3%B3gicos"><span class="header-section-number">7.4</span> Valores Lógicos</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#criando-valores-l%C3%B3gicos"><span class="header-section-number">7.4.1</span> Criando Valores Lógicos</a></li></ul>
</li>
<li>
<a class="nav-link" href="#datas-e-tempo"><span class="header-section-number">7.5</span> Datas e Tempo</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#criando-datas-simples"><span class="header-section-number">7.5.1</span> Criando Datas Simples</a></li>
<li><a class="nav-link" href="#criando-sequ%C3%AAncias-de-datas"><span class="header-section-number">7.5.2</span> Criando Sequências de Datas</a></li>
<li><a class="nav-link" href="#opera%C3%A7%C3%B5es-com-datas"><span class="header-section-number">7.5.3</span> Operações com Datas</a></li>
<li><a class="nav-link" href="#lidando-com-data-e-tempo"><span class="header-section-number">7.5.4</span> Lidando com Data e Tempo</a></li>
<li><a class="nav-link" href="#personalizando-o-formato-de-datas"><span class="header-section-number">7.5.5</span> Personalizando o Formato de Datas</a></li>
<li><a class="nav-link" href="#extraindo-elementos-de-uma-data"><span class="header-section-number">7.5.6</span> Extraindo Elementos de uma Data</a></li>
<li><a class="nav-link" href="#conhecendo-o-hor%C3%A1rio-e-a-data-atual"><span class="header-section-number">7.5.7</span> Conhecendo o Horário e a Data Atual</a></li>
<li><a class="nav-link" href="#outras-fun%C3%A7%C3%B5es-%C3%BAteis-5"><span class="header-section-number">7.5.8</span> Outras Funções Úteis</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#dados-omissos---na-not-available"><span class="header-section-number">7.6</span> Dados Omissos - NA (Not available)</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#definindo-valores-na"><span class="header-section-number">7.6.1</span> Definindo Valores NA</a></li>
<li><a class="nav-link" href="#encontrando-e-substituindo-valores-na"><span class="header-section-number">7.6.2</span> Encontrando e Substituindo Valores NA</a></li>
<li><a class="nav-link" href="#outras-fun%C3%A7%C3%B5es-%C3%BAteis-6"><span class="header-section-number">7.6.3</span> Outras Funções Úteis</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#exerc-classes-basicas"><span class="header-section-number">7.7</span> Exercícios</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#q.1-6">Q.1</a></li>
<li><a class="nav-link" href="#q.2-6">Q.2</a></li>
<li><a class="nav-link" href="#q.3-5">Q.3</a></li>
<li><a class="nav-link" href="#q.4-5">Q.4</a></li>
<li><a class="nav-link" href="#q.5-5">Q.5</a></li>
<li><a class="nav-link" href="#q.6-4">Q.6</a></li>
<li><a class="nav-link" href="#q.7-4">Q.7</a></li>
<li><a class="nav-link" href="#q.8-3">Q.8</a></li>
<li><a class="nav-link" href="#q.9-2">Q.9</a></li>
<li><a class="nav-link" href="#q.10-2">Q.10</a></li>
<li><a class="nav-link" href="#q.11-1">Q.11</a></li>
<li><a class="nav-link" href="#q.12">Q.12</a></li>
<li><a class="nav-link" href="#q.13">Q.13</a></li>
<li><a class="nav-link" href="#q.14">Q.14</a></li>
<li><a class="nav-link" href="#q.15">Q.15</a></li>
<li><a class="nav-link" href="#q.16">Q.16</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Análise de Dados Financeiros e Econômicos com o R - Versão Online</strong>" was written by Marcelo S. Perlin (<a href="mailto:marcelo.perlin@ufrgs.br" class="email">marcelo.perlin@ufrgs.br</a>). It was last built on 2022-08-10.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>

<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.340">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Introdução ao R - 9&nbsp; As Classes Básicas de Objetos</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./10-intro-programacao.html" rel="next">
<link href="./08-objetos-armazenamento.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<!-- Google tag (gtag.js) -->
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-FR8PLMG1G7"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-FR8PLMG1G7');
</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./09-objetos-basicos.html"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">As Classes Básicas de Objetos</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Introdução ao R</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Prefácio</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-introdução.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introdução</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-como-o-r-funciona.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Como o R Funciona?</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-rstudio.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Introdução ao RStudio</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-pacotes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Pacotes do R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-interagindo-computador-internet.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Interagindo com o Sistema Operacional e a Internet</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-importacao-exportacao-dados-locais.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Importação e Exportação de Dados Locais</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-importacao-internet.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Importação de Dados via Pacotes</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-objetos-armazenamento.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Dataframes e outros Objetos</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-objetos-basicos.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">As Classes Básicas de Objetos</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-intro-programacao.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Introdução a Programação com o R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./99-references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Referências Bibliográficas</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#objetos-numéricos" id="toc-objetos-numéricos" class="nav-link active" data-scroll-target="#objetos-numéricos"><span class="header-section-number">9.1</span> Objetos Numéricos</a>
  <ul class="collapse">
  <li><a href="#criando-e-manipulando-vetores-numéricos" id="toc-criando-e-manipulando-vetores-numéricos" class="nav-link" data-scroll-target="#criando-e-manipulando-vetores-numéricos"><span class="header-section-number">9.1.1</span> Criando e Manipulando Vetores Numéricos</a></li>
  <li><a href="#acessando-elementos-de-um-vetor-numérico" id="toc-acessando-elementos-de-um-vetor-numérico" class="nav-link" data-scroll-target="#acessando-elementos-de-um-vetor-numérico"><span class="header-section-number">9.1.2</span> Acessando Elementos de um Vetor Numérico</a></li>
  <li><a href="#modificando-e-removendo-elementos-de-um-vetor-numérico" id="toc-modificando-e-removendo-elementos-de-um-vetor-numérico" class="nav-link" data-scroll-target="#modificando-e-removendo-elementos-de-um-vetor-numérico"><span class="header-section-number">9.1.3</span> Modificando e Removendo Elementos de um Vetor Numérico</a></li>
  <li><a href="#criando-grupos" id="toc-criando-grupos" class="nav-link" data-scroll-target="#criando-grupos"><span class="header-section-number">9.1.4</span> Criando Grupos</a></li>
  <li><a href="#outras-funções-úteis" id="toc-outras-funções-úteis" class="nav-link" data-scroll-target="#outras-funções-úteis"><span class="header-section-number">9.1.5</span> Outras Funções Úteis</a></li>
  </ul></li>
  <li><a href="#classe-de-caracteres-texto" id="toc-classe-de-caracteres-texto" class="nav-link" data-scroll-target="#classe-de-caracteres-texto"><span class="header-section-number">9.2</span> Classe de Caracteres (texto)</a>
  <ul class="collapse">
  <li><a href="#criando-um-objeto-simples-de-caracteres" id="toc-criando-um-objeto-simples-de-caracteres" class="nav-link" data-scroll-target="#criando-um-objeto-simples-de-caracteres"><span class="header-section-number">9.2.1</span> Criando um Objeto Simples de Caracteres</a></li>
  <li><a href="#criando-objetos-estruturados-de-texto" id="toc-criando-objetos-estruturados-de-texto" class="nav-link" data-scroll-target="#criando-objetos-estruturados-de-texto"><span class="header-section-number">9.2.2</span> Criando Objetos Estruturados de Texto</a></li>
  <li><a href="#objetos-constantes-de-texto" id="toc-objetos-constantes-de-texto" class="nav-link" data-scroll-target="#objetos-constantes-de-texto"><span class="header-section-number">9.2.3</span> Objetos Constantes de Texto</a></li>
  <li><a href="#selecionando-pedaços-de-um-texto" id="toc-selecionando-pedaços-de-um-texto" class="nav-link" data-scroll-target="#selecionando-pedaços-de-um-texto"><span class="header-section-number">9.2.4</span> Selecionando Pedaços de um Texto</a></li>
  <li><a href="#localizando-e-substituindo-pedaços-de-um-texto" id="toc-localizando-e-substituindo-pedaços-de-um-texto" class="nav-link" data-scroll-target="#localizando-e-substituindo-pedaços-de-um-texto"><span class="header-section-number">9.2.5</span> Localizando e Substituindo Pedaços de um Texto</a></li>
  <li><a href="#separando-textos" id="toc-separando-textos" class="nav-link" data-scroll-target="#separando-textos"><span class="header-section-number">9.2.6</span> Separando Textos</a></li>
  <li><a href="#descobrindo-o-número-de-caracteres-de-um-texto" id="toc-descobrindo-o-número-de-caracteres-de-um-texto" class="nav-link" data-scroll-target="#descobrindo-o-número-de-caracteres-de-um-texto"><span class="header-section-number">9.2.7</span> Descobrindo o Número de Caracteres de um Texto</a></li>
  <li><a href="#gerando-combinações-de-texto" id="toc-gerando-combinações-de-texto" class="nav-link" data-scroll-target="#gerando-combinações-de-texto"><span class="header-section-number">9.2.8</span> Gerando Combinações de Texto</a></li>
  <li><a href="#codificação-de-objetos-character" id="toc-codificação-de-objetos-character" class="nav-link" data-scroll-target="#codificação-de-objetos-character"><span class="header-section-number">9.2.9</span> Codificação de Objetos <code>character</code></a></li>
  <li><a href="#outras-funções-úteis-1" id="toc-outras-funções-úteis-1" class="nav-link" data-scroll-target="#outras-funções-úteis-1"><span class="header-section-number">9.2.10</span> Outras Funções Úteis</a></li>
  </ul></li>
  <li><a href="#fatores" id="toc-fatores" class="nav-link" data-scroll-target="#fatores"><span class="header-section-number">9.3</span> Fatores</a>
  <ul class="collapse">
  <li><a href="#criando-fatores" id="toc-criando-fatores" class="nav-link" data-scroll-target="#criando-fatores"><span class="header-section-number">9.3.1</span> Criando Fatores</a></li>
  <li><a href="#modificando-fatores" id="toc-modificando-fatores" class="nav-link" data-scroll-target="#modificando-fatores"><span class="header-section-number">9.3.2</span> Modificando Fatores</a></li>
  <li><a href="#convertendo-fatores-para-outras-classes" id="toc-convertendo-fatores-para-outras-classes" class="nav-link" data-scroll-target="#convertendo-fatores-para-outras-classes"><span class="header-section-number">9.3.3</span> Convertendo Fatores para Outras Classes</a></li>
  <li><a href="#criando-tabelas-de-contingência" id="toc-criando-tabelas-de-contingência" class="nav-link" data-scroll-target="#criando-tabelas-de-contingência"><span class="header-section-number">9.3.4</span> Criando Tabelas de Contingência</a></li>
  <li><a href="#outras-funções" id="toc-outras-funções" class="nav-link" data-scroll-target="#outras-funções"><span class="header-section-number">9.3.5</span> Outras Funções</a></li>
  </ul></li>
  <li><a href="#valores-lógicos" id="toc-valores-lógicos" class="nav-link" data-scroll-target="#valores-lógicos"><span class="header-section-number">9.4</span> Valores Lógicos</a>
  <ul class="collapse">
  <li><a href="#criando-valores-lógicos" id="toc-criando-valores-lógicos" class="nav-link" data-scroll-target="#criando-valores-lógicos"><span class="header-section-number">9.4.1</span> Criando Valores Lógicos</a></li>
  </ul></li>
  <li><a href="#datas-e-tempo" id="toc-datas-e-tempo" class="nav-link" data-scroll-target="#datas-e-tempo"><span class="header-section-number">9.5</span> Datas e Tempo</a>
  <ul class="collapse">
  <li><a href="#criando-datas-simples" id="toc-criando-datas-simples" class="nav-link" data-scroll-target="#criando-datas-simples"><span class="header-section-number">9.5.1</span> Criando Datas Simples</a></li>
  <li><a href="#criando-sequências-de-datas" id="toc-criando-sequências-de-datas" class="nav-link" data-scroll-target="#criando-sequências-de-datas"><span class="header-section-number">9.5.2</span> Criando Sequências de Datas</a></li>
  <li><a href="#operações-com-datas" id="toc-operações-com-datas" class="nav-link" data-scroll-target="#operações-com-datas"><span class="header-section-number">9.5.3</span> Operações com Datas</a></li>
  <li><a href="#lidando-com-data-e-tempo" id="toc-lidando-com-data-e-tempo" class="nav-link" data-scroll-target="#lidando-com-data-e-tempo"><span class="header-section-number">9.5.4</span> Lidando com Data e Tempo</a></li>
  <li><a href="#personalizando-o-formato-de-datas" id="toc-personalizando-o-formato-de-datas" class="nav-link" data-scroll-target="#personalizando-o-formato-de-datas"><span class="header-section-number">9.5.5</span> Personalizando o Formato de Datas</a></li>
  <li><a href="#extraindo-elementos-de-uma-data" id="toc-extraindo-elementos-de-uma-data" class="nav-link" data-scroll-target="#extraindo-elementos-de-uma-data"><span class="header-section-number">9.5.6</span> Extraindo Elementos de uma Data</a></li>
  <li><a href="#conhecendo-o-horário-e-a-data-atual" id="toc-conhecendo-o-horário-e-a-data-atual" class="nav-link" data-scroll-target="#conhecendo-o-horário-e-a-data-atual"><span class="header-section-number">9.5.7</span> Conhecendo o Horário e a Data Atual</a></li>
  <li><a href="#outras-funções-úteis-2" id="toc-outras-funções-úteis-2" class="nav-link" data-scroll-target="#outras-funções-úteis-2"><span class="header-section-number">9.5.8</span> Outras Funções Úteis</a></li>
  </ul></li>
  <li><a href="#dados-omissos---na-not-available" id="toc-dados-omissos---na-not-available" class="nav-link" data-scroll-target="#dados-omissos---na-not-available"><span class="header-section-number">9.6</span> Dados Omissos - <code>NA</code> (<em>Not available</em>)</a>
  <ul class="collapse">
  <li><a href="#definindo-valores-na" id="toc-definindo-valores-na" class="nav-link" data-scroll-target="#definindo-valores-na"><span class="header-section-number">9.6.1</span> Definindo Valores <code>NA</code></a></li>
  <li><a href="#encontrando-e-substituindo-valores-na" id="toc-encontrando-e-substituindo-valores-na" class="nav-link" data-scroll-target="#encontrando-e-substituindo-valores-na"><span class="header-section-number">9.6.2</span> Encontrando e Substituindo Valores <code>NA</code></a></li>
  <li><a href="#outras-funções-úteis-3" id="toc-outras-funções-úteis-3" class="nav-link" data-scroll-target="#outras-funções-úteis-3"><span class="header-section-number">9.6.3</span> Outras Funções Úteis</a></li>
  </ul></li>
  <li><a href="#exerc-classes-basicas" id="toc-exerc-classes-basicas" class="nav-link" data-scroll-target="#exerc-classes-basicas"><span class="header-section-number">9.7</span> Exercícios</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-classes-basicas" class="quarto-section-identifier"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">As Classes Básicas de Objetos</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p><strong>As classes básicas são os elementos mais primários na representação de dados no R</strong>. Nos capítulos anteriores utilizamos as classes básicas como colunas em uma tabela. Dados numéricos viraram uma coluna do tipo <strong>numeric()</strong> , enquanto dados de texto viraram um objeto do tipo <code>character</code>.</p>
<p>Neste capítulo iremos estudar mais a fundo as classes básicas de objetos do R, incluindo a sua criação até a manipulação do seu conteúdo. Este capítulo é de suma importância pois mostrará quais operações são possíveis com cada classe de objeto e como podes manipular as informações de forma eficiente. Os tipos de objetos tratados aqui serão:</p>
<ul>
<li>Numéricos (<strong>numeric()</strong> )</li>
<li>Texto (<code>character</code>)</li>
<li>Fatores (<strong>factor()</strong> )</li>
<li>Valores lógicos (<code>logical</code>)</li>
<li>Datas e tempo (<code>Date</code> e <strong>{timeDate}</strong> <span class="citation" data-cites="R-timeDate">(<a href="99-references.html#ref-R-timeDate" role="doc-biblioref"><strong>R-timeDate?</strong></a>)</span>)</li>
<li>Dados Omissos (<code>NA</code>)</li>
</ul>
<section id="objetos-numéricos" class="level2" data-number="9.1">
<h2 data-number="9.1" class="anchored" data-anchor-id="objetos-numéricos"><span class="header-section-number">9.1</span> Objetos Numéricos</h2>
<p>Uma das classes mais utilizadas em pesquisa empírica. Os valores numéricos são representações de uma quantidade. Por exemplo: o preço de uma ação em determinada data, o volume negociado de um contrato financeiro em determinado dia, a inflação anual de um país, entre várias outras possibilidades.</p>
<section id="criando-e-manipulando-vetores-numéricos" class="level3" data-number="9.1.1">
<h3 data-number="9.1.1" class="anchored" data-anchor-id="criando-e-manipulando-vetores-numéricos"><span class="header-section-number">9.1.1</span> Criando e Manipulando Vetores Numéricos</h3>
<p>A criação e manipulação de valores numéricos é fácil e direta. Os símbolos de operações matemáticas seguem o esperado, tal como soma (<code>+</code>), diminuição (<code>-</code>), divisão (<code>/</code>) e multiplicação (<code>*</code>). Todas as operações matemáticas são efetuadas com a orientação de elemento para elemento e possuem notação vetorial. Isso significa, por exemplo, que podemos manipular vetores inteiros em uma única linha de comando. Veja a seguir, onde se cria dois vetores e realiza-se diversas operações entre eles.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create numeric vectors</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">6</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># print sum</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(x<span class="sc">+</span>y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1]  3  5  7  9 11</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># print multiplication</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(x<span class="sc">*</span>y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1]  2  6 12 20 30</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># print division</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(x<span class="sc">/</span>y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1] 0.5000000 0.6666667 0.7500000 0.8000000 0.8333333</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># print exponentiation</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(x<span class="sc">^</span>y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1]     1     8    81  1024 15625</code></pre>
</div>
</div>
<p>Um diferencial do R em relação a outras linguagens é que, nele, são aceitas operações entre vetores diferentes. Por exemplo, podemos somar um vetor numérico de quatro elementos com outro de apenas dois. Nesse caso, aplica-se a chamada <strong>regra de reciclagem</strong> (<em>recycling rule</em>). Ela define que, se dois vetores de tamanho diferente estão interagindo, o vetor menor é repetido tantas vezes quantas forem necessárias para obter-se o mesmo número de elementos do vetor maior. Veja o exemplo a seguir:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set x with 4 elements and y with 2</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">1</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co"># print sum</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(x <span class="sc">+</span> y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1] 3 3 5 5</code></pre>
</div>
</div>
<p>O resultado de <code>x + y</code> é equivalente a <code>1:4 + c(2, 1, 2, 1)</code>. Caso interagirmos vetores em que o tamanho do maior não é múltiplo do menor, o R realiza o mesmo procedimento de reciclagem, porém emite uma mensagem de <code>warning</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set x = 4 elements and y with 3</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co"># print sum (recycling rule)</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(x <span class="sc">+</span>y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>R&gt; Warning in x + y: longer object length is not a multiple of
R&gt; shorter object length</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1] 2 4 6 5</code></pre>
</div>
</div>
<p>Os três primeiros elementos de <code>x</code> foram somados aos três primeiros elementos de <code>y</code>. O quarto elemento de <code>x</code> foi somado ao primeiro elemento de <code>y</code>. Uma vez que não havia um quarto elemento em <code>y</code>, o ciclo reinicia, resgatando o primeiro elemento de <code>y</code> e resultando em uma soma igual a 5.</p>
<p>Os elementos de um vetor numérico também podem ser nomeados quando na criação do vetor:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create named vector</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">item1 =</span> <span class="dv">10</span>,</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">item2 =</span> <span class="dv">14</span>,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">item3 =</span> <span class="dv">9</span>,</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">item4 =</span> <span class="dv">2</span>)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="co"># print it</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; item1 item2 item3 item4 
R&gt;    10    14     9     2</code></pre>
</div>
</div>
<p>Para nomear os elementos após a criação, podemos utilizar a função <strong>names()</strong> . Veja a seguir:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create unnamed vector</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">14</span>, <span class="dv">9</span>, <span class="dv">2</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co"># set names of elements</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(x) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'item1'</span>, <span class="st">'item2'</span>, <span class="st">'item3'</span>, <span class="st">'item4'</span>)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="co"># print it</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; item1 item2 item3 item4 
R&gt;    10    14     9     2</code></pre>
</div>
</div>
<p>Vetores numéricos vazios também podem ser criados. Em algumas situações de desenvolvimento de código faz sentido pré-alocar o vetor antes de preenchê-lo com valores. Nesse caso, utilize a função <strong>numeric()</strong> :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create empty numeric vector of length 10</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>my_x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="at">length =</span> <span class="dv">10</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co"># print it</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt;  [1] 0 0 0 0 0 0 0 0 0 0</code></pre>
</div>
</div>
<p>Observe que, nesse caso, os valores de <code>my_x</code> são definidos como zero.</p>
<section id="criando-sequências-de-valores" class="level4" data-number="9.1.1.1">
<h4 data-number="9.1.1.1" class="anchored" data-anchor-id="criando-sequências-de-valores"><span class="header-section-number">9.1.1.1</span> Criando Sequências de Valores</h4>
<p>Existem duas maneiras de criar uma sequência de valores no R. A primeira, que já foi utilizada nos exemplos anteriores, é o uso do operador <code>:</code>. Por exemplo, <code>my_seq &lt;- 1:10</code> ou <code>my_seq &lt;- -5:5</code>. Esse método é bastante prático, pois a notação é clara e direta.</p>
<p>Porém, o uso do operador <code>:</code> limita as possibilidades. A diferença entre os valores adjacentes é sempre <em>1</em> para sequências ascendentes e <em>-1</em> para sequências descendentes. Uma versão mais poderosa para a criação de sequências é o uso da função <strong>seq()</strong> . Com ela, é possível definir os intervalos entre cada valor com o argumento <code>by</code>. Veja a seguir: </p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set sequence</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>my_seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">10</span>, <span class="at">to =</span> <span class="dv">10</span>, <span class="at">by =</span> <span class="dv">2</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="co"># print it</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_seq)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt;  [1] -10  -8  -6  -4  -2   0   2   4   6   8  10</code></pre>
</div>
</div>
<p>Outro atributo interessante da função <strong>seq()</strong> é a possibilidade de criar vetores com um valor inicial, um valor final e o número de elementos desejado. Isso é realizado com o uso da opção <code>length.out</code>. Observe o código a seguir, onde cria-se um vetor de <em>0</em> até <em>10</em> com <em>20</em> elementos:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set sequence with fixed size</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>my_seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">10</span>, <span class="at">length.out =</span> <span class="dv">20</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="co"># print it</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_seq)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt;  [1]  0.0000000  0.5263158  1.0526316  1.5789474  2.1052632
R&gt;  [6]  2.6315789  3.1578947  3.6842105  4.2105263  4.7368421
R&gt; [11]  5.2631579  5.7894737  6.3157895  6.8421053  7.3684211
R&gt; [16]  7.8947368  8.4210526  8.9473684  9.4736842 10.0000000</code></pre>
</div>
</div>
<p>No caso anterior, o tamanho final do vetor foi definido e a própria função se encarregou de descobrir qual a variação necessária entre cada valor de <code>my_seq</code>.</p>
</section>
<section id="criando-vetores-com-elementos-repetidos" class="level4" data-number="9.1.1.2">
<h4 data-number="9.1.1.2" class="anchored" data-anchor-id="criando-vetores-com-elementos-repetidos"><span class="header-section-number">9.1.1.2</span> Criando Vetores com Elementos Repetidos</h4>
<p>Outra função interessante é a que cria vetores com o uso de repetição. Por exemplo: imagine que estamos interessado em um vetor preenchido com o valor 1 dez vezes. Para isso, basta utilizar a função <strong>rep()</strong> : </p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># repeat vector three times</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>my_x <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="at">x =</span> <span class="dv">1</span>, <span class="at">times =</span> <span class="dv">10</span>)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="co"># print it</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt;  [1] 1 1 1 1 1 1 1 1 1 1</code></pre>
</div>
</div>
<p>A função também funciona com vetores. Considere uma situação onde temos um vetor com os valores <code>c(1,2)</code> e gostaríamos de criar um vetor maior com os elementos <code>c(1, 2, 1, 2, 1, 2)</code> - isto é, repetindo o vetor menor três vezes. Veja o resultado a seguir:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># repeat vector three times</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>my_x <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">times =</span> <span class="dv">3</span>)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="co"># print it</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1] 1 2 1 2 1 2</code></pre>
</div>
</div>
</section>
<section id="criando-vetores-com-números-aleatórios" class="level4" data-number="9.1.1.3">
<h4 data-number="9.1.1.3" class="anchored" data-anchor-id="criando-vetores-com-números-aleatórios"><span class="header-section-number">9.1.1.3</span> Criando Vetores com Números Aleatórios</h4>
<p>Em muitas situações será necessário a criação de números aleatórios. Esse procedimento numérico é bastante utilizado para simular modelos matemáticos em Finanças. Por exemplo, o método de simulação de preços de ativos de Monte Carlo parte da simulação de números aleatórios <span class="citation" data-cites="mcleish2011monte">(<a href="99-references.html#ref-mcleish2011monte" role="doc-biblioref"><strong>mcleish2011monte?</strong></a>)</span>. No R, existem diversas funções que criam números aleatórios para diferentes distribuições estatísticas. As mais utilizadas, porém, são as funções <strong>rnorm()</strong> e <strong>runif()</strong> . </p>
<p>A função <strong>rnorm()</strong> gera números aleatórios da distribuição Normal, com opções para a média (tendência) e o desvio padrão (variabilidade). Veja o seu uso a seguir:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># generate 10000 random numbers from a Normal distribution</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>my_rnd_vec <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">10000</span>,</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mean =</span> <span class="dv">0</span>,</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="co"># print first 20 elements</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_rnd_vec[<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt;  [1] -2.26366410 -0.55699445  1.38329681 -1.13970892
R&gt;  [5]  1.72186300 -0.73779108 -1.11632186  0.39170836
R&gt;  [9]  0.46777794  0.86666395 -1.15874728 -0.43591060
R&gt; [13]  0.89437223 -0.05233283  0.83999886  0.66663530
R&gt; [17] -1.23731647 -0.02421145 -0.16612844 -0.60344177</code></pre>
</div>
</div>
<p>O código anterior gera uma grande quantidade de números aleatórios de uma distribuição Normal com média zero e desvio padrão igual a um. Podemos verificar a distribuição dos números gerados com um histograma:</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="09-objetos-basicos_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Como esperado, temos o formato de sino que caracteriza uma distribuição do tipo Normal. Como exercício, podes trocar as entradas <strong>mean()</strong> e <strong>sd()</strong> e confirmar como isso afeta a figura gerada.</p>
<p>Já a função <strong>runif()</strong> gera valores aleatórios da distribuição uniforme entre um valor máximo e um valor mínimo. Ela é geralmente utilizada para simular probabilidades. A função <strong>runif()</strong> tem três parâmetros de entrada: o número de valores aleatórios desejado, o valor mínimo e o valor máximo. Veja exemplo a seguir:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create a random vector with minimum and maximum</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>my_rnd_vec <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="at">n =</span> <span class="dv">10</span>,</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">min =</span> <span class="sc">-</span><span class="dv">5</span>,</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">max =</span> <span class="dv">5</span>)</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="co"># print it</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_rnd_vec)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt;  [1]  3.3836844  0.3221582 -0.4130585  1.0049171  4.4777498
R&gt;  [6]  2.3969230 -4.7666913  1.5617563 -1.3845389 -4.8410415</code></pre>
</div>
</div>
<p>Observe que ambas as funções anteriores são limitadas à sua respectiva distribuição. Uma maneira alternativa e flexível de gerar valores aleatórios é utilizar a função <strong>sample()</strong> . Essa tem como entrada um vetor qualquer e retorna uma versão embaralhada de seus elementos. A sua flexibilidade reside no fato de que o vetor de entrada pode ser qualquer coisa. Por exemplo, caso quiséssemos criar um vetor aleatório com os números <code>c(0, 5, 15, 20, 25)</code> apenas, poderíamos fazê-lo da seguinte forma: </p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create sequence</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>my_vec <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">25</span>, <span class="at">by=</span><span class="dv">5</span>)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="co"># sample sequence</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>my_rnd_vec <span class="ot">&lt;-</span> <span class="fu">sample</span>(my_vec)</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="co"># print it</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_rnd_vec)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1]  5 10 25  0 15 20</code></pre>
</div>
</div>
<p>A função <strong>sample()</strong> também permite a seleção aleatória de um certo número de termos. Por exemplo, caso quiséssemos selecionar aleatoriamente apenas um elemento de <code>my_vec</code>, escreveríamos o código da seguinte maneira:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># sample one element of my_vec</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>my_rnd_vec <span class="ot">&lt;-</span> <span class="fu">sample</span>(my_vec, <span class="at">size =</span> <span class="dv">1</span>)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="co"># print it</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_rnd_vec)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1] 25</code></pre>
</div>
</div>
<p>Caso quiséssemos dois elementos, escreveríamos:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># sample two elements of my_vec</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>my_rnd_vec <span class="ot">&lt;-</span> <span class="fu">sample</span>(my_vec, <span class="at">size =</span> <span class="dv">2</span>)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="co"># print it</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_rnd_vec)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1]  5 10</code></pre>
</div>
</div>
<p>Também é possível selecionar valores de uma amostra menor para a criação de um vetor maior. Por exemplo, considere o caso em que se tem um vetor com os números <code>c(10, 15, 20)</code> e deseja-se criar um vetor aleatório com dez elementos retirados desse vetor menor, com repetição. Para isso, podemos utilizar a opção <code>replace = TRUE</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create vector</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>my_vec <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">15</span>)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="co"># sample</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>my_rnd_vec <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="at">x =</span> my_vec, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_rnd_vec)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt;  [1] 10  5 10 15 15 10 15  5  5  5</code></pre>
</div>
</div>
<p>Vale destacar que a função <strong>sample()</strong> funciona para qualquer tipo ou objeto, não sendo, portanto, exclusiva para vetores numéricos. Poderíamos, também, escolher elementos aleatórios de um vetor de texto ou então uma lista:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># example of sample with characters</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">'elem 1'</span>, <span class="st">'elem 2'</span>, <span class="st">'elem 3'</span>),</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1] "elem 1"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># example of sample with list</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">sample</span>(<span class="fu">list</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">y =</span> <span class="fu">c</span>(<span class="st">'a'</span>, <span class="st">'b'</span>)),</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; $x
R&gt; [1] 1 1 1</code></pre>
</div>
</div>
<p>É importante ressaltar que a geração de valores aleatórios no R (ou qualquer outro programa) <strong>não é totalmente aleatória!</strong> De fato, o próprio computador escolhe os valores dentre uma fila de valores possíveis. Cada vez que funções tal como <strong>rnorm()</strong> , <strong>runif()</strong> e <strong>sample()</strong> são utilizadas, o computador escolhe um lugar diferente dessa fila de acordo com vários parâmetros, incluindo a data e horário atual. Portanto, do ponto de vista do usuário, os valores são gerados de forma imprevisível. Para o computador, porém, essa seleção é completamente determinística e guiada por regras claras.</p>
<p>Uma propriedade interessante no R é a possibilidade de selecionar uma posição específica na fila de valores aleatórios utilizando função <strong>set.seed()</strong> . É ela que <strong>fixa a semente</strong> para gerar os valores. Na prática, o resultado é que todos os números e seleções aleatórias realizadas pelo código serão iguais em cada execução. O uso de <strong>set.seed()</strong> é bastante recomendado para manter a reprodutibilidade dos códigos envolvendo aleatoriedade. Veja o exemplo a seguir, onde utiliza-se essa função.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fix seed</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="at">seed =</span> <span class="dv">10</span>)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="co"># set vec and print</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>my_rnd_vec_1 <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">5</span>)</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_rnd_vec_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1] 0.50747820 0.30676851 0.42690767 0.69310208 0.08513597</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set vec and print</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>my_rnd_vec_2 <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">5</span>)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_rnd_vec_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1] 0.2254366 0.2745305 0.2723051 0.6158293 0.4296715</code></pre>
</div>
</div>
<p>No código anterior, o valor de <strong>set.seed()</strong> é um inteiro escolhido pelo usuário. Após a chamada de <strong>set.seed()</strong> , todas as seleções e números aleatórios irão iniciar do mesmo ponto e, portanto, serão iguais. Motivo o leitor a executar o código anterior no R. Verás que os valores de <code>my_rnd_vec_1</code> e <code>my_rnd_vec_2</code> serão exatamente iguais aos valores colocados aqui.</p>
<p>O uso de <strong>set.seed()</strong> também funciona para o caso de <strong>sample()</strong> . Veja a seguir:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fix seed</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="at">seed =</span> <span class="dv">15</span>)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="co"># print vectors</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt;  [1]  5  2  1  6  8 10  3  7  9  4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">sample</span>(<span class="dv">10</span><span class="sc">:</span><span class="dv">20</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt;  [1] 13 15 10 17 20 14 19 12 11 18 16</code></pre>
</div>
</div>
<p>Novamente, execute os comandos anteriores no R e verás que o resultado na tela bate com o apresentado aqui.</p>
</section>
</section>
<section id="acessando-elementos-de-um-vetor-numérico" class="level3" data-number="9.1.2">
<h3 data-number="9.1.2" class="anchored" data-anchor-id="acessando-elementos-de-um-vetor-numérico"><span class="header-section-number">9.1.2</span> Acessando Elementos de um Vetor Numérico</h3>
<p>Todos os elementos de um vetor numérico podem ser acessados através do uso de colchetes (<code>[ ]</code>). Por exemplo, caso quiséssemos apenas o primeiro elemento de <code>x</code>, teríamos:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set vector</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">4</span>, <span class="sc">-</span><span class="dv">9</span>, <span class="dv">2</span>)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="co"># get first element</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>first_elem_x <span class="ot">&lt;-</span> x[<span class="dv">1</span>]</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a><span class="co"># print it</span></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(first_elem_x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1] -1</code></pre>
</div>
</div>
<p>A mesma notação é válida para extrair porções de um vetor. Caso quiséssemos um subvetor de <code>x</code> com o primeiro e o segundo elemento, faríamos essa operação da seguinte forma:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># sub-vector of x</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>sub_x <span class="ot">&lt;-</span> x[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="co"># print it</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(sub_x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1] -1  4</code></pre>
</div>
</div>
<p>Para acessar elementos nomeados de um vetor numérico, basta utilizar seu nome junto aos colchetes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set named vector</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">item1 =</span> <span class="dv">10</span>, <span class="at">item2 =</span> <span class="dv">14</span>, <span class="at">item3 =</span> <span class="sc">-</span><span class="dv">9</span>, <span class="at">item4 =</span> <span class="sc">-</span><span class="dv">2</span>)</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="co"># access elements by name</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(x[<span class="st">'item2'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; item2 
R&gt;    14</code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(x[<span class="fu">c</span>(<span class="st">'item2'</span>,<span class="st">'item4'</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; item2 item4 
R&gt;    14    -2</code></pre>
</div>
</div>
<p>O acesso aos elementos de um vetor numérico também é possível através de testes lógicos. Por exemplo, caso tivéssemos interesse em saber quais os valores de <code>x</code> que são maiores do que <em>0</em>, o código resultante seria da seguinte forma:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># find all values of x higher than zero</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(x[x <span class="sc">&gt;</span> <span class="dv">0</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; item1 item2 
R&gt;    10    14</code></pre>
</div>
</div>
<p>Os usos de regras de segmentação dos dados de acordo com algum critério é chamado de indexação lógica. Os objetos do tipo <code>logical</code> serão tratados mais profundamente em seção futura deste capítulo.</p>
</section>
<section id="modificando-e-removendo-elementos-de-um-vetor-numérico" class="level3" data-number="9.1.3">
<h3 data-number="9.1.3" class="anchored" data-anchor-id="modificando-e-removendo-elementos-de-um-vetor-numérico"><span class="header-section-number">9.1.3</span> Modificando e Removendo Elementos de um Vetor Numérico</h3>
<p>A modificação de um vetor numérico é muito simples. Basta indicar a posição dos elementos e os novos valores com o símbolo de <em>assign</em> (<code>&lt;-</code>):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set vector</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>my_x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="co"># modify first element to 5</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>my_x[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a><span class="co"># print result</span></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1] 5 2 3 4</code></pre>
</div>
</div>
<p>Essa modificação também pode ser realizada em bloco:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set vector</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>my_x <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">5</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="co"># set the first three elements to 5</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>my_x[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a><span class="co"># print result</span></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1] 5 5 5 3 4 5</code></pre>
</div>
</div>
<p>O uso de condições para definir elementos é realizada pela indexação:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set vector</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>my_x <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">5</span><span class="sc">:</span><span class="dv">5</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="co"># set any value lower than 2 to 0</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>my_x[my_x<span class="sc">&lt;</span><span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a><span class="co"># print result</span></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt;  [1] 0 0 0 0 0 0 0 2 3 4 5</code></pre>
</div>
</div>
<p>A remoção de elementos é realizada com o uso de índices negativos:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create vector</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>my_x <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">5</span><span class="sc">:</span><span class="dv">5</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a><span class="co"># remove first and second element of my_x</span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>my_x <span class="ot">&lt;-</span> my_x[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)]</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a><span class="co"># show result</span></span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1] -3 -2 -1  0  1  2  3  4  5</code></pre>
</div>
</div>
<p>Note como o uso do índice negativo em <code>my_x[-(1:2)]</code> retorna o vetor original sem o primeiro e segundo elemento.</p>
</section>
<section id="criando-grupos" class="level3" data-number="9.1.4">
<h3 data-number="9.1.4" class="anchored" data-anchor-id="criando-grupos"><span class="header-section-number">9.1.4</span> Criando Grupos</h3>
<p>Em algumas situações será necessário entender quantos casos da amostra estão localizados entre um determinado intervalo. Por exemplo, imagine o vetor dos retornos diários de uma ação, isto é, a variação percentual dos preços de fechamento entre um dia e outro. Uma possível análise de risco que pode ser realizada é dividir o intervalo de retornos em cinco partes e verificar o percentual de ocorrência dos valores em cada um dos intervalos. Essa análise numérica é bastante semelhante à construção e visualização de histogramas.</p>
<p>A função <strong>cut()</strong> serve para criar grupos de intervalos a partir de um vetor numérico. Veja o exemplo a seguir, onde cria-se um vetor aleatório oriundo da distribuição Normal e cinco grupos a partir de intervalos definidos pelos dados.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set rnd vec</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>my_x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">10</span>)</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a><span class="co"># "cut" it into 5 pieces</span></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>my_cut <span class="ot">&lt;-</span> <span class="fu">cut</span>(<span class="at">x =</span> my_x, <span class="at">breaks =</span> <span class="dv">5</span>)</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_cut)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt;  [1] (-1.57,-1.12]  (0.252,0.71]   (-1.12,-0.66] 
R&gt;  [4] (-0.204,0.252] (-0.66,-0.204] (-1.57,-1.12] 
R&gt;  [7] (0.252,0.71]   (-0.204,0.252] (0.252,0.71]  
R&gt; [10] (-0.204,0.252]
R&gt; 5 Levels: (-1.57,-1.12] (-1.12,-0.66] ... (0.252,0.71]</code></pre>
</div>
</div>
<p>Observe que os nomes dos elementos da variável <code>my_cut</code> são definidos pelos intervalos e o resultado é um objeto do tipo fator. Em seções futuras, iremos explicar melhor esse tipo de objeto e as suas propriedades.</p>
<p>No exemplo anterior, os intervalos para cada grupo foram definidos automaticamente. No uso da função <strong>cut()</strong> , também é possível definir quebras customizadas nos dados e nos nomes dos grupos. Veja a seguir:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set random vector</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>my_x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">10</span>)</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a><span class="co"># create groups with 5 breaks</span></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>my_cut <span class="ot">&lt;-</span> <span class="fu">cut</span>(<span class="at">x =</span> my_x, <span class="at">breaks =</span> <span class="dv">5</span>)</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a><span class="co"># print it!</span></span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_cut)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt;  [1] (-1.3,-0.3]  (-0.3,0.697] (-0.3,0.697] (-2.3,-1.3] 
R&gt;  [5] (-0.3,0.697] (0.697,1.69] (0.697,1.69] (0.697,1.69]
R&gt;  [9] (-1.3,-0.3]  (1.69,2.7]  
R&gt; 5 Levels: (-2.3,-1.3] (-1.3,-0.3] ... (1.69,2.7]</code></pre>
</div>
</div>
<p>Note que os nomes dos elementos em <code>my_cut</code> foram definidos como intervalos e o resultado é um objeto do tipo fator. É possível também definir intervalos e nomes customizados para cada grupo com o uso dos argumentos <code>labels</code> e <code>breaks</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create random vector</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>my_x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">10</span>)</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a><span class="co"># define breaks manually</span></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>my_breaks <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">min</span>(my_x)<span class="sc">-</span><span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>, <span class="fu">max</span>(my_x)<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a><span class="co"># define labels manually</span></span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>my_labels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Low'</span>,<span class="st">'Normal'</span>, <span class="st">'High'</span>)</span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a><span class="co"># create group from numerical vector</span></span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a>my_cut <span class="ot">&lt;-</span> <span class="fu">cut</span>(<span class="at">x =</span> my_x, <span class="at">breaks =</span> my_breaks, <span class="at">labels =</span> my_labels)</span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a><span class="co"># print both!</span></span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt;  [1]  0.5981759  1.6113647 -0.4373813  1.3526206  0.4705685
R&gt;  [6]  0.4702481  0.3963088 -0.7304926  0.6531176  1.2279598</code></pre>
</div>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_cut)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt;  [1] Normal High   Normal High   Normal Normal Normal Normal
R&gt;  [9] Normal High  
R&gt; Levels: Low Normal High</code></pre>
</div>
</div>
<p>Como podemos ver, os nomes dos grupos estão mais amigáveis para uma futura análise.</p>
</section>
<section id="outras-funções-úteis" class="level3" data-number="9.1.5">
<h3 data-number="9.1.5" class="anchored" data-anchor-id="outras-funções-úteis"><span class="header-section-number">9.1.5</span> Outras Funções Úteis</h3>
<p><strong>as.numeric</strong> - Converte determinado objeto para numérico.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>my_text <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'1'</span>, <span class="st">'2'</span>, <span class="st">'3'</span>)</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(my_text)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1] "character"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>my_x <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(my_text)</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1] 1 2 3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(my_x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1] "numeric"</code></pre>
</div>
</div>
<p><strong>sum</strong> - Soma os elementos de um vetor.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>my_x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">50</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>my_sum <span class="ot">&lt;-</span> <span class="fu">sum</span>(my_x)</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_sum)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1] 1275</code></pre>
</div>
</div>
<p><strong>max</strong> - Retorna o máximo valor numérico do vetor.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">14</span>, <span class="dv">9</span>, <span class="dv">2</span>)</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>max_x <span class="ot">&lt;-</span> <span class="fu">max</span>(x)</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(max_x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1] 14</code></pre>
</div>
</div>
<p><strong>min</strong> - Retorna o mínimo valor numérico do vetor.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">12</span>, <span class="dv">15</span>, <span class="dv">9</span>, <span class="dv">2</span>)</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>min_x <span class="ot">&lt;-</span> <span class="fu">min</span>(x)</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(min_x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1] 2</code></pre>
</div>
</div>
<p><strong>which.max</strong> - Retorna a posição do máximo valor numérico do vetor.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">100</span>, <span class="dv">141</span>, <span class="dv">9</span>, <span class="dv">2</span>)</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>which.max_x <span class="ot">&lt;-</span> <span class="fu">which.max</span>(x)</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">'The position of the maximum value of x is '</span>, which.max_x))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; The position of the maximum value of x is  2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">' and its value is '</span>, x[which.max_x])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt;  and its value is  141</code></pre>
</div>
</div>
<p><strong>which.min</strong> - Retorna a posição do mínimo valor numérico do vetor.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">14</span>, <span class="dv">9</span>, <span class="dv">2</span>)</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>which.min_x <span class="ot">&lt;-</span> <span class="fu">which.min</span>(x)</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">'The position of the minimum value of x is '</span>,</span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>          which.min_x, <span class="st">' and its value is '</span>, x[which.min_x]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; The position of the minimum value of x is  4  and its value is  2</code></pre>
</div>
</div>
<p><strong>sort</strong> - Retorna uma versão ordenada de um vetor.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">5</span>)</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">sort</span>(x, <span class="at">decreasing =</span> <span class="cn">FALSE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1] 0.1623069 0.8347800 0.8553657 0.9099027 0.9935257</code></pre>
</div>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">sort</span>(x, <span class="at">decreasing =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1] 0.9935257 0.9099027 0.8553657 0.8347800 0.1623069</code></pre>
</div>
</div>
<p><strong>cumsum</strong> - Soma os elementos de um vetor de forma cumulativa.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>my_x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">25</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>my_cumsum <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(my_x)</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_cumsum)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt;  [1]   1   3   6  10  15  21  28  36  45  55  66  78  91 105
R&gt; [15] 120 136 153 171 190 210 231 253 276 300 325</code></pre>
</div>
</div>
<p><strong>prod</strong> - Realiza o produto de todos os elementos de um vetor.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>my_x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>my_prod <span class="ot">&lt;-</span> <span class="fu">prod</span>(my_x)</span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_prod)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1] 3628800</code></pre>
</div>
</div>
<p><strong>cumprod</strong> - Calcula o produto cumulativo de todos os elementos de um vetor.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>my_x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>my_prod <span class="ot">&lt;-</span> <span class="fu">cumprod</span>(my_x)</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_prod)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt;  [1]       1       2       6      24     120     720    5040
R&gt;  [8]   40320  362880 3628800</code></pre>
</div>
</div>
</section>
</section>
<section id="classe-de-caracteres-texto" class="level2" data-number="9.2">
<h2 data-number="9.2" class="anchored" data-anchor-id="classe-de-caracteres-texto"><span class="header-section-number">9.2</span> Classe de Caracteres (texto)</h2>
<p>A classe de caracteres, ou texto, serve para armazenar informações textuais. Um exemplo prático em Finanças seria o reconhecimento de uma ação através dos seus símbolos de identificação (<em>tickers</em>) ou então por sua classe de ação: ordinária ou preferencial. Este tipo de dado tem sido utilizado cada vez mais em pesquisa empírica <span class="citation" data-cites="gentzkow2017text">(<a href="99-references.html#ref-gentzkow2017text" role="doc-biblioref"><strong>gentzkow2017text?</strong></a>)</span>, resultando em uma diversidade de pacotes.</p>
<p>O R possui vários recursos que facilitam a criação e manipulação de objetos de tipo texto. As funções básicas fornecidas com a instalação de R são abrangentes e adequadas para a maioria dos casos. No entanto, pacote <strong>{stringr}</strong> <span class="citation" data-cites="R-stringr">(<a href="99-references.html#ref-R-stringr" role="doc-biblioref">Wickham 2023b</a>)</span> do <strong>{tidyverse}</strong> <span class="citation" data-cites="R-tidyverse">(<a href="99-references.html#ref-R-tidyverse" role="doc-biblioref">Wickham 2023c</a>)</span> fornece muitas funções que expandem a funcionalidade básica do R na manipulação de texto.</p>
<p>Um aspecto positivo de <strong>{stringr}</strong> <span class="citation" data-cites="R-stringr">(<a href="99-references.html#ref-R-stringr" role="doc-biblioref">Wickham 2023b</a>)</span> é que as funções começam com o nome <code>str_</code> e possuem nomes informativos. Combinando isso com o recurso de preenchimento automático (<em>autocomplete</em>) pela tecla <em>tab</em>, fica fácil de localizar os nomes das funções do pacote. Seguindo a prioridade ao universo do <strong>{tidyverse}</strong> <span class="citation" data-cites="R-tidyverse">(<a href="99-references.html#ref-R-tidyverse" role="doc-biblioref">Wickham 2023c</a>)</span>, esta seção irá dar preferência ao uso das funções do pacote <strong>{stringr}</strong> <span class="citation" data-cites="R-stringr">(<a href="99-references.html#ref-R-stringr" role="doc-biblioref">Wickham 2023b</a>)</span>. As rotinas nativas de manipulação de texto serão apresentadas, porém de forma limitada.</p>
<section id="criando-um-objeto-simples-de-caracteres" class="level3" data-number="9.2.1">
<h3 data-number="9.2.1" class="anchored" data-anchor-id="criando-um-objeto-simples-de-caracteres"><span class="header-section-number">9.2.1</span> Criando um Objeto Simples de Caracteres</h3>
<p>Todo objeto de caracteres é criado através da encapsulação de um texto por aspas duplas (<code>" "</code>) ou simples (<code>' '</code>). Para criar um vetor de caracteres com <em>tickers</em> de ações, podemos fazê-lo com o seguinte código:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>my_assets <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'PETR3'</span>, <span class="st">'VALE4'</span>, <span class="st">'GGBR4'</span>)</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_assets)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1] "PETR3" "VALE4" "GGBR4"</code></pre>
</div>
</div>
<p>Confirma-se a classe do objeto com a função <strong>class()</strong> :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(my_assets)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1] "character"</code></pre>
</div>
</div>
</section>
<section id="criando-objetos-estruturados-de-texto" class="level3" data-number="9.2.2">
<h3 data-number="9.2.2" class="anchored" data-anchor-id="criando-objetos-estruturados-de-texto"><span class="header-section-number">9.2.2</span> Criando Objetos Estruturados de Texto</h3>
<p>Em muitos casos no uso do R, estaremos interessados em criar vetores de texto com algum tipo de estrutura própria. Por exemplo, o vetor <code>c("text 1", "text 2", ..., "text 20")</code> possui um lógica de criação clara. Computacionalmente, podemos definir a sua estrutura como sendo a junção do texto <code>text</code> e um vetor de sequência, de 1 até 20.</p>
<p>Para criar um vetor textual capaz de unir texto com número, utilizamos a função <strong>stringr</strong>::<strong>str_c()</strong> ou <strong>paste()</strong> . Veja o exemplo a seguir, onde replica-se o caso anterior com e sem espaço entre número e texto:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a><span class="co"># create sequence</span></span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>my_seq <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span></span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a><span class="co"># create character</span></span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a>my_text <span class="ot">&lt;-</span> <span class="st">'text'</span></span>
<span id="cb110-8"><a href="#cb110-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-9"><a href="#cb110-9" aria-hidden="true" tabindex="-1"></a><span class="co"># paste objects together (without space)</span></span>
<span id="cb110-10"><a href="#cb110-10" aria-hidden="true" tabindex="-1"></a>my_char <span class="ot">&lt;-</span> <span class="fu">str_c</span>(my_text, my_seq)</span>
<span id="cb110-11"><a href="#cb110-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_char)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt;  [1] "text1"  "text2"  "text3"  "text4"  "text5"  "text6" 
R&gt;  [7] "text7"  "text8"  "text9"  "text10" "text11" "text12"
R&gt; [13] "text13" "text14" "text15" "text16" "text17" "text18"
R&gt; [19] "text19" "text20"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="co"># paste objects together (with space)</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>my_char <span class="ot">&lt;-</span> <span class="fu">str_c</span>(my_text, my_seq, <span class="at">sep =</span> <span class="st">' '</span>)</span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_char)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt;  [1] "text 1"  "text 2"  "text 3"  "text 4"  "text 5" 
R&gt;  [6] "text 6"  "text 7"  "text 8"  "text 9"  "text 10"
R&gt; [11] "text 11" "text 12" "text 13" "text 14" "text 15"
R&gt; [16] "text 16" "text 17" "text 18" "text 19" "text 20"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co"># paste objects together (with space)</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>my_char <span class="ot">&lt;-</span> <span class="fu">paste</span>(my_text, my_seq)</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_char)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt;  [1] "text 1"  "text 2"  "text 3"  "text 4"  "text 5" 
R&gt;  [6] "text 6"  "text 7"  "text 8"  "text 9"  "text 10"
R&gt; [11] "text 11" "text 12" "text 13" "text 14" "text 15"
R&gt; [16] "text 16" "text 17" "text 18" "text 19" "text 20"</code></pre>
</div>
</div>
<p>O mesmo procedimento também pode ser realizado com vetores de texto. Veja a seguir:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set character value</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>my_x <span class="ot">&lt;-</span> <span class="st">'My name is'</span></span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a><span class="co"># set character vector</span></span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a>my_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Marcelo'</span>, <span class="st">'Ricardo'</span>, <span class="st">'Tarcizio'</span>)</span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true" tabindex="-1"></a><span class="co"># paste and print</span></span>
<span id="cb116-8"><a href="#cb116-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">str_c</span>(my_x, my_names, <span class="at">sep =</span> <span class="st">' '</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1] "My name is Marcelo"  "My name is Ricardo" 
R&gt; [3] "My name is Tarcizio"</code></pre>
</div>
</div>
<p>Outra possibilidade de construção de textos estruturados é a repetição do conteúdo de um objeto do tipo caractere. No caso de texto, utiliza-se a função <strong>stringr</strong>::<strong>str_dup()</strong> /<strong>strrep()</strong> para esse fim. Observe o exemplo a seguir:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>my_char <span class="ot">&lt;-</span> <span class="fu">str_dup</span>(<span class="at">string =</span> <span class="st">'abc'</span>, <span class="at">times =</span> <span class="dv">5</span>)</span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_char)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1] "abcabcabcabcabc"</code></pre>
</div>
</div>
</section>
<section id="objetos-constantes-de-texto" class="level3" data-number="9.2.3">
<h3 data-number="9.2.3" class="anchored" data-anchor-id="objetos-constantes-de-texto"><span class="header-section-number">9.2.3</span> Objetos Constantes de Texto</h3>
<p>O R também possibilita o acesso direto a todas as letras do alfabeto. Esses estão guardadas nos objetos reservados chamados <code>letters</code> e <code>LETTERS</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="co"># print all letters in alphabet (no cap)</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(letters)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt;  [1] "a" "b" "c" "d" "e" "f" "g" "h" "i" "j" "k" "l" "m" "n"
R&gt; [15] "o" "p" "q" "r" "s" "t" "u" "v" "w" "x" "y" "z"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="co"># print all letters in alphabet (WITH CAP)</span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(LETTERS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt;  [1] "A" "B" "C" "D" "E" "F" "G" "H" "I" "J" "K" "L" "M" "N"
R&gt; [15] "O" "P" "Q" "R" "S" "T" "U" "V" "W" "X" "Y" "Z"</code></pre>
</div>
</div>
<p>Observe que em ambos os casos não é necessário criar os objetos. Por serem constantes embutidas automaticamente na área de trabalho do R, elas já estão disponíveis para uso. Podemos sobrescrever o nome do objeto com outro conteúdo, porém isso não é aconselhável. Nunca se sabe onde esse objeto constante está sendo usado. Outros objetos de texto constantes no R incluem <code>month.abb</code> e <code>month.name</code>. Veja a seguir o seu conteúdo:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="co"># print abreviation and full names of months</span></span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(month.abb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt;  [1] "Jan" "Feb" "Mar" "Apr" "May" "Jun" "Jul" "Aug" "Sep"
R&gt; [10] "Oct" "Nov" "Dec"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(month.name)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt;  [1] "January"   "February"  "March"     "April"    
R&gt;  [5] "May"       "June"      "July"      "August"   
R&gt;  [9] "September" "October"   "November"  "December"</code></pre>
</div>
</div>
</section>
<section id="selecionando-pedaços-de-um-texto" class="level3" data-number="9.2.4">
<h3 data-number="9.2.4" class="anchored" data-anchor-id="selecionando-pedaços-de-um-texto"><span class="header-section-number">9.2.4</span> Selecionando Pedaços de um Texto</h3>
<p>Um erro comum praticado por iniciantes é tentar selecionar pedaços de um texto através do uso de colchetes. Observe o código abaixo:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set char object</span></span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>my_char <span class="ot">&lt;-</span> <span class="st">'ABCDE'</span></span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a><span class="co"># print its second character: 'B' (WRONG - RESULT is NA)</span></span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_char[<span class="dv">2</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1] NA</code></pre>
</div>
</div>
<p>O resultado <code>NA</code> indica que o segundo elemento de <code>my_char</code> não existe. Isso acontece porque o uso de colchetes refere-se ao acesso de <strong>elementos</strong> de um vetor atômico, e não de caracteres dentro de um texto maior. Observe o que acontece quando utilizamos <code>my_char[1]</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_char[<span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1] "ABCDE"</code></pre>
</div>
</div>
<p>O resultado é simplesmente o texto <em>ABCDE</em>, que está localizado no primeiro item de <code>my_char</code>. Para selecionar pedaços de um texto, devemos utilizar a função específica <strong>stringr</strong>::<strong>str_sub()</strong> /<strong>substr()</strong> :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="co"># print third and fourth characters</span></span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>my_substr <span class="ot">&lt;-</span> <span class="fu">str_sub</span>(<span class="at">string =</span> my_char,</span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">start =</span> <span class="dv">4</span>,</span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">end =</span> <span class="dv">4</span>)</span>
<span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_substr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1] "D"</code></pre>
</div>
</div>
<p>Essa função também funciona para vetores atômicos. Vamos assumir que você importou dados de texto e o conjunto de dados bruto contém um identificador de 3 dígitos de uma empresa, sempre na mesma posição do texto. Vamos simular a situação no R:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="co"># build char vec</span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>my_char_vec <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="fu">c</span>(<span class="st">'123'</span>,<span class="st">'231'</span>,<span class="st">'321'</span>),</span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a>                      <span class="st">' - other ignorable text'</span>)</span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_char_vec)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1] "123 - other ignorable text"
R&gt; [2] "231 - other ignorable text"
R&gt; [3] "321 - other ignorable text"</code></pre>
</div>
</div>
<p>Só estamos interessados na informação das três primeiras letras de cada elemento em <code>my_char_vec</code>. Para selecioná-los, podemos usar as mesmas funções que antes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get ids with stringr::str_sub</span></span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a>ids.vec <span class="ot">&lt;-</span> <span class="fu">str_sub</span>(my_char_vec, <span class="dv">1</span>, <span class="dv">3</span>)</span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(ids.vec)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1] "123" "231" "321"</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Importante
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Operações vetorizadas são comuns e esperadas no R</strong>. Quase tudo o que você pode fazer para um único elemento pode ser expandido para vetores. Isso facilita o desenvolvimento de rotinas pois pode-se facilmente realizar tarefas complicadas em uma série de elementos, em uma única linha de código.</p>
</div>
</div>
</section>
<section id="localizando-e-substituindo-pedaços-de-um-texto" class="level3" data-number="9.2.5">
<h3 data-number="9.2.5" class="anchored" data-anchor-id="localizando-e-substituindo-pedaços-de-um-texto"><span class="header-section-number">9.2.5</span> Localizando e Substituindo Pedaços de um Texto</h3>
<p>Uma operação útil na manipulação de textos é a localização de letras e padrões específicos com funções <strong>stringr</strong>::<strong>str_locate()</strong> /<strong>regexpr()</strong> e <strong>stringr</strong>::<strong>str_locate_all()</strong> /<strong>gregexpr()</strong> . É importante destacar que, por <em>default</em>, essas funções utilizam de expressões do tipo <em>regex</em> - expressões regulares <span class="citation" data-cites="thompson1968programming">(<a href="99-references.html#ref-thompson1968programming" role="doc-biblioref"><strong>thompson1968programming?</strong></a>)</span>. Essa é uma linguagem específica para processar textos. Diversos símbolos são utilizados para estruturar, procurar e isolar padrões textuais. Quando utilizada corretamente, o <em>regex</em> é bastante útil e de extrema valia.</p>
<p>Usualmente, o caso mais comum em pesquisa é verificar a posição ou a existência de um texto menor dentro de um texto maior. Isto é, um padrão explícito e fácil de entender. Por isso, a localização e substituição de caracteres no próximo exemplo será do tipo fixo, sem o uso de <em>regex</em>. Tal informação pode ser passada às funções do pacote <strong>{stringr}</strong> <span class="citation" data-cites="R-stringr">(<a href="99-references.html#ref-R-stringr" role="doc-biblioref">Wickham 2023b</a>)</span> através de outra função chamada <strong>stringr</strong>::<strong>fixed()</strong> .</p>
<p>O exemplo a seguir mostra como encontrar o caractere <em>D</em> dentre uma série de caracteres.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a>my_char <span class="ot">&lt;-</span> <span class="st">'ABCDEF-ABCDEF-ABC'</span></span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a>pos <span class="ot">=</span> <span class="fu">str_locate</span>(<span class="at">string =</span> my_char, <span class="at">pattern =</span> <span class="fu">fixed</span>(<span class="st">'D'</span>) )</span>
<span id="cb138-5"><a href="#cb138-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pos)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt;      start end
R&gt; [1,]     4   4</code></pre>
</div>
</div>
<p>Observe que a função <strong>stringr</strong>::<strong>str_locate()</strong> retorna apenas a primeira ocorrência de <em>D</em>. Para resgatar todas as ocorrências, devemos utilizar a função <strong>stringr</strong>::<strong>str_locate_all()</strong> :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set object</span></span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>my_char <span class="ot">&lt;-</span> <span class="st">'ABCDEF-ABCDEF-ABC'</span></span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a><span class="co"># find position of ALL 'D' using str_locate_all</span></span>
<span id="cb140-5"><a href="#cb140-5" aria-hidden="true" tabindex="-1"></a>pos <span class="ot">=</span> <span class="fu">str_locate_all</span>(<span class="at">string =</span> my_char, <span class="at">pattern =</span> <span class="fu">fixed</span>(<span class="st">'D'</span>))</span>
<span id="cb140-6"><a href="#cb140-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pos)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [[1]]
R&gt;      start end
R&gt; [1,]     4   4
R&gt; [2,]    11  11</code></pre>
</div>
</div>
<p>Para substituir caracteres em um texto, basta utilizar a função <strong>stringr</strong>::<strong>str_replace()</strong> ou <strong>sub()</strong> e <strong>stringr</strong>::<strong>str_locate_all()</strong> ou <strong>gsub()</strong> . Vale salientar que <code>str_replace</code> substitui a primeira ocorrência do caractere, enquanto <strong>stringr</strong>::<strong>str_locate_all()</strong> executa uma substituição global - isto é, aplica-se a todas as ocorrências. Veja a diferença a seguir:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set char object</span></span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>my_char <span class="ot">&lt;-</span> <span class="st">'ABCDEF-ABCDEF-ABC'</span></span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a><span class="co"># substitute the FIRST 'ABC' for 'XXX' with sub</span></span>
<span id="cb142-5"><a href="#cb142-5" aria-hidden="true" tabindex="-1"></a>my_char <span class="ot">&lt;-</span> <span class="fu">sub</span>(<span class="at">x =</span> my_char,</span>
<span id="cb142-6"><a href="#cb142-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">pattern =</span> <span class="st">'ABC'</span>,</span>
<span id="cb142-7"><a href="#cb142-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">replacement =</span> <span class="st">'XXX'</span>)</span>
<span id="cb142-8"><a href="#cb142-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_char)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1] "XXXDEF-ABCDEF-ABC"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="co"># substitute the FIRST 'ABC' for 'XXX' with str_replace</span></span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>my_char <span class="ot">&lt;-</span> <span class="st">'ABCDEF-ABCDEF-ABC'</span></span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a>my_char <span class="ot">&lt;-</span> <span class="fu">str_replace</span>(<span class="at">string =</span> my_char,</span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">pattern =</span> <span class="fu">fixed</span>(<span class="st">'ABC'</span>),</span>
<span id="cb144-5"><a href="#cb144-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">replacement =</span> <span class="st">'XXX'</span>)</span>
<span id="cb144-6"><a href="#cb144-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_char)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1] "XXXDEF-ABCDEF-ABC"</code></pre>
</div>
</div>
<p>E agora fazemos uma substituição global dos caracteres.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set char object</span></span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a>my_char <span class="ot">&lt;-</span> <span class="st">'ABCDEF-ABCDEF-ABC'</span></span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a><span class="co"># substitute the FIRST 'ABC' for 'XXX' with str_replace</span></span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true" tabindex="-1"></a>my_char <span class="ot">&lt;-</span> <span class="fu">str_replace_all</span>(<span class="at">string =</span> my_char,</span>
<span id="cb146-6"><a href="#cb146-6" aria-hidden="true" tabindex="-1"></a>                           <span class="at">pattern =</span> <span class="st">'ABC'</span>,</span>
<span id="cb146-7"><a href="#cb146-7" aria-hidden="true" tabindex="-1"></a>                           <span class="at">replacement =</span> <span class="st">'XXX'</span>)</span>
<span id="cb146-8"><a href="#cb146-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_char)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1] "XXXDEF-XXXDEF-XXX"</code></pre>
</div>
</div>
<p>Mais uma vez, vale ressaltar que as operações de substituição também funcionam em vetores. Dê uma olhada no próximo exemplo.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set char object</span></span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a>my_char <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'ABCDEF'</span>,<span class="st">'DBCFE'</span>,<span class="st">'ABC'</span>)</span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-4"><a href="#cb148-4" aria-hidden="true" tabindex="-1"></a><span class="co"># create an example of vector</span></span>
<span id="cb148-5"><a href="#cb148-5" aria-hidden="true" tabindex="-1"></a>my_char_vec <span class="ot">&lt;-</span> <span class="fu">str_c</span>(<span class="fu">sample</span>(my_char, <span class="dv">5</span>, <span class="at">replace =</span> T),</span>
<span id="cb148-6"><a href="#cb148-6" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">sample</span>(my_char, <span class="dv">5</span>, <span class="at">replace =</span> T),</span>
<span id="cb148-7"><a href="#cb148-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">sep =</span> <span class="st">' - '</span>)</span>
<span id="cb148-8"><a href="#cb148-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-9"><a href="#cb148-9" aria-hidden="true" tabindex="-1"></a><span class="co"># show it</span></span>
<span id="cb148-10"><a href="#cb148-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_char_vec)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1] "ABCDEF - ABC"    "ABCDEF - ABCDEF" "ABCDEF - ABC"   
R&gt; [4] "ABCDEF - DBCFE"  "DBCFE - ABCDEF"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="co"># substitute all occurrences of 'ABC'</span></span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a>my_char_vec <span class="ot">&lt;-</span> <span class="fu">str_replace_all</span>(<span class="at">string =</span> my_char_vec,</span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a>                               <span class="at">pattern =</span> <span class="st">'ABC'</span>,</span>
<span id="cb150-4"><a href="#cb150-4" aria-hidden="true" tabindex="-1"></a>                               <span class="at">replacement =</span> <span class="st">'XXX'</span>)</span>
<span id="cb150-5"><a href="#cb150-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-6"><a href="#cb150-6" aria-hidden="true" tabindex="-1"></a><span class="co"># print result</span></span>
<span id="cb150-7"><a href="#cb150-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_char_vec)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1] "XXXDEF - XXX"    "XXXDEF - XXXDEF" "XXXDEF - XXX"   
R&gt; [4] "XXXDEF - DBCFE"  "DBCFE - XXXDEF"</code></pre>
</div>
</div>
</section>
<section id="separando-textos" class="level3" data-number="9.2.6">
<h3 data-number="9.2.6" class="anchored" data-anchor-id="separando-textos"><span class="header-section-number">9.2.6</span> Separando Textos</h3>
<p>Em algumas situações, principalmente no processamento de textos, é possível que se esteja interessado em quebrar um texto de acordo com algum separador. Por exemplo, o texto <code>abc ; bcd ; adf</code> apresenta informações demarcadas pelo símbolo <code>;</code>. Para separar um texto em várias partes, utilizamos a função <strong>stringr</strong>::<strong>str_split()</strong> /<strong>strsplit()</strong> . Essas quebram o texto em diversas partes de acordo com algum caractere escolhido. Observe os exemplos a seguir:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set char</span></span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a>my_char <span class="ot">&lt;-</span> <span class="st">'ABCXABCXBCD'</span></span>
<span id="cb152-3"><a href="#cb152-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-4"><a href="#cb152-4" aria-hidden="true" tabindex="-1"></a><span class="co"># split it based on 'X' and using stringr::str_split</span></span>
<span id="cb152-5"><a href="#cb152-5" aria-hidden="true" tabindex="-1"></a>split_char <span class="ot">&lt;-</span> <span class="fu">str_split</span>(my_char, <span class="st">'X'</span>)</span>
<span id="cb152-6"><a href="#cb152-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-7"><a href="#cb152-7" aria-hidden="true" tabindex="-1"></a><span class="co"># print result</span></span>
<span id="cb152-8"><a href="#cb152-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(split_char)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [[1]]
R&gt; [1] "ABC" "ABC" "BCD"</code></pre>
</div>
</div>
<p>A saída dessa função é um objeto do tipo lista. Para acessar os elementos de uma lista, deve-se utilizar o operador <code>[[ ]]</code>. Por exemplo, para acessar o texto <code>bcd</code> da lista <code>split_char</code>, executa-se o seguinte código:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(split_char[[<span class="dv">1</span>]][<span class="dv">2</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1] "ABC"</code></pre>
</div>
</div>
<p>Para visualizar um exemplo de dividir textos em vetores, veja o próximo código.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set char</span></span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a>my_char_vec <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'ABCDEF'</span>,<span class="st">'DBCFE'</span>,<span class="st">'ABFC'</span>,<span class="st">'ACD'</span>)</span>
<span id="cb156-3"><a href="#cb156-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-4"><a href="#cb156-4" aria-hidden="true" tabindex="-1"></a><span class="co"># split it based on 'B' and using stringr::strsplit</span></span>
<span id="cb156-5"><a href="#cb156-5" aria-hidden="true" tabindex="-1"></a>split_char <span class="ot">&lt;-</span> <span class="fu">str_split</span>(my_char_vec, <span class="st">'B'</span>)</span>
<span id="cb156-6"><a href="#cb156-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-7"><a href="#cb156-7" aria-hidden="true" tabindex="-1"></a><span class="co"># print result</span></span>
<span id="cb156-8"><a href="#cb156-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(split_char)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [[1]]
R&gt; [1] "A"    "CDEF"
R&gt; 
R&gt; [[2]]
R&gt; [1] "D"   "CFE"
R&gt; 
R&gt; [[3]]
R&gt; [1] "A"  "FC"
R&gt; 
R&gt; [[4]]
R&gt; [1] "ACD"</code></pre>
</div>
</div>
<p>Observe como, novamente, um objeto do tipo <code>list</code> é retornado. Cada elemento é correspondente ao processo de quebra de texto em <code>my_char</code>.</p>
</section>
<section id="descobrindo-o-número-de-caracteres-de-um-texto" class="level3" data-number="9.2.7">
<h3 data-number="9.2.7" class="anchored" data-anchor-id="descobrindo-o-número-de-caracteres-de-um-texto"><span class="header-section-number">9.2.7</span> Descobrindo o Número de Caracteres de um Texto</h3>
<p>Para descobrir o número de caracteres de um texto, utilizamos a função <strong>stringr</strong>::<strong>str_length()</strong> /<strong>nchar()</strong> . Ela também funciona para vetores atômicos de texto. Veja os exemplos mostrados a seguir:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set char</span></span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a>my_char <span class="ot">&lt;-</span> <span class="st">'abcdef'</span></span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-4"><a href="#cb158-4" aria-hidden="true" tabindex="-1"></a><span class="co"># print number of characters using stringr::str_length</span></span>
<span id="cb158-5"><a href="#cb158-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">str_length</span>(my_char))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1] 6</code></pre>
</div>
</div>
<p>E agora um exemplo com vetores.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="co">#set char</span></span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a>my_char <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'a'</span>, <span class="st">'ab'</span>, <span class="st">'abc'</span>)</span>
<span id="cb160-3"><a href="#cb160-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-4"><a href="#cb160-4" aria-hidden="true" tabindex="-1"></a><span class="co"># print number of characters using stringr::str_length</span></span>
<span id="cb160-5"><a href="#cb160-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">str_length</span>(my_char))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1] 1 2 3</code></pre>
</div>
</div>
</section>
<section id="gerando-combinações-de-texto" class="level3" data-number="9.2.8">
<h3 data-number="9.2.8" class="anchored" data-anchor-id="gerando-combinações-de-texto"><span class="header-section-number">9.2.8</span> Gerando Combinações de Texto</h3>
<p>Um truque útil no R é usar as funções <strong>expand.grid()</strong> e <strong>tidyr</strong>::<strong>expand_grid()</strong> para criar todas as combinações possíveis de elementos em diferentes objetos. Isso é útil quando você quer criar um vetor de texto combinando todos os elementos possíveis de diferentes vetores. Por exemplo, se quisermos criar um vetor com todas as combinações entre dois vetores de texto, podemos escrever:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-3"><a href="#cb162-3" aria-hidden="true" tabindex="-1"></a><span class="co"># set vectors</span></span>
<span id="cb162-4"><a href="#cb162-4" aria-hidden="true" tabindex="-1"></a>my_vec_1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'John '</span>, <span class="st">'Claire '</span>, <span class="st">'Adam '</span>)</span>
<span id="cb162-5"><a href="#cb162-5" aria-hidden="true" tabindex="-1"></a>my_vec_2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'is fishing.'</span>, <span class="st">'is working.'</span>)</span>
<span id="cb162-6"><a href="#cb162-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-7"><a href="#cb162-7" aria-hidden="true" tabindex="-1"></a><span class="co"># create df with all combinations</span></span>
<span id="cb162-8"><a href="#cb162-8" aria-hidden="true" tabindex="-1"></a>my_df <span class="ot">&lt;-</span> tidyr<span class="sc">::</span><span class="fu">expand_grid</span>(<span class="at">name =</span> my_vec_1,</span>
<span id="cb162-9"><a href="#cb162-9" aria-hidden="true" tabindex="-1"></a>                     <span class="at">verb =</span> my_vec_2)</span>
<span id="cb162-10"><a href="#cb162-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-11"><a href="#cb162-11" aria-hidden="true" tabindex="-1"></a><span class="co"># print df</span></span>
<span id="cb162-12"><a href="#cb162-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; # A tibble: 6 × 2
R&gt;   name      verb       
R&gt;   &lt;chr&gt;     &lt;chr&gt;      
R&gt; 1 "John "   is fishing.
R&gt; 2 "John "   is working.
R&gt; 3 "Claire " is fishing.
R&gt; 4 "Claire " is working.
R&gt; 5 "Adam "   is fishing.
R&gt; 6 "Adam "   is working.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="co"># paste columns together in tibble</span></span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a>my_df <span class="ot">&lt;-</span> my_df <span class="sc">|&gt;</span></span>
<span id="cb164-3"><a href="#cb164-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">phrase =</span> <span class="fu">paste0</span>(name, verb) )</span>
<span id="cb164-4"><a href="#cb164-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-5"><a href="#cb164-5" aria-hidden="true" tabindex="-1"></a><span class="co"># print result</span></span>
<span id="cb164-6"><a href="#cb164-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; # A tibble: 6 × 3
R&gt;   name      verb        phrase            
R&gt;   &lt;chr&gt;     &lt;chr&gt;       &lt;chr&gt;             
R&gt; 1 "John "   is fishing. John is fishing.  
R&gt; 2 "John "   is working. John is working.  
R&gt; 3 "Claire " is fishing. Claire is fishing.
R&gt; 4 "Claire " is working. Claire is working.
R&gt; 5 "Adam "   is fishing. Adam is fishing.  
R&gt; 6 "Adam "   is working. Adam is working.</code></pre>
</div>
</div>
<p>Aqui, usamos a função <strong>tidyr</strong>::<strong>expand_grid()</strong> para criar um <code>dataframe</code> contendo todas as combinações possíveis de <code>my_vec_1</code> e <code>my_vec_2</code>. Posteriormente, colamos o conteúdo das colunas do <code>dataframe</code> usando <strong>stringr</strong>::<strong>str_c()</strong> .</p>
</section>
<section id="codificação-de-objetos-character" class="level3" data-number="9.2.9">
<h3 data-number="9.2.9" class="anchored" data-anchor-id="codificação-de-objetos-character"><span class="header-section-number">9.2.9</span> Codificação de Objetos <code>character</code></h3>
<p>Para o R, um <em>string</em> de texto é apenas uma sequência de <em>bytes</em>. A tradução de <em>bytes</em> para caracteres é realizada de acordo com uma estrutura de codificação. Para a maioria dos casos de uso do R, especialmente em países de língua inglesa, a codificação de caracteres não é um problema pois os textos importados no R já possuem a codificação correta. Ao lidar com dados de texto em diferentes idiomas, tal como Português do Brasil, a codificação de caracteres é algo que você deve entender pois eventualmente precisará lidar com isso.</p>
<p>Vamos explorar um exemplo. Aqui, vamos importar dados de um arquivo de texto com a codificação <code>'ISO-8859-9'</code> e verificar o resultado.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="co"># read text file</span></span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a>my_f <span class="ot">&lt;-</span> introR<span class="sc">::</span><span class="fu">data_path</span>(<span class="st">'CH07_FileWithLatinChar_Latin1.txt'</span>)</span>
<span id="cb166-3"><a href="#cb166-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-4"><a href="#cb166-4" aria-hidden="true" tabindex="-1"></a>my_char <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_lines</span>(my_f)</span>
<span id="cb166-5"><a href="#cb166-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-6"><a href="#cb166-6" aria-hidden="true" tabindex="-1"></a><span class="co"># print it</span></span>
<span id="cb166-7"><a href="#cb166-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_char)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1] "A casa \xe9 bonita e tem muito espa\xe7o"</code></pre>
</div>
</div>
<p>O conteúdo original do arquivo é um texto em português. Como você pode ver, a saída de <strong>readr</strong>::<strong>read_lines()</strong> mostra todos os caracteres latinos com símbolos estranhos. Isso ocorre pois a codificação foi manualmente trocada no arquivo para <code>'ISO-8859-9'</code>, enquanto a função <strong>readr</strong>::<strong>read_lines()</strong> utiliza <code>'UTF-8'</code> como <em>default</em>. A solução mais fácil e direta é modificar a codificação esperada do arquivo nas entradas de <strong>readr</strong>::<strong>read_lines()</strong> . Veja a seguir, onde importamos um arquivo com a codificação correta (<code>'Latin1'</code>):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a>my_char <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_lines</span>(my_f, </span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a>                             <span class="at">locale =</span> readr<span class="sc">::</span><span class="fu">locale</span>(<span class="at">encoding=</span><span class="st">'Latin1'</span>))</span>
<span id="cb168-3"><a href="#cb168-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-4"><a href="#cb168-4" aria-hidden="true" tabindex="-1"></a><span class="co"># print it</span></span>
<span id="cb168-5"><a href="#cb168-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_char)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1] "A casa é bonita e tem muito espaço"</code></pre>
</div>
</div>
<p>Os caracteres latinos agora estão corretos pois a codificação em <strong>readr</strong>::<strong>read_lines()</strong> é a mesma do arquivo, <code>'Latin1'</code>. Uma boa política neste tópico é sempre verificar a codificação de arquivos de texto importados e combiná-lo em R. A maioria das funções de importação tem uma opção para fazê-lo. Quando possível, sempre dê preferência para <code>'UTF-8'</code>. Caso necessário, programas de edição de texto, tal como o <a href="">notepad++</a>, possuem ferramentas para verificar e trocar a codificação de um arquivo.</p>
</section>
<section id="outras-funções-úteis-1" class="level3" data-number="9.2.10">
<h3 data-number="9.2.10" class="anchored" data-anchor-id="outras-funções-úteis-1"><span class="header-section-number">9.2.10</span> Outras Funções Úteis</h3>
<p><code>stringr::str_to_lower</code>/<code>base::tolower</code> - Converte um objeto de texto para letras minúsculas.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(stringr<span class="sc">::</span><span class="fu">str_to_lower</span>(<span class="st">'ABC'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1] "abc"</code></pre>
</div>
</div>
<p><code>stringr::str_to_upper/base::toupper</code> - Convertem um texto em letras maiúsculas.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">toupper</span>(<span class="st">'abc'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1] "ABC"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(stringr<span class="sc">::</span><span class="fu">str_to_upper</span>(<span class="st">'abc'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1] "ABC"</code></pre>
</div>
</div>
</section>
</section>
<section id="fatores" class="level2" data-number="9.3">
<h2 data-number="9.3" class="anchored" data-anchor-id="fatores"><span class="header-section-number">9.3</span> Fatores</h2>
<p>A classe de fatores (<strong>factor()</strong> ) é utilizada para representar grupos ou categorias dentro de uma base de dados no formato tabular. Por exemplo, imagine um banco de informações com os gastos de diferentes pessoas ao longo de um ano. Nessa base de dados existe um item que define o gênero do indivíduo: masculino ou feminino (M ou F). Essa respectiva coluna pode ser importada e representada como texto, porém, no R, a melhor maneira de representá-la é através do objeto fator, uma vez que a mesma representa uma categoria.</p>
<p>A classe de fatores oferece um significado especial para denotar grupos dentro dos dados. Essa organização é integrada aos pacotes e facilita muito a vida do usuário. Por exemplo, caso quiséssemos criar um gráfico para cada grupo dentro da nossa base de dados, poderíamos fazer o mesmo simplesmente indicando a existência de uma variável de fator para a função de criação da figura. Outra possibilidade é determinar se as diferentes médias de uma variável numérica são estatisticamente diferentes para os grupos dos nossos dados. Podemos também estimar um determinado modelo estatístico para cada grupo. Quando os dados de categorias são representados apropriadamente, o uso das funções do R torna-se mais fácil e eficiente.</p>
<section id="criando-fatores" class="level3" data-number="9.3.1">
<h3 data-number="9.3.1" class="anchored" data-anchor-id="criando-fatores"><span class="header-section-number">9.3.1</span> Criando Fatores</h3>
<p>A criação de fatores dá-se através da função <strong>factor()</strong> :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a>my_factor <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">'M'</span>, <span class="st">'F'</span>, <span class="st">'M'</span>, <span class="st">'M'</span>, <span class="st">'F'</span>))</span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_factor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1] M F M M F
R&gt; Levels: F M</code></pre>
</div>
</div>
<p>Observe, no exemplo anterior, que a apresentação de fatores com a função <strong>print()</strong> mostra os seus elementos e também o item chamado <code>Levels</code>. Esse último identifica os possíveis grupos que abrangem o vetor - nesse caso apenas <code>M</code> e <code>F</code>. Se tivéssemos um número maior de grupos, o item <code>Levels</code> aumentaria. Veja a seguir:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a>my_factor <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">'M'</span>,<span class="st">'F'</span>,<span class="st">'M'</span>,<span class="st">'M'</span>,<span class="st">'F'</span>,<span class="st">'ND'</span>))</span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_factor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1] M  F  M  M  F  ND
R&gt; Levels: F M ND</code></pre>
</div>
</div>
<p>Um ponto importante na criação de fatores é que os <code>Levels</code> são inferidos através dos dados criados, e isso pode não corresponder à realidade. Por exemplo, observe o seguinte exemplo:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a>my_status <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">'Solteiro'</span>, <span class="st">'Solteiro'</span>, <span class="st">'Solteiro'</span>))</span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_status)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1] Solteiro Solteiro Solteiro
R&gt; Levels: Solteiro</code></pre>
</div>
</div>
<p>Nota-se que, por ocasião, os dados mostram apenas uma categoria: <code>Solteiro</code>. Entretanto, sabe-se que outra categoria do tipo <code>Casado</code> é esperada. No caso de utilizarmos o objeto <code>my_status</code> da maneira que foi definida anteriormente, omitiremos a informação de outros gêneros, e isso pode ocasionar problemas no futuro tal como a criação de gráficos incompletos. Nessa situação, o correto é definir os <code>Levels</code> manualmente da seguinte maneira:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a>my_status <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">'Solteiro'</span>, <span class="st">'Solteiro'</span>, <span class="st">'Solteiro'</span>),</span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">'Solteiro'</span>, <span class="st">'Casado'</span>))</span>
<span id="cb182-3"><a href="#cb182-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_status)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1] Solteiro Solteiro Solteiro
R&gt; Levels: Solteiro Casado</code></pre>
</div>
</div>
</section>
<section id="modificando-fatores" class="level3" data-number="9.3.2">
<h3 data-number="9.3.2" class="anchored" data-anchor-id="modificando-fatores"><span class="header-section-number">9.3.2</span> Modificando Fatores</h3>
<p>Um ponto importante sobre os objetos do tipo fator é que seus <code>Levels</code> são <strong>imutáveis e não atualizam-se com a entrada de novos dados</strong>. Em outras palavras, não é possível modificar os valores dos <code>Levels</code> após a criação do objeto. Toda nova informação que não for compatível com os <code>Levels</code> do objeto será transformada em <code>NA</code> (<em>Not available</em>) e uma mensagem de <code>warning</code> irá aparecer na tela. Essa limitação pode parecer estranha a primeira vista porém, na prática, ela evita possíveis erros no código. Veja o exemplo a seguir:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set factor</span></span>
<span id="cb184-2"><a href="#cb184-2" aria-hidden="true" tabindex="-1"></a>my_factor <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">'a'</span>, <span class="st">'b'</span>, <span class="st">'a'</span>, <span class="st">'b'</span>))</span>
<span id="cb184-3"><a href="#cb184-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb184-4"><a href="#cb184-4" aria-hidden="true" tabindex="-1"></a><span class="co"># change first element of a factor to 'c'</span></span>
<span id="cb184-5"><a href="#cb184-5" aria-hidden="true" tabindex="-1"></a>my_factor[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">'c'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>R&gt; Warning in `[&lt;-.factor`(`*tmp*`, 1, value = "c"): invalid
R&gt; factor level, NA generated</code></pre>
</div>
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="co"># print result</span></span>
<span id="cb186-2"><a href="#cb186-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_factor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1] &lt;NA&gt; b    a    b   
R&gt; Levels: a b</code></pre>
</div>
</div>
<p>Nesse caso, a maneira correta de proceder é primeiro transformar o objeto da classe fator para a classe caractere e depois realizar a conversão:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set factor</span></span>
<span id="cb188-2"><a href="#cb188-2" aria-hidden="true" tabindex="-1"></a>my_factor <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">'a'</span>, <span class="st">'b'</span>, <span class="st">'a'</span>, <span class="st">'b'</span>))</span>
<span id="cb188-3"><a href="#cb188-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-4"><a href="#cb188-4" aria-hidden="true" tabindex="-1"></a><span class="co"># change factor to character</span></span>
<span id="cb188-5"><a href="#cb188-5" aria-hidden="true" tabindex="-1"></a>my_char <span class="ot">&lt;-</span> <span class="fu">as.character</span>(my_factor)</span>
<span id="cb188-6"><a href="#cb188-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-7"><a href="#cb188-7" aria-hidden="true" tabindex="-1"></a><span class="co"># change first element</span></span>
<span id="cb188-8"><a href="#cb188-8" aria-hidden="true" tabindex="-1"></a>my_char[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">'c'</span></span>
<span id="cb188-9"><a href="#cb188-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-10"><a href="#cb188-10" aria-hidden="true" tabindex="-1"></a><span class="co"># mutate it back to class factor</span></span>
<span id="cb188-11"><a href="#cb188-11" aria-hidden="true" tabindex="-1"></a>my_factor <span class="ot">&lt;-</span> <span class="fu">factor</span>(my_char)</span>
<span id="cb188-12"><a href="#cb188-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-13"><a href="#cb188-13" aria-hidden="true" tabindex="-1"></a><span class="co"># show result</span></span>
<span id="cb188-14"><a href="#cb188-14" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_factor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1] c b a b
R&gt; Levels: a b c</code></pre>
</div>
</div>
<p>Utilizando essas etapas temos o resultado desejado no vetor <code>my_factor</code>, com a definição de três <code>Levels</code>: <code>a</code>, <code>b</code> e <code>c</code>.</p>
<p>O universo <strong>{tidyverse}</strong> <span class="citation" data-cites="R-tidyverse">(<a href="99-references.html#ref-R-tidyverse" role="doc-biblioref">Wickham 2023c</a>)</span> também possui um pacote próprio para manipular fatores, o <strong>{forcats}</strong> <span class="citation" data-cites="R-forcats">(<a href="99-references.html#ref-R-forcats" role="doc-biblioref">Wickham 2023a</a>)</span>. Para o problema atual de modificação de fatores, podemos utilizar função <strong>forcats</strong>::<strong>fct_recode()</strong> . Veja um exemplo a seguir, onde trocamos as siglas dos fatores:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forcats)</span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-3"><a href="#cb190-3" aria-hidden="true" tabindex="-1"></a><span class="co"># set factor</span></span>
<span id="cb190-4"><a href="#cb190-4" aria-hidden="true" tabindex="-1"></a>my.fct <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">'A'</span>, <span class="st">'B'</span>, <span class="st">'C'</span>, <span class="st">'A'</span>, <span class="st">'C'</span>, <span class="st">'M'</span>, <span class="st">'N'</span>))</span>
<span id="cb190-5"><a href="#cb190-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-6"><a href="#cb190-6" aria-hidden="true" tabindex="-1"></a><span class="co"># modify factors</span></span>
<span id="cb190-7"><a href="#cb190-7" aria-hidden="true" tabindex="-1"></a>my.fct <span class="ot">&lt;-</span> <span class="fu">fct_recode</span>(my.fct,</span>
<span id="cb190-8"><a href="#cb190-8" aria-hidden="true" tabindex="-1"></a>                     <span class="st">'D'</span> <span class="ot">=</span> <span class="st">'A'</span>,</span>
<span id="cb190-9"><a href="#cb190-9" aria-hidden="true" tabindex="-1"></a>                     <span class="st">'E'</span> <span class="ot">=</span> <span class="st">'B'</span>,</span>
<span id="cb190-10"><a href="#cb190-10" aria-hidden="true" tabindex="-1"></a>                     <span class="st">'F'</span> <span class="ot">=</span> <span class="st">'C'</span>)</span>
<span id="cb190-11"><a href="#cb190-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-12"><a href="#cb190-12" aria-hidden="true" tabindex="-1"></a><span class="co"># print result</span></span>
<span id="cb190-13"><a href="#cb190-13" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my.fct)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1] D E F D F M N
R&gt; Levels: D E F M N</code></pre>
</div>
</div>
<p>Observe como o uso da função <strong>forcats</strong>::<strong>fct_recode()</strong> é intuitivo. Basta indicar o novo nome dos grupos com o operador de igualdade.</p>
</section>
<section id="convertendo-fatores-para-outras-classes" class="level3" data-number="9.3.3">
<h3 data-number="9.3.3" class="anchored" data-anchor-id="convertendo-fatores-para-outras-classes"><span class="header-section-number">9.3.3</span> Convertendo Fatores para Outras Classes</h3>
<p>Outro ponto importante no uso de fatores é a sua conversão para outras classes, especialmente a numérica. Quando convertemos um objeto de tipo fator para a classe caractere, o resultado é o esperado:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create factor</span></span>
<span id="cb192-2"><a href="#cb192-2" aria-hidden="true" tabindex="-1"></a>my_char <span class="ot">&lt;-</span><span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">'a'</span>, <span class="st">'b'</span>, <span class="st">'c'</span>))</span>
<span id="cb192-3"><a href="#cb192-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-4"><a href="#cb192-4" aria-hidden="true" tabindex="-1"></a><span class="co"># convert and print</span></span>
<span id="cb192-5"><a href="#cb192-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">as.character</span>(my_char))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1] "a" "b" "c"</code></pre>
</div>
</div>
<p>Porém, quando fazemos o mesmo procedimento para a classe numérica, o que o R retorna é <strong>longe do esperado</strong>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb194"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set factor</span></span>
<span id="cb194-2"><a href="#cb194-2" aria-hidden="true" tabindex="-1"></a>my_values <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="dv">5</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb194-3"><a href="#cb194-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4"><a href="#cb194-4" aria-hidden="true" tabindex="-1"></a><span class="co"># convert to numeric (WRONG)</span></span>
<span id="cb194-5"><a href="#cb194-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">as.numeric</span>(my_values))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1] 1 2 3 4 5 6</code></pre>
</div>
</div>
<p>Esse resultado pode ser explicado pelo fato de que, internamente, fatores são armazenados como índices, indo de 1 até o número total de <code>Levels</code>. Essa simplificação minimiza o uso da memória do computador. Quando pedimos ao R para transformar esses fatores em números, ele entende que buscamos o número do índice e não do valor. Para contornar, é fácil: basta transformar o objeto fator em caractere e, depois, em numérico, conforme mostrado a seguir:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="co"># converting factors to character and then to numeric</span></span>
<span id="cb196-2"><a href="#cb196-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">as.numeric</span>(<span class="fu">as.character</span>(my_values)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1]  5  6  7  8  9 10</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Cuidado
</div>
</div>
<div class="callout-body-container callout-body">
<p>Tenha muito cuidado ao transformar fatores em números. Lembre-se sempre de que o retorno da conversão direta serão os índices dos <code>levels</code> e não os valores em si. Esse é um <em>bug</em> bem particular que pode ser difícil de identificar em um código complexo.</p>
</div>
</div>
</section>
<section id="criando-tabelas-de-contingência" class="level3" data-number="9.3.4">
<h3 data-number="9.3.4" class="anchored" data-anchor-id="criando-tabelas-de-contingência"><span class="header-section-number">9.3.4</span> Criando Tabelas de Contingência</h3>
<p>Após a criação de um fator, podemos calcular a ocorrência de cada fator com a função <strong>table()</strong> . Essa também é chamada de tabela de contingência. Em um caso simples, com apenas um fator, a função <strong>table()</strong> conta o número de ocorrências de cada categoria, como a seguir:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create factor</span></span>
<span id="cb198-2"><a href="#cb198-2" aria-hidden="true" tabindex="-1"></a>my_factor <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">'Pref'</span>, <span class="st">'Ord'</span>),</span>
<span id="cb198-3"><a href="#cb198-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">size =</span> <span class="dv">20</span>,</span>
<span id="cb198-4"><a href="#cb198-4" aria-hidden="true" tabindex="-1"></a>                           <span class="at">replace =</span> <span class="cn">TRUE</span>))</span>
<span id="cb198-5"><a href="#cb198-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-6"><a href="#cb198-6" aria-hidden="true" tabindex="-1"></a><span class="co"># print contingency table</span></span>
<span id="cb198-7"><a href="#cb198-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">table</span>(my_factor))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; my_factor
R&gt;  Ord Pref 
R&gt;    9   11</code></pre>
</div>
</div>
<p>Um caso mais avançado do uso de <strong>table()</strong> é utilizar mais de um fator para a criação da tabela. Veja o exemplo a seguir:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb200"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set factors</span></span>
<span id="cb200-2"><a href="#cb200-2" aria-hidden="true" tabindex="-1"></a>my_factor_1 <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">'Pref'</span>, <span class="st">'Ord'</span>),</span>
<span id="cb200-3"><a href="#cb200-3" aria-hidden="true" tabindex="-1"></a>                             <span class="at">size =</span> <span class="dv">20</span>,</span>
<span id="cb200-4"><a href="#cb200-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">replace =</span> <span class="cn">TRUE</span>))</span>
<span id="cb200-5"><a href="#cb200-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-6"><a href="#cb200-6" aria-hidden="true" tabindex="-1"></a>my_factor_2 <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">sample</span>(<span class="fu">paste</span>(<span class="st">'Grupo'</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>),</span>
<span id="cb200-7"><a href="#cb200-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">size =</span> <span class="dv">20</span>,</span>
<span id="cb200-8"><a href="#cb200-8" aria-hidden="true" tabindex="-1"></a>                             <span class="at">replace =</span> <span class="cn">TRUE</span>))</span>
<span id="cb200-9"><a href="#cb200-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-10"><a href="#cb200-10" aria-hidden="true" tabindex="-1"></a><span class="co"># print contingency table with two factors</span></span>
<span id="cb200-11"><a href="#cb200-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">table</span>(my_factor_1, my_factor_2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt;            my_factor_2
R&gt; my_factor_1 Grupo 1 Grupo 2 Grupo 3
R&gt;        Ord        2       4       3
R&gt;        Pref       3       4       4</code></pre>
</div>
</div>
<p>A tabela criada anteriormente mostra o número de ocorrências para cada combinação de fator. Essa é uma ferramenta descritiva simples, mas bastante informativa para a análise de grupos de dados.</p>
</section>
<section id="outras-funções" class="level3" data-number="9.3.5">
<h3 data-number="9.3.5" class="anchored" data-anchor-id="outras-funções"><span class="header-section-number">9.3.5</span> Outras Funções</h3>
<p><strong>levels</strong> - Retorna os <code>Levels</code> de um objeto da classe fator.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb202"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a>my_factor <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">'A'</span>, <span class="st">'A'</span>, <span class="st">'B'</span>, <span class="st">'C'</span>, <span class="st">'B'</span>))</span>
<span id="cb202-2"><a href="#cb202-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">levels</span>(my_factor))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1] "A" "B" "C"</code></pre>
</div>
</div>
<p><strong>as.factor</strong> - Transforma um objeto para a classe fator.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb204"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a>my_y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'a'</span>,<span class="st">'b'</span>, <span class="st">'c'</span>, <span class="st">'c'</span>, <span class="st">'a'</span>)</span>
<span id="cb204-2"><a href="#cb204-2" aria-hidden="true" tabindex="-1"></a>my_factor <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(my_y)</span>
<span id="cb204-3"><a href="#cb204-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_factor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1] a b c c a
R&gt; Levels: a b c</code></pre>
</div>
</div>
<p><strong>split</strong> - Com base em um objeto de fator, cria uma lista com valores de outro objeto. Esse comando é útil para separar dados de grupos diferentes e aplicar alguma função com <strong>sapply()</strong> ou <code>lapply</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb206"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a>my_factor <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">'A'</span>,<span class="st">'B'</span>,<span class="st">'C'</span>,<span class="st">'C'</span>,<span class="st">'C'</span>,<span class="st">'B'</span>))</span>
<span id="cb206-2"><a href="#cb206-2" aria-hidden="true" tabindex="-1"></a>my_x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(my_factor)</span>
<span id="cb206-3"><a href="#cb206-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-4"><a href="#cb206-4" aria-hidden="true" tabindex="-1"></a>my_l <span class="ot">&lt;-</span> <span class="fu">split</span>(<span class="at">x =</span> my_x, <span class="at">f =</span> my_factor)</span>
<span id="cb206-5"><a href="#cb206-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-6"><a href="#cb206-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_l)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; $A
R&gt; [1] 1
R&gt; 
R&gt; $B
R&gt; [1] 2 6
R&gt; 
R&gt; $C
R&gt; [1] 3 4 5</code></pre>
</div>
</div>
</section>
</section>
<section id="valores-lógicos" class="level2" data-number="9.4">
<h2 data-number="9.4" class="anchored" data-anchor-id="valores-lógicos"><span class="header-section-number">9.4</span> Valores Lógicos</h2>
<p>Testes lógicos em dados são centrais no uso do R. Em uma única linha de código podemos testar condições para uma grande quantidade de casos. Esse cálculo é muito utilizado para encontrar casos extremos nos dados (<em>outliers</em>) e também para separar diferentes amostras de acordo com algum critério.</p>
<section id="criando-valores-lógicos" class="level3" data-number="9.4.1">
<h3 data-number="9.4.1" class="anchored" data-anchor-id="criando-valores-lógicos"><span class="header-section-number">9.4.1</span> Criando Valores Lógicos</h3>
<p>Em uma sequência de 1 até 10, podemos verificar quais são os elementos maiores que 5 com o seguinte código:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb208"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set numerical</span></span>
<span id="cb208-2"><a href="#cb208-2" aria-hidden="true" tabindex="-1"></a>my_x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb208-3"><a href="#cb208-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-4"><a href="#cb208-4" aria-hidden="true" tabindex="-1"></a><span class="co"># print a logical test</span></span>
<span id="cb208-5"><a href="#cb208-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_x <span class="sc">&gt;</span> <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt;  [1] FALSE FALSE FALSE FALSE FALSE  TRUE  TRUE  TRUE  TRUE
R&gt; [10]  TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb210"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a><span class="co"># print position of elements from logical test</span></span>
<span id="cb210-2"><a href="#cb210-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">which</span>(my_x <span class="sc">&gt;</span> <span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1]  6  7  8  9 10</code></pre>
</div>
</div>
<p>A função <strong>which()</strong> do exemplo anterior retorna os índices onde a condição é verdadeira (<code>TRUE</code>). O uso do <strong>which()</strong> é recomendado quando se quer saber a posição de elementos que satisfazem alguma condição.</p>
<p>Para realizar testes de igualdade, basta utilizar o símbolo de igualdade duas vezes (<code>==</code>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb212"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create char</span></span>
<span id="cb212-2"><a href="#cb212-2" aria-hidden="true" tabindex="-1"></a>my_char <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">'abc'</span>,<span class="st">'bcd'</span>), <span class="dv">5</span>)</span>
<span id="cb212-3"><a href="#cb212-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-4"><a href="#cb212-4" aria-hidden="true" tabindex="-1"></a><span class="co"># print its contents</span></span>
<span id="cb212-5"><a href="#cb212-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_char)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt;  [1] "abc" "bcd" "abc" "bcd" "abc" "bcd" "abc" "bcd" "abc"
R&gt; [10] "bcd"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb214"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a><span class="co"># print logical test</span></span>
<span id="cb214-2"><a href="#cb214-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_char <span class="sc">==</span> <span class="st">'abc'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt;  [1]  TRUE FALSE  TRUE FALSE  TRUE FALSE  TRUE FALSE  TRUE
R&gt; [10] FALSE</code></pre>
</div>
</div>
<p>Para o teste de inigualdades, utilizamos o símbolo <code>!=</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb216"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a><span class="co"># print inequality test</span></span>
<span id="cb216-2"><a href="#cb216-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_char <span class="sc">!=</span> <span class="st">'abc'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt;  [1] FALSE  TRUE FALSE  TRUE FALSE  TRUE FALSE  TRUE FALSE
R&gt; [10]  TRUE</code></pre>
</div>
</div>
<p>Destaca-se que também é possível testar condições múltiplas, isto é, a ocorrência simultânea de eventos. Utilizamos o operador <code>&amp;</code> para esse propósito. Por exemplo: se quiséssemos verificar quais são os valores de uma sequência de 1 a 10 que são maiores que 4 <strong>e</strong> menores que 7, escreveríamos:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb218"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a>my_x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb218-2"><a href="#cb218-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-3"><a href="#cb218-3" aria-hidden="true" tabindex="-1"></a><span class="co"># print logical for values higher than 4 and lower than 7</span></span>
<span id="cb218-4"><a href="#cb218-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>((my_x <span class="sc">&gt;</span> <span class="dv">4</span>)<span class="sc">&amp;</span>(my_x <span class="sc">&lt;</span> <span class="dv">7</span>) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt;  [1] FALSE FALSE FALSE FALSE  TRUE  TRUE FALSE FALSE FALSE
R&gt; [10] FALSE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb220"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="co"># print the actual values</span></span>
<span id="cb220-2"><a href="#cb220-2" aria-hidden="true" tabindex="-1"></a>idx <span class="ot">&lt;-</span> <span class="fu">which</span>( (my_x <span class="sc">&gt;</span> <span class="dv">4</span>)<span class="sc">&amp;</span>(my_x <span class="sc">&lt;</span> <span class="dv">7</span>) )</span>
<span id="cb220-3"><a href="#cb220-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_x[idx])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1] 5 6</code></pre>
</div>
</div>
<p>Para testar condições não simultâneas, isto é, ocorrências de um ou outro evento, utilizamos o operador <code>|</code>. Por exemplo: considerando a sequência anterior, acharíamos os valores maiores que 7 <strong>ou</strong> menores que 4 escrevendo:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb222"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a><span class="co"># location of elements higher than 7 or lower than 4</span></span>
<span id="cb222-2"><a href="#cb222-2" aria-hidden="true" tabindex="-1"></a>idx <span class="ot">&lt;-</span> <span class="fu">which</span>( (my_x <span class="sc">&gt;</span> <span class="dv">7</span>)<span class="sc">|</span>(my_x <span class="sc">&lt;</span> <span class="dv">4</span>) )</span>
<span id="cb222-3"><a href="#cb222-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-4"><a href="#cb222-4" aria-hidden="true" tabindex="-1"></a><span class="co"># print elements from previous condition</span></span>
<span id="cb222-5"><a href="#cb222-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_x[idx])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1]  1  2  3  8  9 10</code></pre>
</div>
</div>
<p>Observe que, em ambos os casos de uso de testes lógicos, utilizamos parênteses para encapsular as condições lógicas. Poderíamos ter escrito <code>idx &lt;- which( my_x &gt; 7|my_x &lt; 4 )</code>, porém o uso do parênteses deixa o código mais claro ao isolar os testes de condições e sinalizar que o resultado da operação será um vetor lógico. Em alguns casos, porém, o uso do parênteses indica hierarquia na ordem das operações e portanto não pode ser ignorado.</p>
<p>Outro uso interessante de objetos lógicos é o teste para saber se um item ou mais pertence a um vetor ou não. Para isso utilizamos o operador <code>%in%</code>. Por exemplo, imagine que tens os <em>tickers</em> de duas ações, <code>c('ABC', 'DEF')</code> e queres saber se é possível encontrar esses tickers na coluna de outra base de dados. Essa é uma operação semelhante ao uso do teste de igualdade, porém em notação vetorial. Veja um exemplo a seguir:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb224"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb224-2"><a href="#cb224-2" aria-hidden="true" tabindex="-1"></a><span class="co"># location of elements higher than 7 or lower than 4</span></span>
<span id="cb224-3"><a href="#cb224-3" aria-hidden="true" tabindex="-1"></a>my_tickers <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'ABC'</span>, <span class="st">'DEF'</span>)</span>
<span id="cb224-4"><a href="#cb224-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-5"><a href="#cb224-5" aria-hidden="true" tabindex="-1"></a><span class="co"># set df</span></span>
<span id="cb224-6"><a href="#cb224-6" aria-hidden="true" tabindex="-1"></a>n_obs <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb224-7"><a href="#cb224-7" aria-hidden="true" tabindex="-1"></a>df_temp <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">tickers =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">'ABC'</span>, <span class="st">'DEF'</span>, <span class="st">'GHI'</span>, <span class="st">'JKL'</span>),</span>
<span id="cb224-8"><a href="#cb224-8" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">size =</span> n_obs,</span>
<span id="cb224-9"><a href="#cb224-9" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb224-10"><a href="#cb224-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ret =</span> <span class="fu">rnorm</span>(n_obs, <span class="at">sd =</span> <span class="fl">0.05</span>) )</span>
<span id="cb224-11"><a href="#cb224-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-12"><a href="#cb224-12" aria-hidden="true" tabindex="-1"></a><span class="co"># find rows with selected tickers</span></span>
<span id="cb224-13"><a href="#cb224-13" aria-hidden="true" tabindex="-1"></a>idx <span class="ot">&lt;-</span> df_temp<span class="sc">$</span>tickers <span class="sc">%in%</span> my_tickers</span>
<span id="cb224-14"><a href="#cb224-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-15"><a href="#cb224-15" aria-hidden="true" tabindex="-1"></a><span class="co"># print elements from previous condition</span></span>
<span id="cb224-16"><a href="#cb224-16" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(df_temp[idx, ])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; Rows: 43
R&gt; Columns: 2
R&gt; $ tickers &lt;chr&gt; "ABC", "ABC", "ABC", "DEF", "DEF", "ABC", …
R&gt; $ ret     &lt;dbl&gt; 0.042864781, 0.017056405, 0.011198439, 0.0…</code></pre>
</div>
</div>
<p>O <code>dataframe</code> mostrado na tela possui dados apenas para ações em <code>my_tickers</code>.</p>
</section>
</section>
<section id="datas-e-tempo" class="level2" data-number="9.5">
<h2 data-number="9.5" class="anchored" data-anchor-id="datas-e-tempo"><span class="header-section-number">9.5</span> Datas e Tempo</h2>
<p>A representação e manipulação de datas é um importante aspecto das pesquisas em Finanças e Economia. Manipular datas e horários de forma correta, levando em conta mudanças decorridas de horário de verão, feriados locais, em diferentes zonas de tempo, não é uma tarefa fácil! Felizmente, o R fornece um grande suporte para qualquer tipo de operação com datas e tempo.</p>
<p>Nesta seção estudaremos as funções e classes nativas que representam e manipulam o tempo em R. Aqui, daremos prioridade as funções do pacote <strong>{lubridate}</strong> <span class="citation" data-cites="R-lubridate">(<a href="99-references.html#ref-R-lubridate" role="doc-biblioref">Spinu, Grolemund, and Wickham 2023</a>)</span>. Existem, no entanto, muitos pacotes que podem ajudar o usuário a processar objetos do tipo data e tempo de forma mais avançada. Caso alguma operação com data e tempo não for encontrada aqui, sugiro o estudo dos pacotes <strong>{chron}</strong> <span class="citation" data-cites="R-chron">(<a href="99-references.html#ref-R-chron" role="doc-biblioref"><strong>R-chron?</strong></a>)</span>, <strong>{timeDate}</strong> <span class="citation" data-cites="R-timeDate">(<a href="99-references.html#ref-R-timeDate" role="doc-biblioref"><strong>R-timeDate?</strong></a>)</span> e <strong>{bizdays}</strong> <span class="citation" data-cites="R-bizdays">(<a href="99-references.html#ref-R-bizdays" role="doc-biblioref"><strong>R-bizdays?</strong></a>)</span>.</p>
<p>Antes de começarmos, vale relembrar que toda data no R segue o formato <a href="">ISO 8601</a> (<code>YYYY-MM-DD</code>), onde <code>YYYY</code> é o ano em quatro números, <code>MM</code> é o mês e <code>DD</code> é o dia. Por exemplo, uma data em ISO 8601 é 2024-01-10. Deves familiarizar-se com esse formato pois toda importação de dados com formato de datas diferente desta notação exigirá conversão. Felizmente, essa operação é bastante simples de executar com o <strong>{lubridate}</strong> <span class="citation" data-cites="R-lubridate">(<a href="99-references.html#ref-R-lubridate" role="doc-biblioref">Spinu, Grolemund, and Wickham 2023</a>)</span>.</p>
<section id="criando-datas-simples" class="level3" data-number="9.5.1">
<h3 data-number="9.5.1" class="anchored" data-anchor-id="criando-datas-simples"><span class="header-section-number">9.5.1</span> Criando Datas Simples</h3>
<p>No R, existem diversas classes que podem representar datas. A escolha entre uma classe de datas e outra baseia-se na necessidade da pesquisa. Em muitas situações não é necessário saber o horário, enquanto que em outras isso é extremamente pertinente pois os dados são coletados ao longo de um dia.</p>
<p>A classe mais básica de datas é <code>Date</code>. Essa indica dia, mês e ano, apenas. No <strong>{lubridate}</strong> <span class="citation" data-cites="R-lubridate">(<a href="99-references.html#ref-R-lubridate" role="doc-biblioref">Spinu, Grolemund, and Wickham 2023</a>)</span>, criamos datas verificando o formato da data de entrada e as funções <strong>lubridate</strong>::<strong>ymd()</strong> (year-month-date), <strong>lubridate</strong>::<strong>dmy()</strong> (day-month-year) e <strong>lubridate</strong>::<strong>mdy()</strong> (month-day-year). Veja a seguir:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb226"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb226-1"><a href="#cb226-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb226-2"><a href="#cb226-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-3"><a href="#cb226-3" aria-hidden="true" tabindex="-1"></a><span class="co"># set Date object</span></span>
<span id="cb226-4"><a href="#cb226-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">ymd</span>(<span class="st">'2021-06-24'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1] "2021-06-24"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb228"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb228-1"><a href="#cb228-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set Date object</span></span>
<span id="cb228-2"><a href="#cb228-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">dmy</span>(<span class="st">'24-06-2021'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1] "2021-06-24"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb230"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set Date object</span></span>
<span id="cb230-2"><a href="#cb230-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">mdy</span>(<span class="st">'06-24-2021'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1] "2021-06-24"</code></pre>
</div>
</div>
<p>Note que as funções retornam exatamente o mesmo objeto. A diferença no uso é somente pela forma que a data de entrada está estruturada com a posição do dia, mês e ano.</p>
<p>Um benefício no uso das funções do pacote <strong>{lubridate}</strong> <span class="citation" data-cites="R-lubridate">(<a href="99-references.html#ref-R-lubridate" role="doc-biblioref">Spinu, Grolemund, and Wickham 2023</a>)</span> é que as mesmas são inteligentes ao lidar com formatos diferentes. Observe no caso anterior que definimos os elementos das datas com o uso do traço (<code>-</code>) como separador e valores numéricos. Outros formatos também são automaticamente reconhecidos:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb232"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb232-1"><a href="#cb232-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set Date object</span></span>
<span id="cb232-2"><a href="#cb232-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">ymd</span>(<span class="st">'2021/06/24'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1] "2021-06-24"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb234"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb234-1"><a href="#cb234-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set Date object</span></span>
<span id="cb234-2"><a href="#cb234-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">ymd</span>(<span class="st">'2021&amp;06&amp;24'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1] "2021-06-24"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb236"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb236-1"><a href="#cb236-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set Date object</span></span>
<span id="cb236-2"><a href="#cb236-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">ymd</span>(<span class="st">'2021 june 24'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1] "2021-06-24"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb238"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb238-1"><a href="#cb238-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set Date object</span></span>
<span id="cb238-2"><a href="#cb238-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">dmy</span>(<span class="st">'24 of june 2021'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1] "2021-06-24"</code></pre>
</div>
</div>
<p>Isso é bastante útil pois o formato de datas no Brasil é <code>dia/mês/ano</code> (DD/MM/YYYY). Ao usar <strong>lubridate</strong>::<strong>dmy()</strong> para uma data brasileira, a conversão é correta:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb240"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb240-1"><a href="#cb240-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set Date from dd/mm/yyyy</span></span>
<span id="cb240-2"><a href="#cb240-2" aria-hidden="true" tabindex="-1"></a>my_date <span class="ot">&lt;-</span> <span class="fu">dmy</span>(<span class="st">'24/06/2021'</span>)</span>
<span id="cb240-3"><a href="#cb240-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb240-4"><a href="#cb240-4" aria-hidden="true" tabindex="-1"></a><span class="co"># print result</span></span>
<span id="cb240-5"><a href="#cb240-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_date)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1] "2021-06-24"</code></pre>
</div>
</div>
<p>Já no pacote <strong>{base}</strong> <span class="citation" data-cites="R-base">(<a href="99-references.html#ref-R-base" role="doc-biblioref">R Core Team 2023</a>)</span>, a função correspondente é <strong>as.Date()</strong> . O formato da data, porém, deve ser explicitamente definido com argumento <strong>format()</strong> , conforme mostrado a seguir:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb242"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb242-1"><a href="#cb242-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set Date from dd/mm/yyyy with the definition of format</span></span>
<span id="cb242-2"><a href="#cb242-2" aria-hidden="true" tabindex="-1"></a>my_date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">'24/06/2021'</span>, <span class="at">format =</span> <span class="st">'%d/%m/%Y'</span>)</span>
<span id="cb242-3"><a href="#cb242-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-4"><a href="#cb242-4" aria-hidden="true" tabindex="-1"></a><span class="co"># print result</span></span>
<span id="cb242-5"><a href="#cb242-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_date)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1] "2021-06-24"</code></pre>
</div>
</div>
<p>Os símbolos utilizados na entrada <strong>format()</strong> , tal como <code>%d</code> e <code>%Y</code>, são indicadores de formato, os quais definem a forma em que a data a ser convertida está estruturada. Nesse caso, os símbolos <code>%Y</code>, <code>%m</code> e <code>%d</code> definem ano, mês e dia, respectivamente. Existem diversos outros símbolos que podem ser utilizados para processar datas em formatos específicos. Um panorama das principais codificações é apresentado a seguir:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: center;">Código</th>
<th style="text-align: center;">Valor</th>
<th style="text-align: center;">Exemplo</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">%d</td>
<td style="text-align: center;">dia do mês (decimal)</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: center;">%m</td>
<td style="text-align: center;">mês (decimal)</td>
<td style="text-align: center;">12</td>
</tr>
<tr class="odd">
<td style="text-align: center;">%b</td>
<td style="text-align: center;">mês (abreviado)</td>
<td style="text-align: center;">Abr</td>
</tr>
<tr class="even">
<td style="text-align: center;">%B</td>
<td style="text-align: center;">mês (nome completo)</td>
<td style="text-align: center;">Abril</td>
</tr>
<tr class="odd">
<td style="text-align: center;">%y</td>
<td style="text-align: center;">ano (2 dígitos)</td>
<td style="text-align: center;">16</td>
</tr>
<tr class="even">
<td style="text-align: center;">%Y</td>
<td style="text-align: center;">ano (4 dígitos)</td>
<td style="text-align: center;">2021</td>
</tr>
</tbody>
</table>
<p>Os símbolos anteriores permitem a criação de datas a partir de variados formatos. Observe como a utilização das funções do <strong>{lubridate}</strong> <span class="citation" data-cites="R-lubridate">(<a href="99-references.html#ref-R-lubridate" role="doc-biblioref">Spinu, Grolemund, and Wickham 2023</a>)</span>, em relação a <strong>{base}</strong> <span class="citation" data-cites="R-base">(<a href="99-references.html#ref-R-base" role="doc-biblioref">R Core Team 2023</a>)</span>, são mais simples e fáceis de utilizar, justificando a nossa escolha.</p>
</section>
<section id="criando-sequências-de-datas" class="level3" data-number="9.5.2">
<h3 data-number="9.5.2" class="anchored" data-anchor-id="criando-sequências-de-datas"><span class="header-section-number">9.5.2</span> Criando Sequências de Datas</h3>
<p>Um aspecto interessante no uso de objetos do tipo <code>Date</code> é que eles interagem com operações de adição de valores numéricos e com testes lógicos de comparação de datas. Por exemplo: caso quiséssemos adicionar um dia à data <code>my_date</code> criada anteriormente, bastaria somar o valor 1 ao objeto:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb244"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb244-1"><a href="#cb244-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create date</span></span>
<span id="cb244-2"><a href="#cb244-2" aria-hidden="true" tabindex="-1"></a>my_date <span class="ot">&lt;-</span> <span class="fu">ymd</span>(<span class="st">'2021-06-24'</span>)</span>
<span id="cb244-3"><a href="#cb244-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb244-4"><a href="#cb244-4" aria-hidden="true" tabindex="-1"></a><span class="co"># find next day</span></span>
<span id="cb244-5"><a href="#cb244-5" aria-hidden="true" tabindex="-1"></a>my_date_2 <span class="ot">&lt;-</span> my_date <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb244-6"><a href="#cb244-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb244-7"><a href="#cb244-7" aria-hidden="true" tabindex="-1"></a><span class="co"># print result</span></span>
<span id="cb244-8"><a href="#cb244-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_date_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1] "2021-06-25"</code></pre>
</div>
</div>
<p>A propriedade também funciona com vetores, o que deixa a criação de sequências de datas muito fácil. Nesse caso, o próprio R encarrega-se de verificar o número de dias em cada mês.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb246"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb246-1"><a href="#cb246-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create a sequence of Dates</span></span>
<span id="cb246-2"><a href="#cb246-2" aria-hidden="true" tabindex="-1"></a>my_date_vec <span class="ot">&lt;-</span> my_date <span class="sc">+</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">15</span></span>
<span id="cb246-3"><a href="#cb246-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb246-4"><a href="#cb246-4" aria-hidden="true" tabindex="-1"></a><span class="co"># print it</span></span>
<span id="cb246-5"><a href="#cb246-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_date_vec)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt;  [1] "2021-06-24" "2021-06-25" "2021-06-26" "2021-06-27"
R&gt;  [5] "2021-06-28" "2021-06-29" "2021-06-30" "2021-07-01"
R&gt;  [9] "2021-07-02" "2021-07-03" "2021-07-04" "2021-07-05"
R&gt; [13] "2021-07-06" "2021-07-07" "2021-07-08" "2021-07-09"</code></pre>
</div>
</div>
<p>Uma maneira mais customizável de criar sequências de datas é utilizar a função <strong>seq()</strong> . Com ela, é possível definir intervalos diferentes de tempo e até mesmo o tamanho do vetor de saída. Caso quiséssemos uma sequência de datas de dois em dois dias, poderíamos utilizar o seguinte código: </p>
<div class="cell">
<div class="sourceCode cell-code" id="cb248"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb248-1"><a href="#cb248-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set first and last Date</span></span>
<span id="cb248-2"><a href="#cb248-2" aria-hidden="true" tabindex="-1"></a>my_date_1 <span class="ot">&lt;-</span> <span class="fu">ymd</span>(<span class="st">'2021-03-07'</span>)</span>
<span id="cb248-3"><a href="#cb248-3" aria-hidden="true" tabindex="-1"></a>my_date_2 <span class="ot">&lt;-</span> <span class="fu">ymd</span>(<span class="st">'2021-03-20'</span>)</span>
<span id="cb248-4"><a href="#cb248-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb248-5"><a href="#cb248-5" aria-hidden="true" tabindex="-1"></a><span class="co"># set sequence</span></span>
<span id="cb248-6"><a href="#cb248-6" aria-hidden="true" tabindex="-1"></a>my_date_date <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> my_date_1,</span>
<span id="cb248-7"><a href="#cb248-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">to =</span> my_date_2,</span>
<span id="cb248-8"><a href="#cb248-8" aria-hidden="true" tabindex="-1"></a>                    <span class="at">by =</span> <span class="st">'2 days'</span>)</span>
<span id="cb248-9"><a href="#cb248-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb248-10"><a href="#cb248-10" aria-hidden="true" tabindex="-1"></a><span class="co"># print result</span></span>
<span id="cb248-11"><a href="#cb248-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_date_date)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1] "2021-03-07" "2021-03-09" "2021-03-11" "2021-03-13"
R&gt; [5] "2021-03-15" "2021-03-17" "2021-03-19"</code></pre>
</div>
</div>
<p>Caso quiséssemos de duas em duas semanas, escreveríamos:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb250"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb250-1"><a href="#cb250-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set first and last Date</span></span>
<span id="cb250-2"><a href="#cb250-2" aria-hidden="true" tabindex="-1"></a>my_date_1 <span class="ot">&lt;-</span> <span class="fu">ymd</span>(<span class="st">'2021-03-07'</span>)</span>
<span id="cb250-3"><a href="#cb250-3" aria-hidden="true" tabindex="-1"></a>my_date_2 <span class="ot">&lt;-</span> <span class="fu">ymd</span>(<span class="st">'2021-04-20'</span>)</span>
<span id="cb250-4"><a href="#cb250-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb250-5"><a href="#cb250-5" aria-hidden="true" tabindex="-1"></a><span class="co"># set sequence</span></span>
<span id="cb250-6"><a href="#cb250-6" aria-hidden="true" tabindex="-1"></a>my_date_date <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> my_date_1,</span>
<span id="cb250-7"><a href="#cb250-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">to =</span> my_date_2,</span>
<span id="cb250-8"><a href="#cb250-8" aria-hidden="true" tabindex="-1"></a>                    <span class="at">by =</span> <span class="st">'2 weeks'</span>)</span>
<span id="cb250-9"><a href="#cb250-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb250-10"><a href="#cb250-10" aria-hidden="true" tabindex="-1"></a><span class="co"># print result</span></span>
<span id="cb250-11"><a href="#cb250-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_date_date)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1] "2021-03-07" "2021-03-21" "2021-04-04" "2021-04-18"</code></pre>
</div>
</div>
<p>Outra forma de utilizar <strong>seq()</strong> é definir o tamanho desejado do objeto de saída. Por exemplo, caso quiséssemos um vetor de datas com 10 elementos, usaríamos:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb252"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb252-1"><a href="#cb252-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set first and last Date</span></span>
<span id="cb252-2"><a href="#cb252-2" aria-hidden="true" tabindex="-1"></a>my_date_1 <span class="ot">&lt;-</span> <span class="fu">ymd</span>(<span class="st">'2021-03-07'</span>)</span>
<span id="cb252-3"><a href="#cb252-3" aria-hidden="true" tabindex="-1"></a>my_date_2 <span class="ot">&lt;-</span> <span class="fu">ymd</span>(<span class="st">'2021-10-20'</span>)</span>
<span id="cb252-4"><a href="#cb252-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb252-5"><a href="#cb252-5" aria-hidden="true" tabindex="-1"></a><span class="co"># set sequence</span></span>
<span id="cb252-6"><a href="#cb252-6" aria-hidden="true" tabindex="-1"></a>my_date_vec <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> my_date_1,</span>
<span id="cb252-7"><a href="#cb252-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">to =</span> my_date_2,</span>
<span id="cb252-8"><a href="#cb252-8" aria-hidden="true" tabindex="-1"></a>                    <span class="at">length.out =</span> <span class="dv">10</span>)</span>
<span id="cb252-9"><a href="#cb252-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb252-10"><a href="#cb252-10" aria-hidden="true" tabindex="-1"></a><span class="co"># print result</span></span>
<span id="cb252-11"><a href="#cb252-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_date_vec)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt;  [1] "2021-03-07" "2021-04-01" "2021-04-26" "2021-05-21"
R&gt;  [5] "2021-06-15" "2021-07-11" "2021-08-05" "2021-08-30"
R&gt;  [9] "2021-09-24" "2021-10-20"</code></pre>
</div>
</div>
<p>O intervalo entre as datas em <code>my_date_vec</code> é definido automaticamente pelo R.</p>
</section>
<section id="operações-com-datas" class="level3" data-number="9.5.3">
<h3 data-number="9.5.3" class="anchored" data-anchor-id="operações-com-datas"><span class="header-section-number">9.5.3</span> Operações com Datas</h3>
<p>É possível descobrir a diferença de dias entre datas simplesmente diminuindo uma data da outra:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb254"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb254-1"><a href="#cb254-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set dates</span></span>
<span id="cb254-2"><a href="#cb254-2" aria-hidden="true" tabindex="-1"></a>my_date_1 <span class="ot">&lt;-</span> <span class="fu">ymd</span>(<span class="st">'2015-06-24'</span>)</span>
<span id="cb254-3"><a href="#cb254-3" aria-hidden="true" tabindex="-1"></a>my_date_2 <span class="ot">&lt;-</span> <span class="fu">ymd</span>(<span class="st">'2016-06-24'</span>)</span>
<span id="cb254-4"><a href="#cb254-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-5"><a href="#cb254-5" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate difference</span></span>
<span id="cb254-6"><a href="#cb254-6" aria-hidden="true" tabindex="-1"></a>diff_date <span class="ot">&lt;-</span> my_date_2 <span class="sc">-</span> my_date_1</span>
<span id="cb254-7"><a href="#cb254-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-8"><a href="#cb254-8" aria-hidden="true" tabindex="-1"></a><span class="co"># print result</span></span>
<span id="cb254-9"><a href="#cb254-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(diff_date)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; Time difference of 366 days</code></pre>
</div>
</div>
<p>A saída da operação de subtração é um objeto da classe <code>diffdate</code>, o qual possui a classe de lista como sua estrutura básica. Destaca-se que a notação de acesso aos elementos da classe <code>diffdate</code> é a mesma utilizada para listas. O valor numérico do número de dias está contido no primeiro elemento de <code>diff_date</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb256"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb256-1"><a href="#cb256-1" aria-hidden="true" tabindex="-1"></a><span class="co"># print difference of days as numerical value</span></span>
<span id="cb256-2"><a href="#cb256-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(diff_date[[<span class="dv">1</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1] 366</code></pre>
</div>
</div>
<p>Podemos testar se uma data é maior do que outra com o uso das operações de comparação:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb258"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb258-1"><a href="#cb258-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set date and vector</span></span>
<span id="cb258-2"><a href="#cb258-2" aria-hidden="true" tabindex="-1"></a>my_date_1 <span class="ot">&lt;-</span> <span class="fu">ymd</span>(<span class="st">'2016-06-20'</span>)</span>
<span id="cb258-3"><a href="#cb258-3" aria-hidden="true" tabindex="-1"></a>my_date_vec <span class="ot">&lt;-</span> <span class="fu">ymd</span>(<span class="st">'2016-06-20'</span>) <span class="sc">+</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="dv">5</span>)</span>
<span id="cb258-4"><a href="#cb258-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb258-5"><a href="#cb258-5" aria-hidden="true" tabindex="-1"></a><span class="co"># test which elements of my_date_vec are older than my_date_1</span></span>
<span id="cb258-6"><a href="#cb258-6" aria-hidden="true" tabindex="-1"></a>my_test <span class="ot">&lt;-</span> (my_date_vec <span class="sc">&gt;</span> my_date_1)</span>
<span id="cb258-7"><a href="#cb258-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb258-8"><a href="#cb258-8" aria-hidden="true" tabindex="-1"></a><span class="co"># print result</span></span>
<span id="cb258-9"><a href="#cb258-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt;  [1] FALSE FALSE FALSE FALSE FALSE FALSE  TRUE  TRUE  TRUE
R&gt; [10]  TRUE  TRUE</code></pre>
</div>
</div>
<p>A operação anterior é bastante útil quando se está buscando filtrar um determinado período de tempo nos dados. Nesse caso, basta buscar nas datas o período específico em que estamos interessados e utilizar o objeto lógico da comparação para selecionar os elementos. Veja o exemplo a seguir:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb260"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb260-1"><a href="#cb260-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb260-2"><a href="#cb260-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb260-3"><a href="#cb260-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-4"><a href="#cb260-4" aria-hidden="true" tabindex="-1"></a><span class="co"># set first and last dates</span></span>
<span id="cb260-5"><a href="#cb260-5" aria-hidden="true" tabindex="-1"></a>first_date <span class="ot">&lt;-</span> <span class="fu">ymd</span>(<span class="st">'2016-06-01'</span>)</span>
<span id="cb260-6"><a href="#cb260-6" aria-hidden="true" tabindex="-1"></a>last_date <span class="ot">&lt;-</span> <span class="fu">ymd</span>(<span class="st">'2016-06-15'</span>)</span>
<span id="cb260-7"><a href="#cb260-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-8"><a href="#cb260-8" aria-hidden="true" tabindex="-1"></a><span class="co"># create `dataframe` and glimpse it</span></span>
<span id="cb260-9"><a href="#cb260-9" aria-hidden="true" tabindex="-1"></a>my_temp_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">date_vec =</span> <span class="fu">ymd</span>(<span class="st">'2016-05-25'</span>) <span class="sc">+</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">30</span>),</span>
<span id="cb260-10"><a href="#cb260-10" aria-hidden="true" tabindex="-1"></a>                     <span class="at">prices=</span><span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">10</span>,</span>
<span id="cb260-11"><a href="#cb260-11" aria-hidden="true" tabindex="-1"></a>                                <span class="at">length.out =</span> <span class="fu">length</span>(date_vec)))</span>
<span id="cb260-12"><a href="#cb260-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-13"><a href="#cb260-13" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(my_temp_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; Rows: 31
R&gt; Columns: 2
R&gt; $ date_vec &lt;date&gt; 2016-05-25, 2016-05-26, 2016-05-27, 2016…
R&gt; $ prices   &lt;dbl&gt; 1.0, 1.3, 1.6, 1.9, 2.2, 2.5, 2.8, 3.1, 3…</code></pre>
</div>
<div class="sourceCode cell-code" id="cb262"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb262-1"><a href="#cb262-1" aria-hidden="true" tabindex="-1"></a><span class="co"># find dates that are between the first and last date</span></span>
<span id="cb262-2"><a href="#cb262-2" aria-hidden="true" tabindex="-1"></a>my_idx <span class="ot">&lt;-</span> (my_temp_df<span class="sc">$</span>date_vec <span class="sc">&gt;=</span> first_date) <span class="sc">&amp;</span></span>
<span id="cb262-3"><a href="#cb262-3" aria-hidden="true" tabindex="-1"></a>  (my_temp_df<span class="sc">$</span>date_vec <span class="sc">&lt;=</span> last_date)</span>
<span id="cb262-4"><a href="#cb262-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb262-5"><a href="#cb262-5" aria-hidden="true" tabindex="-1"></a><span class="co"># use index to filter `dataframe`</span></span>
<span id="cb262-6"><a href="#cb262-6" aria-hidden="true" tabindex="-1"></a>my_temp_df_filtered <span class="ot">&lt;-</span> my_temp_df <span class="sc">|&gt;</span></span>
<span id="cb262-7"><a href="#cb262-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(my_idx) <span class="sc">|&gt;</span></span>
<span id="cb262-8"><a href="#cb262-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; Rows: 15
R&gt; Columns: 2
R&gt; $ date_vec &lt;date&gt; 2016-06-01, 2016-06-02, 2016-06-03, 2016…
R&gt; $ prices   &lt;dbl&gt; 3.1, 3.4, 3.7, 4.0, 4.3, 4.6, 4.9, 5.2, 5…</code></pre>
</div>
</div>
<p>Nesse caso, o vetor final de preços da coluna <code>prices</code> contém apenas informações para o período entre <code>first_date</code> e <code>last_date</code>.</p>
</section>
<section id="lidando-com-data-e-tempo" class="level3" data-number="9.5.4">
<h3 data-number="9.5.4" class="anchored" data-anchor-id="lidando-com-data-e-tempo"><span class="header-section-number">9.5.4</span> Lidando com Data e Tempo</h3>
<p>O uso da classe <code>Date</code> é suficiente quando se está lidando apenas com datas. Em casos em que é necessário levar em consideração o horário, temos que utilizar um objeto do tipo <code>datetime</code>.</p>
<p>No pacote <strong>{base}</strong> <span class="citation" data-cites="R-base">(<a href="99-references.html#ref-R-base" role="doc-biblioref">R Core Team 2023</a>)</span>, uma das classes utilizadas para esse fim é a <code>POSIXlt</code>, a qual armazena o conteúdo de uma data na forma de uma lista. Outra classe que também é possível utilizar é a <code>POSIXct</code>, que armazena as datas como segundos contados a partir de <code>1970-01-01</code>. Devido ao seu formato de armazenamento, a classe <code>POSIXct</code> ocupa menos memória do computador. Junto ao <strong>{lubridate}</strong> <span class="citation" data-cites="R-lubridate">(<a href="99-references.html#ref-R-lubridate" role="doc-biblioref">Spinu, Grolemund, and Wickham 2023</a>)</span>, a classe utilizada para representar data-tempo é <code>POSIXct</code> e portanto daremos prioridade a essa. Vale destacar que todos os exemplos apresentados aqui também podem ser replicados para objetos do tipo <code>POSIXlt</code>.</p>
<p>O formato tempo/data também segue a norma <a href="">ISO 8601</a>, sendo representado como <code>ano-mês-dia horas:minutos:segundos zonadetempo</code> (YYYY-MM-DD HH:mm:SS TMZ). Veja o exemplo a seguir:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb264"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb264-1"><a href="#cb264-1" aria-hidden="true" tabindex="-1"></a><span class="co"># creating a POSIXct object</span></span>
<span id="cb264-2"><a href="#cb264-2" aria-hidden="true" tabindex="-1"></a>my_timedate <span class="ot">&lt;-</span> <span class="fu">as.POSIXct</span>(<span class="st">'2021-01-01 16:00:00'</span>)</span>
<span id="cb264-3"><a href="#cb264-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-4"><a href="#cb264-4" aria-hidden="true" tabindex="-1"></a><span class="co"># print result</span></span>
<span id="cb264-5"><a href="#cb264-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_timedate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1] "2021-01-01 16:00:00 -03"</code></pre>
</div>
</div>
<p>O pacote <strong>{lubridate}</strong> <span class="citation" data-cites="R-lubridate">(<a href="99-references.html#ref-R-lubridate" role="doc-biblioref">Spinu, Grolemund, and Wickham 2023</a>)</span> também oferece funções inteligentes para a criação de objetos do tipo data-tempo. Essas seguem a mesma linha de raciocínio que as funções de criar datas. Veja a seguir:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb266"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb266-1"><a href="#cb266-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb266-2"><a href="#cb266-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-3"><a href="#cb266-3" aria-hidden="true" tabindex="-1"></a><span class="co"># creating a POSIXlt object</span></span>
<span id="cb266-4"><a href="#cb266-4" aria-hidden="true" tabindex="-1"></a>my_timedate <span class="ot">&lt;-</span> <span class="fu">ymd_hms</span>(<span class="st">'2021-01-01 16:00:00'</span>)</span>
<span id="cb266-5"><a href="#cb266-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-6"><a href="#cb266-6" aria-hidden="true" tabindex="-1"></a><span class="co"># print it</span></span>
<span id="cb266-7"><a href="#cb266-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_timedate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1] "2021-01-01 16:00:00 UTC"</code></pre>
</div>
</div>
<p>Destaca-se que essa classe adiciona automaticamente o fuso horário. Caso seja necessário representar um fuso diferente, é possível fazê-lo com o argumento <code>tz</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb268"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb268-1"><a href="#cb268-1" aria-hidden="true" tabindex="-1"></a><span class="co"># creating a POSIXlt object with custom timezone</span></span>
<span id="cb268-2"><a href="#cb268-2" aria-hidden="true" tabindex="-1"></a>my_timedate_tz <span class="ot">&lt;-</span> <span class="fu">ymd_hms</span>(<span class="st">'2021-01-01 16:00:00'</span>,</span>
<span id="cb268-3"><a href="#cb268-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">tz =</span> <span class="st">'GMT'</span>)</span>
<span id="cb268-4"><a href="#cb268-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb268-5"><a href="#cb268-5" aria-hidden="true" tabindex="-1"></a><span class="co"># print it</span></span>
<span id="cb268-6"><a href="#cb268-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_timedate_tz)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1] "2021-01-01 16:00:00 GMT"</code></pre>
</div>
</div>
<p>É importante ressaltar que, para o caso de objetos do tipo <code>POSIXlt</code> e <code>POSIXct</code>, <strong>as operações de soma e diminuição referem-se a segundos</strong> e não dias, como no caso do objeto da classe <code>Date</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb270"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb270-1"><a href="#cb270-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Adding values (seconds) to a POSIXlt object and printing it</span></span>
<span id="cb270-2"><a href="#cb270-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_timedate_tz <span class="sc">+</span> <span class="dv">30</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1] "2021-01-01 16:00:30 GMT"</code></pre>
</div>
</div>
<p>Assim como para a classe <code>Date</code>, existem símbolos específicos para lidar com componentes de um objeto do tipo data/tempo. Isso permite a formatação customizada de datas. A seguir, apresentamos um quadro com os principais símbolos e os seus respectivos significados.</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: center;">Código</th>
<th style="text-align: center;">Valor</th>
<th style="text-align: center;">Exemplo</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">%H</td>
<td style="text-align: center;">Hora (decimal, 24 horas)</td>
<td style="text-align: center;">23</td>
</tr>
<tr class="even">
<td style="text-align: center;">%I</td>
<td style="text-align: center;">Hora (decimal, 12 horas)</td>
<td style="text-align: center;">11</td>
</tr>
<tr class="odd">
<td style="text-align: center;">%M</td>
<td style="text-align: center;">Minuto (decimal, 0-59)</td>
<td style="text-align: center;">12</td>
</tr>
<tr class="even">
<td style="text-align: center;">%p</td>
<td style="text-align: center;">Indicador AM/PM</td>
<td style="text-align: center;">AM</td>
</tr>
<tr class="odd">
<td style="text-align: center;">%S</td>
<td style="text-align: center;">Segundos (decimal, 0-59)</td>
<td style="text-align: center;">50</td>
</tr>
</tbody>
</table>
<p>A seguir veremos como utilizar essa tabela para customizar datas.</p>
</section>
<section id="personalizando-o-formato-de-datas" class="level3" data-number="9.5.5">
<h3 data-number="9.5.5" class="anchored" data-anchor-id="personalizando-o-formato-de-datas"><span class="header-section-number">9.5.5</span> Personalizando o Formato de Datas</h3>
<p>A notação básica para representar datas e data/tempo no R pode não ser a ideal em algumas situações. No Brasil, por exemplo, indicar datas no formato <code>YYYY-MM-DD</code> pode gerar bastante confusão em um relatório formal. É recomendado, portanto, modificar a representação das datas para o formato esperado, isto é, <code>DD/MM/YYYY</code>.</p>
<p>Para formatar uma data, utilizamos a função <strong>format()</strong> . Seu uso baseia-se nos símbolos de data e de horário apresentados anteriormente. A partir desses, pode-se criar qualquer customização. Veja o exemplo a seguir, onde apresenta-se a modificação de um vetor de datas para o formato brasileiro:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb272"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb272-1"><a href="#cb272-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create vector of dates</span></span>
<span id="cb272-2"><a href="#cb272-2" aria-hidden="true" tabindex="-1"></a>my_dates <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="fu">ymd</span>(<span class="st">'2021-01-01'</span>),</span>
<span id="cb272-3"><a href="#cb272-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">to =</span> <span class="fu">ymd</span>(<span class="st">'2021-01-15'</span>),</span>
<span id="cb272-4"><a href="#cb272-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">by =</span> <span class="st">'1 day'</span>)</span>
<span id="cb272-5"><a href="#cb272-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb272-6"><a href="#cb272-6" aria-hidden="true" tabindex="-1"></a><span class="co"># change format</span></span>
<span id="cb272-7"><a href="#cb272-7" aria-hidden="true" tabindex="-1"></a>my_dates_br <span class="ot">&lt;-</span> <span class="fu">format</span>(my_dates, <span class="st">'%d/%m/%Y'</span>)</span>
<span id="cb272-8"><a href="#cb272-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb272-9"><a href="#cb272-9" aria-hidden="true" tabindex="-1"></a><span class="co"># print result</span></span>
<span id="cb272-10"><a href="#cb272-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_dates_br)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt;  [1] "01/01/2021" "02/01/2021" "03/01/2021" "04/01/2021"
R&gt;  [5] "05/01/2021" "06/01/2021" "07/01/2021" "08/01/2021"
R&gt;  [9] "09/01/2021" "10/01/2021" "11/01/2021" "12/01/2021"
R&gt; [13] "13/01/2021" "14/01/2021" "15/01/2021"</code></pre>
</div>
</div>
<p>O mesmo procedimento pode ser realizado para objetos do tipo data/tempo (<code>POSIXct</code>):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb274"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb274-1"><a href="#cb274-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create vector of date-time</span></span>
<span id="cb274-2"><a href="#cb274-2" aria-hidden="true" tabindex="-1"></a>my_datetime <span class="ot">&lt;-</span> <span class="fu">ymd_hms</span>(<span class="st">'2021-01-01 12:00:00'</span>) <span class="sc">+</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">560</span>,<span class="dv">60</span>)</span>
<span id="cb274-3"><a href="#cb274-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb274-4"><a href="#cb274-4" aria-hidden="true" tabindex="-1"></a><span class="co"># change to Brazilian format</span></span>
<span id="cb274-5"><a href="#cb274-5" aria-hidden="true" tabindex="-1"></a>my_dates_br <span class="ot">&lt;-</span> <span class="fu">format</span>(my_datetime, <span class="st">'%d/%m/%Y %H:%M:%S'</span>)</span>
<span id="cb274-6"><a href="#cb274-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb274-7"><a href="#cb274-7" aria-hidden="true" tabindex="-1"></a><span class="co"># print result</span></span>
<span id="cb274-8"><a href="#cb274-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_dates_br)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt;  [1] "01/01/2021 12:00:00" "01/01/2021 12:01:00"
R&gt;  [3] "01/01/2021 12:02:00" "01/01/2021 12:03:00"
R&gt;  [5] "01/01/2021 12:04:00" "01/01/2021 12:05:00"
R&gt;  [7] "01/01/2021 12:06:00" "01/01/2021 12:07:00"
R&gt;  [9] "01/01/2021 12:08:00" "01/01/2021 12:09:00"</code></pre>
</div>
</div>
<p>Pode-se também customizar para formatos bem específicos. Veja a seguir:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb276"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb276-1"><a href="#cb276-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set custom format</span></span>
<span id="cb276-2"><a href="#cb276-2" aria-hidden="true" tabindex="-1"></a>my_dates_custom <span class="ot">&lt;-</span> <span class="fu">format</span>(my_dates,</span>
<span id="cb276-3"><a href="#cb276-3" aria-hidden="true" tabindex="-1"></a>                          <span class="st">'Year=%Y | Month=%m | Day=%d'</span>)</span>
<span id="cb276-4"><a href="#cb276-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb276-5"><a href="#cb276-5" aria-hidden="true" tabindex="-1"></a><span class="co"># print result</span></span>
<span id="cb276-6"><a href="#cb276-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_dates_custom)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt;  [1] "Year=2021 | Month=01 | Day=01"
R&gt;  [2] "Year=2021 | Month=01 | Day=02"
R&gt;  [3] "Year=2021 | Month=01 | Day=03"
R&gt;  [4] "Year=2021 | Month=01 | Day=04"
R&gt;  [5] "Year=2021 | Month=01 | Day=05"
R&gt;  [6] "Year=2021 | Month=01 | Day=06"
R&gt;  [7] "Year=2021 | Month=01 | Day=07"
R&gt;  [8] "Year=2021 | Month=01 | Day=08"
R&gt;  [9] "Year=2021 | Month=01 | Day=09"
R&gt; [10] "Year=2021 | Month=01 | Day=10"
R&gt; [11] "Year=2021 | Month=01 | Day=11"
R&gt; [12] "Year=2021 | Month=01 | Day=12"
R&gt; [13] "Year=2021 | Month=01 | Day=13"
R&gt; [14] "Year=2021 | Month=01 | Day=14"
R&gt; [15] "Year=2021 | Month=01 | Day=15"</code></pre>
</div>
</div>
</section>
<section id="extraindo-elementos-de-uma-data" class="level3" data-number="9.5.6">
<h3 data-number="9.5.6" class="anchored" data-anchor-id="extraindo-elementos-de-uma-data"><span class="header-section-number">9.5.6</span> Extraindo Elementos de uma Data</h3>
<p>Para extrair elementos de datas tal como o ano, mês, dia, hora, minuto e segundo, uma alternativa é utilizar função <strong>format()</strong> . Observe o próximo exemplo, onde recuperamos apenas as horas de um objeto <code>POSIXct</code>: </p>
<div class="cell">
<div class="sourceCode cell-code" id="cb278"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb278-1"><a href="#cb278-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb278-2"><a href="#cb278-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb278-3"><a href="#cb278-3" aria-hidden="true" tabindex="-1"></a><span class="co"># create vector of date-time</span></span>
<span id="cb278-4"><a href="#cb278-4" aria-hidden="true" tabindex="-1"></a>my_datetime <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="fu">ymd_hms</span>(<span class="st">'2021-01-01 12:00:00'</span>),</span>
<span id="cb278-5"><a href="#cb278-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">to =</span> <span class="fu">ymd_hms</span>(<span class="st">'2021-01-01 18:00:00'</span>),</span>
<span id="cb278-6"><a href="#cb278-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">by =</span> <span class="st">'1 hour'</span>)</span>
<span id="cb278-7"><a href="#cb278-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb278-8"><a href="#cb278-8" aria-hidden="true" tabindex="-1"></a><span class="co"># get hours from POSIXlt</span></span>
<span id="cb278-9"><a href="#cb278-9" aria-hidden="true" tabindex="-1"></a>my_hours <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(my_datetime, <span class="st">'%H'</span>))</span>
<span id="cb278-10"><a href="#cb278-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb278-11"><a href="#cb278-11" aria-hidden="true" tabindex="-1"></a><span class="co"># print result</span></span>
<span id="cb278-12"><a href="#cb278-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_hours)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1] 12 13 14 15 16 17 18</code></pre>
</div>
</div>
<p>Da mesma forma, poderíamos utilizar os símbolos <code>%M</code> e <code>%S</code> para recuperar facilmente minutos e segundos de um vetor de objetos <code>POSIXct</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb280"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb280-1"><a href="#cb280-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create vector of date-time</span></span>
<span id="cb280-2"><a href="#cb280-2" aria-hidden="true" tabindex="-1"></a>my_datetime <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="fu">ymd_hms</span>(<span class="st">'2021-01-01 12:00:00'</span>),</span>
<span id="cb280-3"><a href="#cb280-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">to =</span> <span class="fu">ymd_hms</span>(<span class="st">'2021-01-01 18:00:00'</span>),</span>
<span id="cb280-4"><a href="#cb280-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">by =</span> <span class="st">'15 min'</span>)</span>
<span id="cb280-5"><a href="#cb280-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb280-6"><a href="#cb280-6" aria-hidden="true" tabindex="-1"></a><span class="co"># get minutes from POSIXlt</span></span>
<span id="cb280-7"><a href="#cb280-7" aria-hidden="true" tabindex="-1"></a>my_minutes <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(my_datetime, <span class="st">'%M'</span>))</span>
<span id="cb280-8"><a href="#cb280-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb280-9"><a href="#cb280-9" aria-hidden="true" tabindex="-1"></a><span class="co"># print result</span></span>
<span id="cb280-10"><a href="#cb280-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_minutes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt;  [1]  0 15 30 45  0 15 30 45  0 15 30 45  0 15 30 45  0 15
R&gt; [19] 30 45  0 15 30 45  0</code></pre>
</div>
</div>
<p>Outra forma é utilizar as funções do <strong>{lubridate}</strong> <span class="citation" data-cites="R-lubridate">(<a href="99-references.html#ref-R-lubridate" role="doc-biblioref">Spinu, Grolemund, and Wickham 2023</a>)</span>, tal como <strong>lubridate</strong>::<strong>hour()</strong> e <strong>lubridate</strong>::<strong>minute()</strong> :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb282"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb282-1"><a href="#cb282-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get hours with lubridate</span></span>
<span id="cb282-2"><a href="#cb282-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">hour</span>(my_datetime))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt;  [1] 12 12 12 12 13 13 13 13 14 14 14 14 15 15 15 15 16 16
R&gt; [19] 16 16 17 17 17 17 18</code></pre>
</div>
<div class="sourceCode cell-code" id="cb284"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb284-1"><a href="#cb284-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get minutes with lubridate</span></span>
<span id="cb284-2"><a href="#cb284-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">minute</span>(my_datetime))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt;  [1]  0 15 30 45  0 15 30 45  0 15 30 45  0 15 30 45  0 15
R&gt; [19] 30 45  0 15 30 45  0</code></pre>
</div>
</div>
<p>Outras funções também estão disponíveis para os demais elementos de um objeto data-hora.</p>
</section>
<section id="conhecendo-o-horário-e-a-data-atual" class="level3" data-number="9.5.7">
<h3 data-number="9.5.7" class="anchored" data-anchor-id="conhecendo-o-horário-e-a-data-atual"><span class="header-section-number">9.5.7</span> Conhecendo o Horário e a Data Atual</h3>
<p>O R inclui várias funções que permitem o usuário utilizar no seu código o horário e data atual do sistema. Isso é bastante útil quando se está criando registros e é importante que a data e horário de execução do código seja conhecida futuramente.</p>
<p>Para conhecer o dia atual, basta utilizarmos a função <strong>Sys.Date()</strong> ou <strong>lubridate</strong>::<strong>today()</strong> :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb286"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb286-1"><a href="#cb286-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb286-2"><a href="#cb286-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-3"><a href="#cb286-3" aria-hidden="true" tabindex="-1"></a><span class="co"># get today</span></span>
<span id="cb286-4"><a href="#cb286-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">Sys.Date</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1] "2024-01-10"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb288"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb288-1"><a href="#cb288-1" aria-hidden="true" tabindex="-1"></a><span class="co"># print it</span></span>
<span id="cb288-2"><a href="#cb288-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">today</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1] "2024-01-10"</code></pre>
</div>
</div>
<p>Para descobrir a data e horário, utilizamos a função <strong>Sys.time()</strong> ou <strong>lubridate</strong>::<strong>now()</strong> :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb290"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb290-1"><a href="#cb290-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get time!</span></span>
<span id="cb290-2"><a href="#cb290-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">Sys.time</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1] "2024-01-10 16:21:32 -03"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb292"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb292-1"><a href="#cb292-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get time!</span></span>
<span id="cb292-2"><a href="#cb292-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">now</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1] "2024-01-10 16:21:32 -03"</code></pre>
</div>
</div>
<p>Com base nessas, podemos escrever:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb294"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb294-1"><a href="#cb294-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb294-2"><a href="#cb294-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb294-3"><a href="#cb294-3" aria-hidden="true" tabindex="-1"></a><span class="co"># example of log message</span></span>
<span id="cb294-4"><a href="#cb294-4" aria-hidden="true" tabindex="-1"></a>my_str <span class="ot">&lt;-</span> <span class="fu">str_c</span>(<span class="st">'This code was executed in '</span>, <span class="fu">now</span>())</span>
<span id="cb294-5"><a href="#cb294-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb294-6"><a href="#cb294-6" aria-hidden="true" tabindex="-1"></a><span class="co"># print it</span></span>
<span id="cb294-7"><a href="#cb294-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_str)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1] "This code was executed in 2024-01-10 16:21:32.803666"</code></pre>
</div>
</div>
</section>
<section id="outras-funções-úteis-2" class="level3" data-number="9.5.8">
<h3 data-number="9.5.8" class="anchored" data-anchor-id="outras-funções-úteis-2"><span class="header-section-number">9.5.8</span> Outras Funções Úteis</h3>
<p><strong>weekdays</strong> - Retorna o dia da semana de uma ou várias datas.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb296"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb296-1"><a href="#cb296-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set date vector</span></span>
<span id="cb296-2"><a href="#cb296-2" aria-hidden="true" tabindex="-1"></a>my_dates <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="fu">ymd</span>(<span class="st">'2021-01-01'</span>),</span>
<span id="cb296-3"><a href="#cb296-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">to =</span> <span class="fu">ymd</span>(<span class="st">'2021-01-5'</span>),</span>
<span id="cb296-4"><a href="#cb296-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">by =</span> <span class="st">'1 day'</span>)</span>
<span id="cb296-5"><a href="#cb296-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb296-6"><a href="#cb296-6" aria-hidden="true" tabindex="-1"></a><span class="co"># find corresponding weekdays</span></span>
<span id="cb296-7"><a href="#cb296-7" aria-hidden="true" tabindex="-1"></a>my_weekdays <span class="ot">&lt;-</span> <span class="fu">weekdays</span>(my_dates)</span>
<span id="cb296-8"><a href="#cb296-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb296-9"><a href="#cb296-9" aria-hidden="true" tabindex="-1"></a><span class="co"># print it</span></span>
<span id="cb296-10"><a href="#cb296-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_weekdays)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1] "Friday"   "Saturday" "Sunday"   "Monday"   "Tuesday"</code></pre>
</div>
</div>
<p><strong>months</strong> - Retorna o mês de uma ou várias datas.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb298"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb298-1"><a href="#cb298-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create date vector</span></span>
<span id="cb298-2"><a href="#cb298-2" aria-hidden="true" tabindex="-1"></a>my_dates <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="fu">ymd</span>(<span class="st">'2021-01-01'</span>),</span>
<span id="cb298-3"><a href="#cb298-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">to =</span> <span class="fu">ymd</span>(<span class="st">'2021-12-31'</span>),</span>
<span id="cb298-4"><a href="#cb298-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">by =</span> <span class="st">'1 month'</span>)</span>
<span id="cb298-5"><a href="#cb298-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb298-6"><a href="#cb298-6" aria-hidden="true" tabindex="-1"></a><span class="co"># find months</span></span>
<span id="cb298-7"><a href="#cb298-7" aria-hidden="true" tabindex="-1"></a>my_months <span class="ot">&lt;-</span> <span class="fu">months</span>(my_dates)</span>
<span id="cb298-8"><a href="#cb298-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb298-9"><a href="#cb298-9" aria-hidden="true" tabindex="-1"></a><span class="co"># print result</span></span>
<span id="cb298-10"><a href="#cb298-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_months)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt;  [1] "January"   "February"  "March"     "April"    
R&gt;  [5] "May"       "June"      "July"      "August"   
R&gt;  [9] "September" "October"   "November"  "December"</code></pre>
</div>
</div>
<p><strong>quarters</strong> - Retorna a localização de uma ou mais datas dentro dos quartis do ano.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb300"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb300-1"><a href="#cb300-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get quartiles of the year</span></span>
<span id="cb300-2"><a href="#cb300-2" aria-hidden="true" tabindex="-1"></a>my_quarters <span class="ot">&lt;-</span> <span class="fu">quarters</span>(my_dates)</span>
<span id="cb300-3"><a href="#cb300-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_quarters)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt;  [1] "Q1" "Q1" "Q1" "Q2" "Q2" "Q2" "Q3" "Q3" "Q3" "Q4" "Q4"
R&gt; [12] "Q4"</code></pre>
</div>
</div>
<p><strong>OlsonNames</strong> - Retorna um vetor com as zonas de tempo disponíveis no R. No total, são mais de 500 itens. Aqui, apresentamos apenas os primeiros cinco elementos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb302"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb302-1"><a href="#cb302-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get possible timezones</span></span>
<span id="cb302-2"><a href="#cb302-2" aria-hidden="true" tabindex="-1"></a>possible_tz <span class="ot">&lt;-</span> <span class="fu">OlsonNames</span>()</span>
<span id="cb302-3"><a href="#cb302-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb302-4"><a href="#cb302-4" aria-hidden="true" tabindex="-1"></a><span class="co"># print it</span></span>
<span id="cb302-5"><a href="#cb302-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(possible_tz[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1] "Africa/Abidjan"     "Africa/Accra"      
R&gt; [3] "Africa/Addis_Ababa" "Africa/Algiers"    
R&gt; [5] "Africa/Asmara"</code></pre>
</div>
</div>
<p><strong>Sys.timezone</strong> - Retorna a zona de tempo do sistema.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb304"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb304-1"><a href="#cb304-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get current timezone</span></span>
<span id="cb304-2"><a href="#cb304-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">Sys.timezone</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1] "America/Sao_Paulo"</code></pre>
</div>
</div>
<p><strong>cut</strong> - Retorna um fator a partir da categorização de uma classe de data e tempo.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb306"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb306-1"><a href="#cb306-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set example date vector</span></span>
<span id="cb306-2"><a href="#cb306-2" aria-hidden="true" tabindex="-1"></a>my_dates <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="fu">ymd</span>(<span class="st">'2021-01-01'</span>),</span>
<span id="cb306-3"><a href="#cb306-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">to =</span> <span class="fu">ymd</span>(<span class="st">'2021-03-01'</span>),</span>
<span id="cb306-4"><a href="#cb306-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">by =</span> <span class="st">'5 days'</span>)</span>
<span id="cb306-5"><a href="#cb306-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb306-6"><a href="#cb306-6" aria-hidden="true" tabindex="-1"></a><span class="co"># group vector based on monthly breaks</span></span>
<span id="cb306-7"><a href="#cb306-7" aria-hidden="true" tabindex="-1"></a>my_month_cut <span class="ot">&lt;-</span> <span class="fu">cut</span>(<span class="at">x =</span> my_dates,</span>
<span id="cb306-8"><a href="#cb306-8" aria-hidden="true" tabindex="-1"></a>                    <span class="at">breaks =</span> <span class="st">'month'</span>)</span>
<span id="cb306-9"><a href="#cb306-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb306-10"><a href="#cb306-10" aria-hidden="true" tabindex="-1"></a><span class="co"># print result</span></span>
<span id="cb306-11"><a href="#cb306-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_month_cut)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt;  [1] 2021-01-01 2021-01-01 2021-01-01 2021-01-01 2021-01-01
R&gt;  [6] 2021-01-01 2021-01-01 2021-02-01 2021-02-01 2021-02-01
R&gt; [11] 2021-02-01 2021-02-01
R&gt; Levels: 2021-01-01 2021-02-01</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb308"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb308-1"><a href="#cb308-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set example datetime vector</span></span>
<span id="cb308-2"><a href="#cb308-2" aria-hidden="true" tabindex="-1"></a>my_datetime <span class="ot">&lt;-</span> <span class="fu">as.POSIXlt</span>(<span class="st">'2021-01-01 12:00:00'</span>) <span class="sc">+</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">250</span>,<span class="dv">15</span>)</span>
<span id="cb308-3"><a href="#cb308-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb308-4"><a href="#cb308-4" aria-hidden="true" tabindex="-1"></a><span class="co"># set groups for each 30 seconds</span></span>
<span id="cb308-5"><a href="#cb308-5" aria-hidden="true" tabindex="-1"></a>my_cut <span class="ot">&lt;-</span> <span class="fu">cut</span>(<span class="at">x =</span> my_datetime, <span class="at">breaks =</span> <span class="st">'30 secs'</span>)</span>
<span id="cb308-6"><a href="#cb308-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb308-7"><a href="#cb308-7" aria-hidden="true" tabindex="-1"></a><span class="co"># print result</span></span>
<span id="cb308-8"><a href="#cb308-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_cut)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt;  [1] 2021-01-01 12:00:00 2021-01-01 12:00:00
R&gt;  [3] 2021-01-01 12:00:30 2021-01-01 12:00:30
R&gt;  [5] 2021-01-01 12:01:00 2021-01-01 12:01:00
R&gt;  [7] 2021-01-01 12:01:30 2021-01-01 12:01:30
R&gt;  [9] 2021-01-01 12:02:00 2021-01-01 12:02:00
R&gt; [11] 2021-01-01 12:02:30 2021-01-01 12:02:30
R&gt; [13] 2021-01-01 12:03:00 2021-01-01 12:03:00
R&gt; [15] 2021-01-01 12:03:30 2021-01-01 12:03:30
R&gt; [17] 2021-01-01 12:04:00
R&gt; 9 Levels: 2021-01-01 12:00:00 ... 2021-01-01 12:04:00</code></pre>
</div>
</div>
</section>
</section>
<section id="dados-omissos---na-not-available" class="level2" data-number="9.6">
<h2 data-number="9.6" class="anchored" data-anchor-id="dados-omissos---na-not-available"><span class="header-section-number">9.6</span> Dados Omissos - <code>NA</code> (<em>Not available</em>)</h2>
<p>Uma das principais inovações do R em relação a outras linguagens de programação é a representação de dados omissos através de objetos da classe <code>NA</code> (<em>Not Available</em>). A falta de dados pode ter inúmeros motivos, tal como a falha na coleta de informações ou simplesmente a não existência dos mesmos. Esses casos são tratados por meio da remoção ou da substituição dos dados omissos antes realizar uma análise mais profunda. A identificação desses casos, portanto, é de extrema importância.</p>
<section id="definindo-valores-na" class="level3" data-number="9.6.1">
<h3 data-number="9.6.1" class="anchored" data-anchor-id="definindo-valores-na"><span class="header-section-number">9.6.1</span> Definindo Valores <code>NA</code></h3>
<p>Para definirmos os casos omissos nos dados, basta utilizar o símbolo <code>NA</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb310"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb310-1"><a href="#cb310-1" aria-hidden="true" tabindex="-1"></a><span class="co"># a vector with NA</span></span>
<span id="cb310-2"><a href="#cb310-2" aria-hidden="true" tabindex="-1"></a>my_x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="cn">NA</span>, <span class="dv">4</span>, <span class="dv">5</span>)</span>
<span id="cb310-3"><a href="#cb310-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb310-4"><a href="#cb310-4" aria-hidden="true" tabindex="-1"></a><span class="co"># print it</span></span>
<span id="cb310-5"><a href="#cb310-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1]  1  2 NA  4  5</code></pre>
</div>
</div>
<p>Vale destacar que a operação de qualquer valor <code>NA</code> com outro sempre resultará em <code>NA</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb312"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb312-1"><a href="#cb312-1" aria-hidden="true" tabindex="-1"></a><span class="co"># example of NA interacting with other objects</span></span>
<span id="cb312-2"><a href="#cb312-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_x <span class="sc">+</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1]  2  3 NA  5  6</code></pre>
</div>
</div>
<p>Isso exige cuidado quando se está utilizando alguma função com cálculo recursivo, tal como <strong>cumsum()</strong> e <strong>cumprod()</strong> . Nesses casos, todo valor consecutivo ao <code>NA</code> será transformado em <code>NA</code>. Veja os exemplos a seguir com as duas funções:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb314"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb314-1"><a href="#cb314-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set vector with NA</span></span>
<span id="cb314-2"><a href="#cb314-2" aria-hidden="true" tabindex="-1"></a>my_x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="cn">NA</span>, <span class="dv">5</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb314-3"><a href="#cb314-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-4"><a href="#cb314-4" aria-hidden="true" tabindex="-1"></a><span class="co"># print cumsum (NA after sixth element)</span></span>
<span id="cb314-5"><a href="#cb314-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">cumsum</span>(my_x))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt;  [1]  1  3  6 10 15 NA NA NA NA NA NA NA</code></pre>
</div>
<div class="sourceCode cell-code" id="cb316"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb316-1"><a href="#cb316-1" aria-hidden="true" tabindex="-1"></a><span class="co"># print cumprod (NA after sixth element)</span></span>
<span id="cb316-2"><a href="#cb316-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">cumprod</span>(my_x))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt;  [1]   1   2   6  24 120  NA  NA  NA  NA  NA  NA  NA</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Cuidado
</div>
</div>
<div class="callout-body-container callout-body">
<p>Toda vez que utilizar as funções <strong>cumsum()</strong> e <strong>cumprod()</strong> , certifique-se de que não existe algum valor <code>NA</code> no vetor de entrada. Lembre-se de que todo <code>NA</code> é contagiante e o cálculo recursivo irá resultar em um vetor repleto de dados faltantes.</p>
</div>
</div>
</section>
<section id="encontrando-e-substituindo-valores-na" class="level3" data-number="9.6.2">
<h3 data-number="9.6.2" class="anchored" data-anchor-id="encontrando-e-substituindo-valores-na"><span class="header-section-number">9.6.2</span> Encontrando e Substituindo Valores <code>NA</code></h3>
<p>Para encontrar os valores <code>NA</code> em um vetor, basta utilizar a função <strong>is.na()</strong> : </p>
<div class="cell">
<div class="sourceCode cell-code" id="cb318"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb318-1"><a href="#cb318-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set vector with NA</span></span>
<span id="cb318-2"><a href="#cb318-2" aria-hidden="true" tabindex="-1"></a>my_x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="cn">NA</span>, <span class="dv">4</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb318-3"><a href="#cb318-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-4"><a href="#cb318-4" aria-hidden="true" tabindex="-1"></a><span class="co"># find location of NA</span></span>
<span id="cb318-5"><a href="#cb318-5" aria-hidden="true" tabindex="-1"></a>idx_na <span class="ot">&lt;-</span> <span class="fu">is.na</span>(my_x)</span>
<span id="cb318-6"><a href="#cb318-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(idx_na)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt;  [1] FALSE FALSE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE
R&gt; [10] FALSE</code></pre>
</div>
</div>
<p>Para substituí-los, use indexação com a saída de <strong>is.na()</strong> :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb320"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb320-1"><a href="#cb320-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set vector</span></span>
<span id="cb320-2"><a href="#cb320-2" aria-hidden="true" tabindex="-1"></a>my_x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="cn">NA</span>, <span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>, <span class="cn">NA</span>)</span>
<span id="cb320-3"><a href="#cb320-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-4"><a href="#cb320-4" aria-hidden="true" tabindex="-1"></a><span class="co"># replace NA for 2</span></span>
<span id="cb320-5"><a href="#cb320-5" aria-hidden="true" tabindex="-1"></a>my_x[<span class="fu">is.na</span>(my_x)] <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb320-6"><a href="#cb320-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-7"><a href="#cb320-7" aria-hidden="true" tabindex="-1"></a><span class="co"># print result</span></span>
<span id="cb320-8"><a href="#cb320-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1] 1 2 3 4 2</code></pre>
</div>
</div>
<p>Outra maneira de limpar o objeto é utilizar a função <strong>na.omit()</strong> , que retorna o mesmo objeto mas sem os valores <code>NA</code>. Note, porém, que o tamanho do vetor irá mudar e o objeto será da classe <code>omit</code>, o que indica que o vetor resultante não inclui os <code>NA</code> e apresenta, também, a posição dos elementos <code>NA</code> encontrados. </p>
<div class="cell">
<div class="sourceCode cell-code" id="cb322"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb322-1"><a href="#cb322-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set vector</span></span>
<span id="cb322-2"><a href="#cb322-2" aria-hidden="true" tabindex="-1"></a>my_char <span class="ot">&lt;-</span> <span class="fu">c</span>(letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>], <span class="cn">NA</span>, letters[<span class="dv">5</span><span class="sc">:</span><span class="dv">8</span>])</span>
<span id="cb322-3"><a href="#cb322-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb322-4"><a href="#cb322-4" aria-hidden="true" tabindex="-1"></a><span class="co"># print it</span></span>
<span id="cb322-5"><a href="#cb322-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_char)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1] "a" "b" "c" NA  "e" "f" "g" "h"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb324"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb324-1"><a href="#cb324-1" aria-hidden="true" tabindex="-1"></a><span class="co"># use na.omit to remove NA</span></span>
<span id="cb324-2"><a href="#cb324-2" aria-hidden="true" tabindex="-1"></a>my_char <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(my_char)</span>
<span id="cb324-3"><a href="#cb324-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb324-4"><a href="#cb324-4" aria-hidden="true" tabindex="-1"></a><span class="co"># print result</span></span>
<span id="cb324-5"><a href="#cb324-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_char)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1] "a" "b" "c" "e" "f" "g" "h"
R&gt; attr(,"na.action")
R&gt; [1] 4
R&gt; attr(,"class")
R&gt; [1] "omit"</code></pre>
</div>
</div>
<p>Apesar de o tipo de objeto ter sido trocado, devido ao uso de <strong>na.omit()</strong> , as propriedades básicas do vetor inicial se mantêm. Por exemplo: o uso de <strong>nchar()</strong> no objeto resultante é possível.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb326"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb326-1"><a href="#cb326-1" aria-hidden="true" tabindex="-1"></a><span class="co"># trying nchar on a na.omit object</span></span>
<span id="cb326-2"><a href="#cb326-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">nchar</span>(my_char))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1] 1 1 1 1 1 1 1</code></pre>
</div>
</div>
<p>Para outros objetos, porém, recomenda-se cautela quando no uso da função <strong>na.omit()</strong> .</p>
</section>
<section id="outras-funções-úteis-3" class="level3" data-number="9.6.3">
<h3 data-number="9.6.3" class="anchored" data-anchor-id="outras-funções-úteis-3"><span class="header-section-number">9.6.3</span> Outras Funções Úteis</h3>
<p><strong>complete.cases</strong> - Retorna um vetor lógico que indica se as linhas do objeto possuem apenas valores não omissos. Essa função é usada exclusivamente para <code>dataframes</code> e matrizes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb328"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb328-1"><a href="#cb328-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create matrix</span></span>
<span id="cb328-2"><a href="#cb328-2" aria-hidden="true" tabindex="-1"></a>my_mat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>, <span class="at">nrow =</span> <span class="dv">5</span>)</span>
<span id="cb328-3"><a href="#cb328-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb328-4"><a href="#cb328-4" aria-hidden="true" tabindex="-1"></a><span class="co"># set an NA value</span></span>
<span id="cb328-5"><a href="#cb328-5" aria-hidden="true" tabindex="-1"></a>my_mat[<span class="dv">2</span>,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb328-6"><a href="#cb328-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb328-7"><a href="#cb328-7" aria-hidden="true" tabindex="-1"></a><span class="co"># print index with rows without NA</span></span>
<span id="cb328-8"><a href="#cb328-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">complete.cases</span>(my_mat))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R&gt; [1]  TRUE FALSE  TRUE  TRUE  TRUE</code></pre>
</div>
</div>
</section>
</section>
<section id="exerc-classes-basicas" class="level2" data-number="9.7">
<h2 data-number="9.7" class="anchored" data-anchor-id="exerc-classes-basicas"><span class="header-section-number">9.7</span> Exercícios</h2>


<div id="refs" class="references csl-bib-body hanging-indent" role="list" style="display: none">
<div id="ref-R-base" class="csl-entry" role="listitem">
R Core Team. 2023. <em>R: A Language and Environment for Statistical Computing</em>. Vienna, Austria: R Foundation for Statistical Computing. <a href="https://www.R-project.org/">https://www.R-project.org/</a>.
</div>
<div id="ref-R-lubridate" class="csl-entry" role="listitem">
Spinu, Vitalie, Garrett Grolemund, and Hadley Wickham. 2023. <em>Lubridate: Make Dealing with Dates a Little Easier</em>. <a href="https://lubridate.tidyverse.org">https://lubridate.tidyverse.org</a>.
</div>
<div id="ref-R-forcats" class="csl-entry" role="listitem">
Wickham, Hadley. 2023a. <em>Forcats: Tools for Working with Categorical Variables (Factors)</em>. <a href="https://forcats.tidyverse.org/">https://forcats.tidyverse.org/</a>.
</div>
<div id="ref-R-stringr" class="csl-entry" role="listitem">
———. 2023b. <em>Stringr: Simple, Consistent Wrappers for Common String Operations</em>. <a href="https://stringr.tidyverse.org">https://stringr.tidyverse.org</a>.
</div>
<div id="ref-R-tidyverse" class="csl-entry" role="listitem">
———. 2023c. <em>Tidyverse: Easily Install and Load the Tidyverse</em>. <a href="https://tidyverse.tidyverse.org">https://tidyverse.tidyverse.org</a>.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./08-objetos-armazenamento.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Dataframes e outros Objetos</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./10-intro-programacao.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Introdução a Programação com o R</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>